# 转化目标简化改造 - 快速启动指南

## 🚀 立即开始使用

改造已全部完成，系统已准备就绪！

---

## 📋 快速测试步骤

### 步骤1: 启动服务（如果未启动）

```bash
# 启动后端服务
cd server
npm start

# 启动前端服务（新终端）
cd client
npm start
```

### 步骤2: 创建转化目标

访问前端页面：`http://localhost:5173/conversion-targets`

**测试案例1: 创建有地址的转化目标**
- 公司名称: `杭州鸥飞留学机构`
- 行业类型: `教育`
- 官方网站: `https://www.oufei.com`
- 公司地址: `杭州市西湖区教工路123号`

**测试案例2: 创建无地址的转化目标**
- 公司名称: `某某科技公司`
- 行业类型: `互联网`
- 官方网站: `https://www.example.com`
- 公司地址: （留空）

### 步骤3: 生成文章测试

1. 访问文章生成页面
2. 选择关键词蒸馏结果
3. 选择图库
4. 选择知识库
5. 选择文章设置（使用"区域TOP排名"模板）
6. **选择转化目标**（选择刚创建的转化目标）
7. 点击"生成文章"

### 步骤4: 验证结果

**有地址的转化目标**:
- ✅ 生成的文章应该包含真实地址："杭州市西湖区教工路123号"
- ✅ 不应该出现"xxx"或"某某地址"等占位符

**无地址的转化目标**:
- ✅ 生成的文章不应该提及地址
- ✅ 不应该编造地址
- ✅ 其他信息（公司名称、行业、网站）正常显示

---

## 🎯 核心改进

### 1. 字段简化
- **必填**: 只有公司名称
- **可选**: 行业类型、官方网站、公司地址

### 2. 地址问题解决
- 如果有地址 → 使用真实地址
- 如果无地址 → 不提及地址，不编造

### 3. 提示词优化
所有模板都添加了强制规则：
```
【关键】如果知识库中某个字段为空或不存在，就不要提及该信息，不要编造
绝对不能使用"xxx"、"某某地址"等占位符
```

---

## 📊 API测试（可选）

### 测试列表API
```bash
curl 'http://localhost:3000/api/conversion-targets?page=1&pageSize=10'
```

### 测试创建API（有地址）
```bash
curl -X POST http://localhost:3000/api/conversion-targets \
  -H "Content-Type: application/json" \
  -d '{
    "companyName": "测试公司A",
    "industry": "教育",
    "website": "https://www.test-a.com",
    "address": "杭州市西湖区文三路100号"
  }'
```

### 测试创建API（无地址）
```bash
curl -X POST http://localhost:3000/api/conversion-targets \
  -H "Content-Type: application/json" \
  -d '{
    "companyName": "测试公司B",
    "industry": "互联网",
    "website": "https://www.test-b.com"
  }'
```

---

## 🔍 验证清单

### 数据库验证
```bash
# 查看表结构
psql -d geo_system -c "\d conversion_targets"

# 查看数据
psql -d geo_system -c "SELECT id, company_name, industry, website, address FROM conversion_targets ORDER BY id DESC LIMIT 5;"
```

### 后端验证
- ✅ 服务运行在 http://localhost:3000
- ✅ API响应正常
- ✅ 数据验证正确（只有company_name必填）

### 前端验证
- ✅ 转化目标页面正常显示
- ✅ 表单验证正确（只有公司名称必填）
- ✅ 创建、编辑、删除功能正常

### 文章生成验证
- ✅ 有地址的转化目标 → 使用真实地址
- ✅ 无地址的转化目标 → 不提及地址
- ✅ 不出现"xxx"占位符

---

## 📝 常见问题

### Q1: 如果我不填写地址，文章会怎样？
**A**: 文章不会提及地址，也不会编造地址。提示词已经明确要求："如果字段为空就不要提及"。

### Q2: 我可以只填写公司名称吗？
**A**: 可以！只有公司名称是必填的，其他字段都是可选的。

### Q3: 旧的转化目标数据会丢失吗？
**A**: 不会！数据库迁移保留了所有旧数据，只是删除了不需要的字段。

### Q4: 如何确保文章使用真实地址？
**A**: 系统通过三重保障：
1. 数据库存储真实地址
2. 知识库传递转化目标信息
3. 提示词强制要求使用知识库中的地址

### Q5: 如果我想修改提示词规则怎么办？
**A**: 直接修改 `client/src/constants/promptTemplates.ts` 文件中的模板即可，无需修改代码。

---

## 🎉 开始使用

现在你可以：
1. ✅ 创建转化目标（只需填写公司名称）
2. ✅ 选择性填写行业、网站、地址
3. ✅ 生成文章时使用真实地址（如果有）
4. ✅ 不用担心文章编造地址（如果没有）

**祝使用愉快！** 🚀
