# 文章预览功能说明

## 功能概述

在发布任务页面的文章选择列表中，新增了"预览"列，用户可以点击预览按钮查看文章的完整内容。

## 功能特性

### 1. 预览列位置
- 位置：在"蒸馏结果"列之后，"创建时间"列之前
- 宽度：80px
- 对齐：居中

### 2. 预览按钮
- 图标：眼睛图标 (EyeOutlined)
- 样式：链接按钮
- 提示：鼠标悬停显示"预览文章"

### 3. 预览模态框内容

预览模态框包含以下信息：

#### 标题栏
- 显示"文章预览"标题
- 显示文章ID标签

#### 文章元信息卡片
- **关键词**：蓝色标签显示
- **蒸馏结果**：绿色标签显示（如果有）
- **创建时间**：格式化的本地时间
- **发布状态**：已发布/未发布标签

#### 文章标题
- 如果文章有标题，单独显示在卡片中
- 字体大小：18px，加粗

#### 文章配图
- 如果文章有图片，居中显示
- 最大宽度：100%
- 最大高度：400px
- 圆角：8px
- 自适应缩放

#### 文章内容
- 保留原始格式（换行、空格等）
- 自动换行
- 行高：1.8
- 字体大小：14px

### 4. 模态框操作
- 宽度：900px
- 最大高度：600px（内容区域可滚动）
- 底部按钮：关闭按钮

## 使用方法

1. 进入"发布任务"页面
2. 在"选择文章"区域的文章列表中
3. 找到想要预览的文章
4. 点击该文章行的"预览"按钮
5. 在弹出的模态框中查看文章完整内容
6. 查看完毕后点击"关闭"按钮

## 技术实现

### 状态管理
```typescript
const [previewModal, setPreviewModal] = useState<{
  visible: boolean;
  article: Article | null;
  loading: boolean;
}>({
  visible: false,
  article: null,
  loading: false
});
```

### 预览处理函数
```typescript
const handlePreviewArticle = async (article: Article) => {
  try {
    // 先显示模态框，显示加载状态
    setPreviewModal({
      visible: true,
      article: article,
      loading: true
    });
    
    // 获取完整的文章详情（包含content）
    const fullArticle = await getArticle(article.id);
    
    // 更新模态框内容
    setPreviewModal({
      visible: true,
      article: fullArticle,
      loading: false
    });
  } catch (error: any) {
    message.error('加载文章详情失败');
    console.error(error);
    setPreviewModal({ visible: false, article: null, loading: false });
  }
};
```

### 关键优化
- **异步加载**：点击预览时通过 `getArticle(id)` API 获取完整文章详情
- **加载状态**：显示加载动画，提升用户体验
- **错误处理**：加载失败时显示错误提示并关闭模态框

### 表格列配置
在文章表格的列配置中添加了预览列：
- 位置：蒸馏结果列之后
- 渲染：预览按钮
- 点击事件：调用 handlePreviewArticle

## 数据结构更新

在 `Article` 接口中添加了 `topicQuestion` 字段：
```typescript
export interface Article {
  // ... 其他字段
  topicQuestion?: string;  // 蒸馏结果（话题问题）
}
```

## 界面效果

- 预览按钮使用眼睛图标，直观易懂
- 模态框布局清晰，信息层次分明
- 支持长文本滚动查看
- 图片自适应显示，不会变形
- 保持文章原始格式，便于审阅

## 注意事项

1. 预览功能不会修改文章内容
2. 预览模态框为只读模式
3. 如需编辑文章，请前往文章管理页面
4. 图片加载失败时会显示占位符
5. 长文本内容支持滚动查看
6. **首次点击预览会异步加载完整文章内容**，会有短暂的加载过程
7. 如果文章没有内容，会显示"暂无文章内容"的提示

## 后续优化建议

1. 添加文章编辑快捷入口
2. 支持在预览中直接选择/取消选择文章
3. 添加上一篇/下一篇快速切换功能
4. 支持全屏预览模式
5. 添加打印预览功能
