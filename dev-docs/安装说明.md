# GEO优化系统 - 安装说明

## 📋 系统要求

在开始之前，请确保您的系统满足以下要求：

- **Node.js**: 18.0 或更高版本
- **PostgreSQL**: 12.0 或更高版本
- **操作系统**: Windows 10+, macOS 10.15+, 或 Linux
- **内存**: 至少 4GB RAM
- **磁盘空间**: 至少 2GB 可用空间

## 🔑 准备工作

### 1. 获取AI API密钥

您需要至少一个AI服务的API密钥：

#### DeepSeek API（推荐中文用户）
1. 访问 https://platform.deepseek.com
2. 注册账号并登录
3. 进入"API密钥"页面
4. 点击"创建新密钥"
5. 复制并保存密钥

**特点**：
- ✅ 中文支持优秀
- ✅ 价格相对便宜
- ✅ 响应速度快
- ✅ 适合中文内容生成

#### Google Gemini API
1. 访问 https://makersuite.google.com/app/apikey
2. 使用Google账号登录
3. 点击"Create API Key"
4. 复制并保存密钥

**特点**：
- ✅ 免费额度较高
- ✅ 多语言支持
- ✅ Google生态集成

## 📥 安装步骤

### 步骤1: 下载项目

```bash
# 如果您有Git
git clone <项目地址>
cd geo-optimization-system

# 或者直接下载ZIP文件并解压
```

### 步骤2: 安装Node.js

#### Windows用户
1. 访问 https://nodejs.org/zh-cn/
2. 下载LTS版本（推荐）
3. 运行安装程序
4. 验证安装：
```bash
node --version
npm --version
```

#### macOS用户
```bash
# 使用Homebrew安装
brew install node

# 验证安装
node --version
npm --version
```

#### Linux用户
```bash
# Ubuntu/Debian
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# CentOS/RHEL
curl -fsSL https://rpm.nodesource.com/setup_18.x | sudo bash -
sudo yum install -y nodejs

# 验证安装
node --version
npm --version
```

### 步骤3: 安装PostgreSQL

#### Windows用户
1. 访问 https://www.postgresql.org/download/windows/
2. 下载安装程序
3. 运行安装程序
4. 记住设置的密码
5. 验证安装：
```bash
psql --version
```

#### macOS用户
```bash
# 使用Homebrew安装
brew install postgresql@14

# 启动服务
brew services start postgresql@14

# 验证安装
psql --version
```

#### Linux用户
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install postgresql postgresql-contrib

# CentOS/RHEL
sudo yum install postgresql-server postgresql-contrib

# 启动服务
sudo systemctl start postgresql
sudo systemctl enable postgresql

# 验证安装
psql --version
```

### 步骤4: 创建数据库

```bash
# Windows用户（在命令提示符中）
psql -U postgres

# macOS/Linux用户
sudo -u postgres psql

# 在PostgreSQL命令行中执行：
CREATE DATABASE geo_system;
CREATE USER geo_user WITH ENCRYPTED PASSWORD 'your_password';
GRANT ALL PRIVILEGES ON DATABASE geo_system TO geo_user;
\q
```

### 步骤5: 安装项目依赖

```bash
# 在项目根目录执行
npm run install:all
```

这个命令会自动安装：
- 根目录的依赖
- 前端（client）的依赖
- 后端（server）的依赖

**注意**：首次安装可能需要5-10分钟，请耐心等待。

### 步骤6: 配置环境变量

```bash
# 复制环境变量模板
cp .env.example .env

# Windows用户使用：
copy .env.example .env
```

编辑 `.env` 文件，填入您的配置：

```env
# 数据库配置
DATABASE_URL=postgresql://geo_user:your_password@localhost:5432/geo_system

# AI API配置（至少配置一个）
DEEPSEEK_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxx
GEMINI_API_KEY=xxxxxxxxxxxxxxxxxxxxxxxx

# 服务器配置
PORT=3000
NODE_ENV=development
```

**重要提示**：
- 将 `your_password` 替换为您在步骤4中设置的密码
- 将 `sk-xxxxxxxx` 替换为您的实际API密钥
- 如果只使用一个AI服务，另一个可以留空

### 步骤7: 初始化数据库

```bash
cd server
npm run db:migrate
cd ..
```

您应该看到类似这样的输出：
```
🔄 开始数据库迁移...
✅ 数据库迁移完成
```

### 步骤8: 启动系统

```bash
npm run dev
```

启动成功后，您会看到：
```
🚀 服务器运行在 http://localhost:3000
```

## 🌐 访问系统

打开浏览器，访问：

- **前端界面**: http://localhost:5173
- **后端API**: http://localhost:3000

## ✅ 验证安装

### 1. 检查前端
- 打开 http://localhost:5173
- 应该看到GEO优化系统的工作台页面
- 侧边栏显示菜单项
- 顶部显示"未配置API"标签

### 2. 检查后端
- 打开 http://localhost:3000/api/health
- 应该看到：`{"status":"ok","message":"GEO优化系统运行正常"}`

### 3. 配置API
1. 点击左侧菜单"API配置"
2. 选择AI模型（DeepSeek或Gemini）
3. 输入API密钥
4. 点击"保存配置"
5. 看到"API配置保存成功"提示

### 4. 测试功能
1. 点击"关键词蒸馏"
2. 输入测试关键词，如"英国留学"
3. 点击"开始蒸馏"
4. 等待10-30秒
5. 应该看到生成的话题列表

## 🔧 常见问题

### 问题1: 端口被占用

**错误信息**：
```
Error: listen EADDRINUSE: address already in use :::3000
```

**解决方案**：

Windows:
```bash
# 查找占用端口的进程
netstat -ano | findstr :3000
# 杀死进程（替换PID为实际进程ID）
taskkill /PID <PID> /F
```

macOS/Linux:
```bash
# 查找占用端口的进程
lsof -i :3000
# 杀死进程
kill -9 <PID>
```

或者修改 `.env` 文件中的端口：
```env
PORT=3001
```

### 问题2: 数据库连接失败

**错误信息**：
```
❌ 数据库连接错误
```

**解决方案**：
1. 检查PostgreSQL是否运行：
```bash
# Windows
sc query postgresql-x64-14

# macOS
brew services list | grep postgresql

# Linux
sudo systemctl status postgresql
```

2. 检查 `.env` 中的数据库连接字符串
3. 确认用户名和密码正确
4. 确认数据库已创建

### 问题3: npm install失败

**错误信息**：
```
npm ERR! code ECONNREFUSED
```

**解决方案**：
1. 检查网络连接
2. 尝试使用国内镜像：
```bash
# 使用淘宝镜像
npm config set registry https://registry.npmmirror.com

# 重新安装
npm run install:all
```

### 问题4: API调用失败

**错误信息**：
```
API调用失败，请检查API配置
```

**解决方案**：
1. 检查API密钥是否正确
2. 确认API密钥有余额
3. 检查网络连接
4. 尝试切换不同的AI模型

### 问题5: 前端页面空白

**解决方案**：
1. 打开浏览器开发者工具（F12）
2. 查看Console标签的错误信息
3. 确认后端服务已启动
4. 清除浏览器缓存
5. 尝试使用无痕模式

## 📱 使用技巧

### 1. 开发模式
```bash
# 同时启动前端和后端
npm run dev

# 仅启动前端
npm run client:dev

# 仅启动后端
npm run server:dev
```

### 2. 查看日志
- 前端日志：浏览器开发者工具 Console
- 后端日志：终端输出

### 3. 停止服务
- 按 `Ctrl + C` 停止服务

### 4. 重启服务
```bash
# 停止服务（Ctrl + C）
# 然后重新启动
npm run dev
```

## 🎓 下一步

安装完成后，建议您：

1. **阅读文档**
   - [功能说明](./docs/功能说明.md) - 了解所有功能
   - [快速开始](./docs/快速开始.md) - 学习使用方法

2. **尝试功能**
   - 配置API密钥
   - 蒸馏几个关键词
   - 生成测试文章

3. **探索系统**
   - 查看工作台
   - 管理话题
   - 查看文章历史

## 💬 获取帮助

如果遇到问题：

1. **查看文档**
   - 阅读 [快速开始](./docs/快速开始.md)
   - 查看 [常见问题](#常见问题)

2. **检查日志**
   - 查看终端输出
   - 查看浏览器控制台

3. **寻求帮助**
   - 提交GitHub Issue
   - 联系技术支持

## 🎉 安装成功！

恭喜您成功安装GEO优化系统！

现在您可以：
- ✅ 配置AI API
- ✅ 蒸馏关键词
- ✅ 管理话题
- ✅ 生成文章

开始使用，让您的品牌在AI时代脱颖而出！🚀

---

**提示**：如果您是第一次使用，建议先阅读 [功能说明文档](./docs/功能说明.md) 了解系统的完整功能。
