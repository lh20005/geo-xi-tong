# å¤´æ¡å·å‘å¸ƒæµç¨‹ - æœ€ç»ˆä¼˜åŒ–ç‰ˆ

## ğŸ“‹ æµç¨‹æ¦‚è¿°

æ ¹æ®ç”¨æˆ·æœ€æ–°è¦æ±‚ï¼Œä¼˜åŒ–äº†å¤´æ¡å·è‡ªåŠ¨å‘å¸ƒæµç¨‹ï¼Œæ”¹ä¸ºï¼š
1. **å…ˆå¤åˆ¶æ‰€æœ‰æ–‡å­—**
2. **å†ä¸Šä¼ æ‰€æœ‰å›¾ç‰‡**

## âœ… å®Œæ•´çš„å‘å¸ƒæµç¨‹

### æ­¥éª¤1ï¼šç‚¹å‡»"å‘å¸ƒæ–‡ç« "èœå•
- **é€‰æ‹©å™¨**: `#masterRoot > div > div.pgc-content > section > aside > div > div > div > div.byte-menu-inline.base_creation_tab > div.byte-menu-inline-content > div:nth-child(1) > span > a`
- **ç­‰å¾…æ—¶é—´**: 5ç§’ï¼ˆèœå•åŠ è½½ï¼‰ + 5ç§’ï¼ˆé¡µé¢è·³è½¬ï¼‰ + 8ç§’ï¼ˆé¡µé¢åŠ è½½ï¼‰

### æ­¥éª¤2ï¼šå¡«å†™æ ‡é¢˜
- **é€‰æ‹©å™¨**: `#root > div > div.left-column > div > div.publish-editor > div.publish-editor-title-wrapper > div > div > div.title-wrapper > div > div > div > textarea`
- **ç­‰å¾…æ—¶é—´**: 3ç§’ï¼ˆè¾“å…¥ç¨³å®šï¼‰

### æ­¥éª¤3ï¼šå¡«å†™æ­£æ–‡ - å…ˆå¤åˆ¶æ‰€æœ‰æ–‡å­—
- **é€‰æ‹©å™¨**: `#root > div > div.left-column > div > div.publish-editor > div.syl-editor-wrap > div > div.ProseMirror > p`
- **æ“ä½œ**:
  1. ä»æ–‡ç« å†…å®¹ä¸­ç§»é™¤æ‰€æœ‰å›¾ç‰‡æ ‡è®°
  2. æå–çº¯æ–‡å­—å†…å®¹
  3. ç‚¹å‡»ç¼–è¾‘å™¨è·å¾—ç„¦ç‚¹
  4. é€å­—è¾“å…¥æ‰€æœ‰æ–‡å­—ï¼ˆdelay: 30msï¼‰
  5. ç­‰å¾…3ç§’è®©è¾“å…¥ç¨³å®š

**ç¤ºä¾‹**ï¼š
```markdown
åŸå§‹å†…å®¹ï¼š
è¿™æ˜¯ç¬¬ä¸€æ®µæ–‡å­—ã€‚
![å›¾ç‰‡1](image1.jpg)
è¿™æ˜¯ç¬¬äºŒæ®µæ–‡å­—ã€‚
![å›¾ç‰‡2](image2.jpg)
è¿™æ˜¯ç¬¬ä¸‰æ®µæ–‡å­—ã€‚

æå–åçš„æ–‡å­—ï¼š
è¿™æ˜¯ç¬¬ä¸€æ®µæ–‡å­—ã€‚
è¿™æ˜¯ç¬¬äºŒæ®µæ–‡å­—ã€‚
è¿™æ˜¯ç¬¬ä¸‰æ®µæ–‡å­—ã€‚
```

### æ­¥éª¤4ï¼šä¸Šä¼ æ‰€æœ‰å›¾ç‰‡
å¯¹æ¯å¼ å›¾ç‰‡æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

#### 4.1 ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡æŒ‰é’®
- **é€‰æ‹©å™¨**: `#root > div > div.left-column > div > div.publish-editor > div.syl-editor-toolbar.visible.inline > div > div.syl-toolbar-tool.image.static > div > button > svg`
- **ç­‰å¾…æ—¶é—´**: 8ç§’ï¼ˆå¯¹è¯æ¡†æ‰“å¼€ï¼‰

#### 4.2 é€‰æ‹©æœ¬åœ°æ–‡ä»¶
- **é€‰æ‹©å™¨**: `body > div:nth-child(46) > ... > input[type=file]`
- **æ“ä½œ**: è°ƒç”¨`uploadFile(imagePath)`
- **ç­‰å¾…æ—¶é—´**: 20ç§’ï¼ˆä¸Šä¼ å®Œæˆï¼‰

#### 4.3 ç‚¹å‡»ç¡®å®šæŒ‰é’®
- **æŸ¥æ‰¾æ–¹å¼**: é€šè¿‡æ–‡æœ¬ç²¾ç¡®åŒ¹é…"ç¡®å®š"æˆ–"ç¡®è®¤"
- **ç­‰å¾…æ—¶é—´**: 5ç§’ï¼ˆå¯¹è¯æ¡†å…³é—­ï¼‰

**é‡å¤**: å¦‚æœæœ‰å¤šå¼ å›¾ç‰‡ï¼Œé‡å¤æ­¥éª¤4.1-4.3

### æ­¥éª¤5ï¼šéªŒè¯å†…å®¹å®Œæ•´æ€§
- **éªŒè¯æ¡ä»¶**:
  - å›¾ç‰‡æ•°é‡åŒ¹é…ï¼šå®é™… = é¢„æœŸ
  - æ–‡å­—é•¿åº¦è¶³å¤Ÿï¼šå®é™… >= é¢„æœŸ Ã— 70%
- **æœ€å¤šå°è¯•**: 5æ¬¡ï¼Œæ¯æ¬¡é—´éš”2ç§’
- **ç­‰å¾…æ—¶é—´**: åˆå§‹ç­‰å¾…3ç§’ + æœ€å¤š10ç§’é‡è¯•

### æ­¥éª¤6ï¼šç‚¹å‡»å¿…éœ€é€‰é¡¹æŒ‰é’®
- **é€‰æ‹©å™¨**: `#root > div > div.left-column > div > div.form-wrap > div.form-container > div.source-wrap > div > div.edit-input > div > div > span > span:nth-child(4) > label > span > div`
- **ç­‰å¾…æ—¶é—´**: 5ç§’ï¼ˆåŠ è½½ï¼‰ + 3ç§’ï¼ˆç”Ÿæ•ˆï¼‰

### æ­¥éª¤7ï¼šç‚¹å‡»"é¢„è§ˆå¹¶å‘å¸ƒ"æŒ‰é’®
- **é€‰æ‹©å™¨**: `#root > div > div.left-column > div > div.publish-footer.inline-editor > div > button.byte-btn.byte-btn-primary.byte-btn-size-large.byte-btn-shape-square.publish-btn.publish-btn-last > span`
- **å¤‡ç”¨æ–¹æ¡ˆ**: é€šè¿‡æ–‡æœ¬æŸ¥æ‰¾
- **ç­‰å¾…æ—¶é—´**: 3ç§’ï¼ˆæ»šåŠ¨ï¼‰ + 5ç§’ï¼ˆå¯¹è¯æ¡†å‡ºç°ï¼‰

### æ­¥éª¤8ï¼šç‚¹å‡»"ç¡®è®¤å‘å¸ƒ"æŒ‰é’®
- **æŸ¥æ‰¾æ–¹å¼**: é€šè¿‡æ–‡æœ¬æŸ¥æ‰¾"ç¡®è®¤å‘å¸ƒ"ã€"å‘å¸ƒ"æˆ–"ç¡®å®š"
- **ç­‰å¾…æ—¶é—´**: 3ç§’ï¼ˆå¯¹è¯æ¡†åŠ è½½ï¼‰ + 8ç§’ï¼ˆå‘å¸ƒå¤„ç†ï¼‰ + 10ç§’ï¼ˆè§‚å¯Ÿç»“æœï¼‰

## ğŸ¯ å…³é”®ä¼˜åŒ–ç‚¹

### 1. ç®€åŒ–å†…å®¹æ’å…¥é€»è¾‘

**æ—§æ–¹æ¡ˆ**ï¼ˆå¤æ‚ï¼‰ï¼š
```
æ–‡å­—1 â†’ å›¾ç‰‡1 â†’ æ–‡å­—2 â†’ å›¾ç‰‡2 â†’ æ–‡å­—3
```
- éœ€è¦è§£æå†…å®¹ï¼Œè¯†åˆ«æ–‡å­—å’Œå›¾ç‰‡çš„ä½ç½®å…³ç³»
- éœ€è¦åœ¨å¾ªç¯ä¸­äº¤æ›¿å¤„ç†æ–‡å­—å’Œå›¾ç‰‡
- å®¹æ˜“å‡ºé”™ï¼Œéš¾ä»¥è°ƒè¯•

**æ–°æ–¹æ¡ˆ**ï¼ˆç®€å•ï¼‰ï¼š
```
æ‰€æœ‰æ–‡å­— â†’ å›¾ç‰‡1 â†’ å›¾ç‰‡2 â†’ å›¾ç‰‡3
```
- å…ˆæå–æ‰€æœ‰æ–‡å­—ï¼Œä¸€æ¬¡æ€§è¾“å…¥
- å†æå–æ‰€æœ‰å›¾ç‰‡ï¼Œé€ä¸ªä¸Šä¼ 
- é€»è¾‘æ¸…æ™°ï¼Œæ˜“äºè°ƒè¯•

### 2. æ–‡å­—æå–ç®—æ³•

```typescript
// ç§»é™¤æ‰€æœ‰å›¾ç‰‡æ ‡è®°ï¼Œåªä¿ç•™æ–‡å­—
const textOnly = cleanContent.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, '').trim();
```

### 3. å›¾ç‰‡æå–ç®—æ³•

```typescript
const imagePaths: string[] = [];
const imageRegex = /!\[([^\]]*)\]\(([^)]+)\)/g;
let match;

while ((match = imageRegex.exec(cleanContent)) !== null) {
  const imageUrl = match[2];
  let imagePath = imageUrl;
  
  // è½¬æ¢ä¸ºç»å¯¹è·¯å¾„
  if (imagePath.startsWith('/uploads/')) {
    imagePath = path.join(process.cwd(), imagePath);
  }
  
  // éªŒè¯æ–‡ä»¶å­˜åœ¨
  if (fs.existsSync(imagePath)) {
    imagePaths.push(imagePath);
  }
}
```

### 4. éªŒè¯ç®—æ³•

```typescript
// éªŒè¯æ¡ä»¶
const imageCountMatch = finalResult.imageCount === expectedImageCount;
const hasEnoughText = finalResult.cleanTextLength >= expectedTextLength * 0.7;

// æœ€å¤šå°è¯•5æ¬¡
let verificationAttempts = 0;
const maxAttempts = 5;

while (verificationAttempts < maxAttempts && !verificationPassed) {
  // æ£€æŸ¥å†…å®¹
  // å¦‚æœé€šè¿‡ï¼Œç»§ç»­ä¸‹ä¸€æ­¥
  // å¦‚æœæœªé€šè¿‡ï¼Œç­‰å¾…2ç§’åé‡è¯•
}
```

## ğŸ“Š æ—¶é—´é¢„ä¼°

| æ­¥éª¤ | æ“ä½œ | é¢„è®¡æ—¶é—´ |
|------|------|---------|
| 1 | ç‚¹å‡»èœå• | 18ç§’ |
| 2 | å¡«å†™æ ‡é¢˜ | 5ç§’ |
| 3 | å¤åˆ¶æ‰€æœ‰æ–‡å­— | 5-10ç§’ï¼ˆå–å†³äºæ–‡å­—é•¿åº¦ï¼‰ |
| 4 | ä¸Šä¼ æ‰€æœ‰å›¾ç‰‡ | 33ç§’/å¼ ï¼ˆ8+20+5ï¼‰ |
| 5 | éªŒè¯å†…å®¹ | 3-13ç§’ |
| 6 | ç‚¹å‡»é€‰é¡¹ | 8ç§’ |
| 7 | é¢„è§ˆå¹¶å‘å¸ƒ | 8ç§’ |
| 8 | ç¡®è®¤å‘å¸ƒ | 21ç§’ |

**æ€»è®¡**:
- æ— å›¾ç‰‡æ–‡ç« ï¼šçº¦78ç§’ï¼ˆ1.3åˆ†é’Ÿï¼‰
- 1å¼ å›¾ç‰‡æ–‡ç« ï¼šçº¦111ç§’ï¼ˆ1.8åˆ†é’Ÿï¼‰
- 3å¼ å›¾ç‰‡æ–‡ç« ï¼šçº¦177ç§’ï¼ˆ3åˆ†é’Ÿï¼‰
- 5å¼ å›¾ç‰‡æ–‡ç« ï¼šçº¦243ç§’ï¼ˆ4åˆ†é’Ÿï¼‰

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### æ–‡å­—è¾“å…¥
- **æ–¹å¼**: `page.keyboard.type(textOnly, { delay: 30 })`
- **é€Ÿåº¦**: æ¯ä¸ªå­—ç¬¦30ms
- **ä¼˜åŠ¿**: æ¯”ä¹‹å‰çš„50msæ›´å¿«

### å›¾ç‰‡ä¸Šä¼ 
- **æ–¹å¼**: `fileInput.uploadFile(imagePath)`
- **éªŒè¯**: ä¸Šä¼ å‰æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- **ç­‰å¾…**: 20ç§’ï¼ˆè€ƒè™‘ç½‘ç»œå»¶è¿Ÿï¼‰

### ç¡®å®šæŒ‰é’®æŸ¥æ‰¾
- **ä¼˜å…ˆ**: é€šè¿‡æ–‡æœ¬ç²¾ç¡®åŒ¹é…ï¼ˆé¿å…ç‚¹å‡»é”™è¯¯æŒ‰é’®ï¼‰
- **å¤‡ç”¨**: ä½¿ç”¨ç²¾ç¡®é€‰æ‹©å™¨

## ğŸ“ æ—¥å¿—ç¤ºä¾‹

### æˆåŠŸçš„æ—¥å¿—

```
[å¤´æ¡å·] ========================================
[å¤´æ¡å·] ğŸ“ æ­¥éª¤3ï¼šæ’å…¥æ‰€æœ‰æ–‡å­—åˆ°æ­£æ–‡
[å¤´æ¡å·] ========================================
[å¤´æ¡å·] ğŸ–±ï¸  ç‚¹å‡»ç¼–è¾‘å™¨ç¡®ä¿ç„¦ç‚¹...
[å¤´æ¡å·] âœ… ç¼–è¾‘å™¨å·²è·å¾—ç„¦ç‚¹
[å¤´æ¡å·] âŒ¨ï¸  å¼€å§‹è¾“å…¥æ‰€æœ‰æ–‡å­—...
[å¤´æ¡å·] ğŸ“ æ–‡å­—é•¿åº¦: 500 ä¸ªå­—ç¬¦
[å¤´æ¡å·] âœ… æ‰€æœ‰æ–‡å­—è¾“å…¥å®Œæˆ
[å¤´æ¡å·] â³ ç­‰å¾…æ–‡å­—è¾“å…¥ç¨³å®šï¼ˆ3ç§’ï¼‰...

[å¤´æ¡å·] ========================================
[å¤´æ¡å·] ğŸ“· æ­¥éª¤4ï¼šä¸Šä¼ æ‰€æœ‰å›¾ç‰‡
[å¤´æ¡å·] ========================================
[å¤´æ¡å·] ğŸ“Š å…±æœ‰ 2 å¼ å›¾ç‰‡éœ€è¦ä¸Šä¼ 

[å¤´æ¡å·] ========== ä¸Šä¼ ç¬¬ 1/2 å¼ å›¾ç‰‡ ==========
[å¤´æ¡å·] ğŸ“· å›¾ç‰‡æ–‡ä»¶: image1.jpg
[å¤´æ¡å·] ğŸ” æŸ¥æ‰¾ä¸Šä¼ å›¾ç‰‡æŒ‰é’®...
[å¤´æ¡å·] âœ…âœ…âœ… æ‰¾åˆ°ä¸Šä¼ å›¾ç‰‡æŒ‰é’®ï¼Œæ­£åœ¨ç‚¹å‡»...
[å¤´æ¡å·] â³ ç­‰å¾…ä¸Šä¼ å¯¹è¯æ¡†æ‰“å¼€ï¼ˆ8ç§’ï¼‰...
[å¤´æ¡å·] ğŸ” æŸ¥æ‰¾æ–‡ä»¶ä¸Šä¼ è¾“å…¥æ¡†...
[å¤´æ¡å·] âœ…âœ…âœ… æˆåŠŸæ‰¾åˆ°æ–‡ä»¶è¾“å…¥æ¡†ï¼
[å¤´æ¡å·] âœ…âœ…âœ… uploadFileæ–¹æ³•è°ƒç”¨æˆåŠŸï¼
[å¤´æ¡å·] â³ ç­‰å¾…å›¾ç‰‡ä¸Šä¼ å®Œæˆï¼ˆ20ç§’ï¼‰...
[å¤´æ¡å·] ğŸ” æ–¹æ³•1ï¼šé€šè¿‡æ–‡æœ¬æŸ¥æ‰¾"ç¡®å®š"æŒ‰é’®...
âœ… æ‰¾åˆ°ç¡®å®šæŒ‰é’®ï¼Œæ–‡æœ¬: ç¡®å®š
[å¤´æ¡å·] âœ…âœ…âœ… å·²ç‚¹å‡»"ç¡®å®š"æŒ‰é’®ï¼
[å¤´æ¡å·] â³ ç­‰å¾…å¯¹è¯æ¡†å…³é—­ï¼ˆ5ç§’ï¼‰...
[å¤´æ¡å·] âœ… ç¬¬ 1/2 å¼ å›¾ç‰‡å¤„ç†å®Œæˆ

[å¤´æ¡å·] ========== ä¸Šä¼ ç¬¬ 2/2 å¼ å›¾ç‰‡ ==========
... (é‡å¤ä¸Šä¼ æµç¨‹)

[å¤´æ¡å·] âœ… æ‰€æœ‰å›¾ç‰‡ä¸Šä¼ å®Œæˆ

[å¤´æ¡å·] ========================================
[å¤´æ¡å·] ğŸ” éªŒè¯ç®—æ³•ï¼šæ£€æŸ¥æ‰€æœ‰æ–‡å­—å’Œå›¾ç‰‡æ˜¯å¦å·²å¤åˆ¶å®Œæ¯•
[å¤´æ¡å·] ========================================
[å¤´æ¡å·] ğŸ“ é¢„æœŸæ–‡å­—æ€»é•¿åº¦: 500 ä¸ªå­—ç¬¦
[å¤´æ¡å·] ğŸ“· é¢„æœŸå›¾ç‰‡æ•°é‡: 2 å¼ 
[å¤´æ¡å·] ğŸ” éªŒè¯å°è¯• 1/5...
[å¤´æ¡å·] ğŸ“Š ç¼–è¾‘å™¨ä¸­çš„å†…å®¹:
[å¤´æ¡å·]    - å›¾ç‰‡æ•°é‡: 2 å¼ 
[å¤´æ¡å·]    - æ–‡å­—é•¿åº¦: 520 ä¸ªå­—ç¬¦
[å¤´æ¡å·] ğŸ“Š éªŒè¯ç»“æœ:
[å¤´æ¡å·]    - å›¾ç‰‡æ•°é‡åŒ¹é…: âœ… (é¢„æœŸ: 2, å®é™…: 2)
[å¤´æ¡å·]    - æ–‡å­—é•¿åº¦è¶³å¤Ÿ: âœ… (é¢„æœŸ: 500, å®é™…: 480)
[å¤´æ¡å·] âœ…âœ…âœ… éªŒè¯é€šè¿‡ï¼æ‰€æœ‰å†…å®¹å·²æˆåŠŸå¤åˆ¶åˆ°ç¼–è¾‘å™¨
[å¤´æ¡å·] ========================================
[å¤´æ¡å·] âœ… å†…å®¹éªŒè¯å®Œæˆï¼Œå‡†å¤‡æ‰§è¡Œä¸‹ä¸€æ­¥
[å¤´æ¡å·] ========================================
```

## âœ… æµ‹è¯•æ¸…å•

- [ ] æ ‡é¢˜æ­£ç¡®è¾“å…¥
- [ ] æ‰€æœ‰æ–‡å­—æ­£ç¡®è¾“å…¥ï¼ˆä¸åŒ…å«å›¾ç‰‡æ ‡è®°ï¼‰
- [ ] æ‰€æœ‰å›¾ç‰‡æ­£ç¡®ä¸Šä¼ 
- [ ] å›¾ç‰‡æ•°é‡åŒ¹é…
- [ ] æ–‡å­—é•¿åº¦åŒ¹é…
- [ ] éªŒè¯ç®—æ³•é€šè¿‡
- [ ] é€‰é¡¹æŒ‰é’®æˆåŠŸç‚¹å‡»
- [ ] å‘å¸ƒæŒ‰é’®æˆåŠŸç‚¹å‡»
- [ ] ç¡®è®¤å¯¹è¯æ¡†æˆåŠŸç‚¹å‡»
- [ ] æ–‡ç« æˆåŠŸå‘å¸ƒ

## ğŸ‰ æ€»ç»“

### ä¼˜åŠ¿
1. âœ… **é€»è¾‘æ›´ç®€å•**ï¼šå…ˆæ–‡å­—åå›¾ç‰‡ï¼Œæ¸…æ™°æ˜äº†
2. âœ… **æ›´æ˜“è°ƒè¯•**ï¼šæ¯ä¸ªæ­¥éª¤ç‹¬ç«‹ï¼Œå®¹æ˜“å®šä½é—®é¢˜
3. âœ… **æ›´å¿«é€Ÿåº¦**ï¼šæ–‡å­—è¾“å…¥é€Ÿåº¦ä»50msé™åˆ°30ms
4. âœ… **æ›´å¯é **ï¼šéªŒè¯ç®—æ³•ç¡®ä¿å†…å®¹å®Œæ•´
5. âœ… **æ›´è¯¦ç»†æ—¥å¿—**ï¼šæ¯æ­¥éƒ½æœ‰æ¸…æ™°çš„è¾“å‡º

### ä¸æ—§æ–¹æ¡ˆå¯¹æ¯”

| ç‰¹æ€§ | æ—§æ–¹æ¡ˆ | æ–°æ–¹æ¡ˆ |
|------|--------|--------|
| æ’å…¥é¡ºåº | æ–‡å­—å›¾ç‰‡äº¤æ›¿ | å…ˆæ–‡å­—åå›¾ç‰‡ |
| å¤æ‚åº¦ | é«˜ï¼ˆéœ€è¦è§£æä½ç½®ï¼‰ | ä½ï¼ˆåˆ†åˆ«å¤„ç†ï¼‰ |
| è°ƒè¯•éš¾åº¦ | éš¾ | æ˜“ |
| æ‰§è¡Œé€Ÿåº¦ | æ…¢ï¼ˆ50ms/å­—ç¬¦ï¼‰ | å¿«ï¼ˆ30ms/å­—ç¬¦ï¼‰ |
| éªŒè¯æœºåˆ¶ | æ—  | æœ‰ï¼ˆ5æ¬¡é‡è¯•ï¼‰ |

ä»£ç å·²ä¼˜åŒ–å®Œæˆï¼Œå¯ä»¥ç›´æ¥æµ‹è¯•ä½¿ç”¨ï¼
