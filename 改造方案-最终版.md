# GEO ç³»ç»Ÿæ¶æ„æ”¹é€ æ–¹æ¡ˆ - æœ€ç»ˆç‰ˆï¼ˆä¼˜åŒ–ç‰ˆï¼‰

## ğŸ“‹ æ”¹é€ æ ¸å¿ƒåŸåˆ™

### âŒ ä¸æ˜¯æ–°å¢åŠŸèƒ½
æ‰€æœ‰åŠŸèƒ½éƒ½å·²ç»å®ç°ï¼Œä¸éœ€è¦æ–°å¢ä»»ä½•åŠŸèƒ½ã€‚

### âœ… åªæ˜¯æ”¹å˜æ‰§è¡Œä½ç½®

**æ”¹é€ å‰ï¼š**
```
Windows ç«¯ï¼ˆç•Œé¢ï¼‰ â†’ æœåŠ¡å™¨ï¼ˆæ‰§è¡Œæ‰€æœ‰æ“ä½œï¼‰ â†’ è¿”å›ç»“æœ
```

**æ”¹é€ åï¼š**
```
Windows ç«¯ï¼ˆç•Œé¢ + æ‰§è¡Œæ“ä½œï¼‰ â†’ æœåŠ¡å™¨ï¼ˆä»…éªŒè¯é…é¢ï¼‰ â†’ è¿”å›éªŒè¯ç»“æœ
```

---

## ä¸€ã€åŠŸèƒ½åˆ†ç±»ï¼ˆæŒ‰æ‰§è¡Œä½ç½®ï¼‰

### ğŸŸ¢ ä¿ç•™åœ¨æœåŠ¡å™¨ï¼ˆç®¡ç†ã€éªŒè¯ã€æ§åˆ¶ï¼‰

| åŠŸèƒ½ | å½“å‰ä½ç½® | æ”¹é€ å | è¯´æ˜ |
|------|---------|--------|------|
| **ç”¨æˆ·è®¤è¯** | `server/src/routes/auth.ts` | âœ… ä¿ç•™ | JWT ç™»å½•ã€æ³¨å†Œã€åˆ·æ–° |
| **é…é¢éªŒè¯** | `server/src/routes/quota.ts` | âœ… ä¿ç•™ | éªŒè¯ç”¨æˆ·æ˜¯å¦æœ‰é…é¢ |
| **é…é¢é¢„æ‰£å‡** | `server/src/services/QuotaService.ts` | âœ… æ–°å¢ | é¢„æ‰£å‡ + ç¡®è®¤/é‡Šæ”¾æœºåˆ¶ |
| **è®¢é˜…ç®¡ç†** | `server/src/routes/subscription.ts` | âœ… ä¿ç•™ | å¥—é¤ã€è®¢å•ã€æ”¯ä»˜ |
| **AI ç”Ÿæˆ** | `server/src/routes/articleGeneration.ts` | âœ… ä¿ç•™ | DeepSeek/Gemini API |
| **ç”¨æˆ·ç®¡ç†** | `server/src/routes/users.ts` | âœ… ä¿ç•™ | ç”¨æˆ· CRUD |
| **ä»£ç†å•†ç®¡ç†** | `server/src/routes/agent.ts` | âœ… ä¿ç•™ | ä»£ç†å•†ç³»ç»Ÿ |
| **å®‰å…¨å®¡è®¡** | `server/src/routes/security.ts` | âœ… ä¿ç•™ | å®‰å…¨æ—¥å¿—ã€å®¡è®¡ |
| **æ•°æ®åŒæ­¥** | æ–°å¢ | âœ… æ–°å¢ | äº‘ç«¯æ•°æ®åŒæ­¥ |
| **åˆ†æä¸ŠæŠ¥** | æ–°å¢ | âœ… æ–°å¢ | å‘å¸ƒç»Ÿè®¡ã€é”™è¯¯è¿½è¸ªã€ç®¡ç†å‘˜åˆ†æé¡µé¢ |
| **é€‚é…å™¨ç‰ˆæœ¬** | æ–°å¢ | âœ… æ–°å¢ | é€‚é…å™¨çƒ­æ›´æ–°æ”¯æŒ |

### ğŸ”´ è¿ç§»åˆ° Windows ç«¯ï¼ˆå®é™…æ‰§è¡Œï¼‰

| åŠŸèƒ½ | å½“å‰ä½ç½® | è¿ç§»åˆ° | è¯´æ˜ |
|------|---------|--------|------|
| **æ–‡ç« å­˜å‚¨** | `server/src/routes/article.ts` + PostgreSQL | `windows-login-manager/electron/services/ArticleService.ts` + SQLite | æ–‡ç«  CRUD æœ¬åœ°åŒ– |
| **çŸ¥è¯†åº“å­˜å‚¨** | `server/src/routes/knowledgeBase.ts` + æ–‡ä»¶ç³»ç»Ÿ | `windows-login-manager/electron/services/KnowledgeBaseService.ts` + æœ¬åœ°æ–‡ä»¶ | æ–‡æ¡£æœ¬åœ°å­˜å‚¨ |
| **å›¾åº“å­˜å‚¨** | `server/src/routes/gallery.ts` + æ–‡ä»¶ç³»ç»Ÿ | `windows-login-manager/electron/services/GalleryService.ts` + æœ¬åœ°æ–‡ä»¶ | å›¾ç‰‡æœ¬åœ°å­˜å‚¨ |
| **å¹³å°è´¦å·å­˜å‚¨** | `server/src/routes/platformAccounts.ts` + PostgreSQL | `windows-login-manager/electron/services/AccountService.ts` + SQLite | Cookie æœ¬åœ°åŠ å¯† |
| **æµè§ˆå™¨è‡ªåŠ¨åŒ–** | `server/src/services/BrowserAutomationService.ts` | `windows-login-manager/electron/browser/BrowserAutomationService.ts` | Playwright æœ¬åœ°æ‰§è¡Œ |
| **å‘å¸ƒæ‰§è¡Œ** | `server/src/services/PublishingExecutor.ts` | `windows-login-manager/electron/publishing/PublishingExecutor.ts` | å‘å¸ƒä»»åŠ¡æœ¬åœ°æ‰§è¡Œ |
| **å¹³å°é€‚é…å™¨** | `server/src/services/adapters/*` | `windows-login-manager/electron/adapters/*` | 12+ å¹³å°é€‚é…å™¨ |
| **æ–‡æ¡£è§£æ** | `server/src/services/ContentParserService.ts` | `windows-login-manager/electron/services/ContentParserService.ts` | mammoth/pdf-parse |
| **å›¾ç‰‡å¤„ç†** | `server/src/services/ImageProcessingService.ts` | `windows-login-manager/electron/services/ImageProcessingService.ts` | å›¾ç‰‡å‹ç¼©/æ ¼å¼è½¬æ¢ |

---

## äºŒã€ğŸ”´ å…³é”®ä¼˜åŒ–ï¼šé…é¢é¢„æ‰£å‡æœºåˆ¶

### é—®é¢˜åˆ†æ

åŸæ–¹æ¡ˆã€Œå…ˆéªŒè¯ â†’ æ‰§è¡Œ â†’ å†æ‰£å‡ã€å­˜åœ¨ç«æ€æ¡ä»¶ï¼š

```
ç”¨æˆ· A éªŒè¯é…é¢ï¼ˆå‰©ä½™ 1ï¼‰â†’ é€šè¿‡
ç”¨æˆ· A å¼€å§‹æ‰§è¡Œï¼ˆè€—æ—¶ 30 ç§’ï¼‰
ç”¨æˆ· A åœ¨å¦ä¸€å°ç”µè„‘éªŒè¯é…é¢ï¼ˆå‰©ä½™ 1ï¼‰â†’ é€šè¿‡  â† æ¼æ´ï¼
ç”¨æˆ· A æ‰§è¡Œå®Œæˆ â†’ æ‰£å‡
ç”¨æˆ· A å¦ä¸€å°ç”µè„‘æ‰§è¡Œå®Œæˆ â†’ æ‰£å‡
ç»“æœï¼šé…é¢å˜æˆ -1
```

### è§£å†³æ–¹æ¡ˆï¼šé¢„æ‰£å‡æ¨¡å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Windows ç«¯  â”‚â”€â”€â”€â”€â–¶â”‚   æœåŠ¡å™¨     â”‚â”€â”€â”€â”€â–¶â”‚   æ•°æ®åº“    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                   â”‚
       â”‚  1. é¢„æ‰£å‡è¯·æ±‚     â”‚                   â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  é”å®šé…é¢         â”‚
       â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚  è¿”å› reservationIdâ”‚                   â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
       â”‚                   â”‚                   â”‚
       â”‚  2. æœ¬åœ°æ‰§è¡Œä»»åŠ¡   â”‚                   â”‚
       â”‚  ..................â”‚                   â”‚
       â”‚                   â”‚                   â”‚
       â”‚  3a. æˆåŠŸï¼šç¡®è®¤æ¶ˆè´¹ â”‚                   â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  æ‰£å‡é…é¢         â”‚
       â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚                   â”‚                   â”‚
       â”‚  3b. å¤±è´¥ï¼šé‡Šæ”¾é…é¢ â”‚                   â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  æ¢å¤é…é¢         â”‚
       â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
```

### æ•°æ®åº“è®¾è®¡

```sql
-- æ–°å¢é…é¢é¢„ç•™è¡¨
CREATE TABLE quota_reservations (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id INTEGER NOT NULL REFERENCES users(id),
    quota_type VARCHAR(50) NOT NULL,  -- 'article_generation', 'publish', 'knowledge_upload'
    amount INTEGER NOT NULL DEFAULT 1,
    status VARCHAR(20) NOT NULL DEFAULT 'reserved',  -- 'reserved', 'confirmed', 'released', 'expired'
    client_id VARCHAR(100),  -- Windows å®¢æˆ·ç«¯æ ‡è¯†
    task_info JSONB,  -- ä»»åŠ¡ç›¸å…³ä¿¡æ¯ï¼ˆç”¨äºè¿½è¸ªï¼‰
    created_at TIMESTAMP DEFAULT NOW(),
    expires_at TIMESTAMP NOT NULL,  -- é¢„ç•™è¿‡æœŸæ—¶é—´ï¼ˆé»˜è®¤ 10 åˆ†é’Ÿï¼‰
    confirmed_at TIMESTAMP,
    released_at TIMESTAMP
);

CREATE INDEX idx_quota_reservations_user_status ON quota_reservations(user_id, status);
CREATE INDEX idx_quota_reservations_expires ON quota_reservations(expires_at) WHERE status = 'reserved';
```

### API è®¾è®¡

```typescript
// 1. é¢„æ‰£å‡é…é¢
POST /api/quota/reserve
Request:
{
  quotaType: 'article_generation' | 'publish' | 'knowledge_upload' | 'image_upload',
  amount: number,        // é¢„æ‰£å‡æ•°é‡ï¼Œé»˜è®¤ 1
  clientId?: string,     // å®¢æˆ·ç«¯æ ‡è¯†ï¼ˆç”¨äºå¤šè®¾å¤‡è¯†åˆ«ï¼‰
  taskInfo?: {           // å¯é€‰çš„ä»»åŠ¡ä¿¡æ¯
    taskType: string,
    platform?: string,
    articleId?: string
  }
}
Response:
{
  success: true,
  reservationId: 'uuid-xxx',
  expiresAt: '2025-01-14T12:10:00Z',  // 10 åˆ†é’Ÿåè¿‡æœŸ
  remainingQuota: 99  // é¢„æ‰£å‡åçš„å‰©ä½™é…é¢
}
Error:
{
  success: false,
  error: 'INSUFFICIENT_QUOTA',
  message: 'é…é¢ä¸è¶³',
  currentQuota: 0
}

// 2. ç¡®è®¤æ¶ˆè´¹ï¼ˆä»»åŠ¡æˆåŠŸï¼‰
POST /api/quota/confirm
Request:
{
  reservationId: 'uuid-xxx',
  result?: {             // å¯é€‰çš„æ‰§è¡Œç»“æœ
    status: 'success',
    publishUrl?: string,
    duration?: number
  }
}
Response:
{
  success: true,
  consumed: 1,
  remainingQuota: 99
}

// 3. é‡Šæ”¾é…é¢ï¼ˆä»»åŠ¡å¤±è´¥ï¼‰
POST /api/quota/release
Request:
{
  reservationId: 'uuid-xxx',
  reason?: string,       // å¤±è´¥åŸå› 
  errorCode?: string     // é”™è¯¯ç 
}
Response:
{
  success: true,
  released: 1,
  remainingQuota: 100
}

// 4. æŸ¥è¯¢é…é¢ä¿¡æ¯ï¼ˆä¿æŒä¸å˜ï¼‰
GET /api/quota/info
Response:
{
  quotas: {
    article_generation: { used: 10, limit: 100, reserved: 2 },
    publish: { used: 50, limit: 500, reserved: 0 },
    knowledge_upload: { used: 5, limit: 20, reserved: 1 }
  }
}
```

### æœåŠ¡ç«¯å®ç°è¦ç‚¹

```typescript
// server/src/services/QuotaReservationService.ts

class QuotaReservationService {
  // é¢„æ‰£å‡
  async reserve(userId: number, quotaType: string, amount: number = 1): Promise<ReservationResult> {
    return await db.transaction(async (trx) => {
      // 1. æ£€æŸ¥å¯ç”¨é…é¢ï¼ˆæ€»é…é¢ - å·²ç”¨ - å·²é¢„ç•™ï¼‰
      const available = await this.getAvailableQuota(userId, quotaType, trx);
      if (available < amount) {
        throw new InsufficientQuotaError();
      }
      
      // 2. åˆ›å»ºé¢„ç•™è®°å½•
      const reservation = await trx('quota_reservations').insert({
        user_id: userId,
        quota_type: quotaType,
        amount,
        status: 'reserved',
        expires_at: new Date(Date.now() + 10 * 60 * 1000)  // 10 åˆ†é’Ÿ
      }).returning('*');
      
      return {
        reservationId: reservation.id,
        expiresAt: reservation.expires_at
      };
    });
  }
  
  // ç¡®è®¤æ¶ˆè´¹
  async confirm(reservationId: string): Promise<void> {
    await db.transaction(async (trx) => {
      const reservation = await trx('quota_reservations')
        .where({ id: reservationId, status: 'reserved' })
        .first();
      
      if (!reservation) {
        throw new ReservationNotFoundError();
      }
      
      // 1. æ›´æ–°é¢„ç•™çŠ¶æ€
      await trx('quota_reservations')
        .where({ id: reservationId })
        .update({ status: 'confirmed', confirmed_at: new Date() });
      
      // 2. æ‰£å‡å®é™…é…é¢
      await this.consumeQuota(reservation.user_id, reservation.quota_type, reservation.amount, trx);
    });
  }
  
  // é‡Šæ”¾é…é¢
  async release(reservationId: string, reason?: string): Promise<void> {
    await db('quota_reservations')
      .where({ id: reservationId, status: 'reserved' })
      .update({ 
        status: 'released', 
        released_at: new Date(),
        task_info: db.raw(`task_info || ?`, [{ releaseReason: reason }])
      });
  }
  
  // å®šæ—¶æ¸…ç†è¿‡æœŸé¢„ç•™ï¼ˆæ¯åˆ†é’Ÿæ‰§è¡Œï¼‰
  async cleanupExpiredReservations(): Promise<number> {
    const result = await db('quota_reservations')
      .where('status', 'reserved')
      .where('expires_at', '<', new Date())
      .update({ status: 'expired' });
    
    return result;
  }
}
```

### Windows ç«¯è°ƒç”¨ç¤ºä¾‹

```typescript
// windows-login-manager/electron/services/QuotaClient.ts

class QuotaClient {
  // å¸¦é…é¢ä¿æŠ¤çš„ä»»åŠ¡æ‰§è¡Œ
  async executeWithQuota<T>(
    quotaType: string,
    taskFn: () => Promise<T>,
    taskInfo?: object
  ): Promise<T> {
    // 1. é¢„æ‰£å‡
    const { reservationId } = await this.reserve(quotaType, 1, taskInfo);
    
    try {
      // 2. æ‰§è¡Œä»»åŠ¡
      const result = await taskFn();
      
      // 3. ç¡®è®¤æ¶ˆè´¹
      await this.confirm(reservationId, { status: 'success' });
      
      return result;
    } catch (error) {
      // 4. é‡Šæ”¾é…é¢
      await this.release(reservationId, error.message);
      throw error;
    }
  }
}

// ä½¿ç”¨ç¤ºä¾‹ï¼šå‘å¸ƒæ–‡ç« 
const quotaClient = new QuotaClient();

await quotaClient.executeWithQuota(
  'publish',
  async () => {
    // å®é™…å‘å¸ƒé€»è¾‘
    return await publishingExecutor.execute(task);
  },
  { platform: 'xiaohongshu', articleId: '123' }
);
```

---

## ä¸‰ã€ğŸŸ¡ AI ç”Ÿæˆç¡®è®¤æœºåˆ¶

### é—®é¢˜åˆ†æ

AI ç”Ÿæˆæ–‡ç« åï¼Œå¦‚æœç½‘ç»œä¸­æ–­ï¼Œç”¨æˆ·å¯èƒ½ä¸¢å¤±å·²ç”Ÿæˆçš„æ–‡ç« ï¼ˆé…é¢å·²æ‰£ï¼Œä½†æ–‡ç« æ²¡ä¿å­˜ï¼‰ã€‚

### è§£å†³æ–¹æ¡ˆï¼šæœåŠ¡å™¨ä¸´æ—¶ç¼“å­˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Windows ç«¯  â”‚â”€â”€â”€â”€â–¶â”‚   æœåŠ¡å™¨     â”‚â”€â”€â”€â”€â–¶â”‚   Redis     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                   â”‚
       â”‚  1. ç”Ÿæˆè¯·æ±‚       â”‚                   â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  è°ƒç”¨ AI API      â”‚
       â”‚                   â”‚                   â”‚
       â”‚                   â”‚  ç¼“å­˜ç»“æœï¼ˆ10åˆ†é’Ÿï¼‰â”‚
       â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚                   â”‚                   â”‚
       â”‚  è¿”å› generationId â”‚                   â”‚
       â”‚  + æ–‡ç« å†…å®¹        â”‚                   â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
       â”‚                   â”‚                   â”‚
       â”‚  2. æœ¬åœ°ä¿å­˜æˆåŠŸ   â”‚                   â”‚
       â”‚                   â”‚                   â”‚
       â”‚  3. ç¡®è®¤æ”¶åˆ°       â”‚                   â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  åˆ é™¤ç¼“å­˜         â”‚
       â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚                   â”‚                   â”‚
       â”‚  [ç½‘ç»œä¸­æ–­æ¢å¤å]  â”‚                   â”‚
       â”‚  4. é‡æ–°è·å–       â”‚                   â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  ä»ç¼“å­˜è¯»å–       â”‚
       â”‚                   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚  è¿”å›æ–‡ç« å†…å®¹      â”‚                   â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
```

### API è®¾è®¡

```typescript
// 1. ç”Ÿæˆæ–‡ç« ï¼ˆæ”¹è¿›ç‰ˆï¼‰
POST /api/article-generation/generate
Response:
{
  success: true,
  generationId: 'gen-uuid-xxx',  // æ–°å¢ï¼šç”Ÿæˆ ID
  article: {
    title: '...',
    content: '...',
    ...
  },
  expiresAt: '2025-01-14T12:10:00Z'  // ç¼“å­˜è¿‡æœŸæ—¶é—´
}

// 2. ç¡®è®¤æ”¶åˆ°ï¼ˆæ–°å¢ï¼‰
POST /api/article-generation/confirm
Request:
{
  generationId: 'gen-uuid-xxx'
}
Response:
{
  success: true
}

// 3. é‡æ–°è·å–ï¼ˆæ–°å¢ï¼Œç”¨äºç½‘ç»œæ¢å¤åï¼‰
GET /api/article-generation/retrieve/:generationId
Response:
{
  success: true,
  article: { ... }
}
Error:
{
  success: false,
  error: 'GENERATION_EXPIRED',
  message: 'ç”Ÿæˆç»“æœå·²è¿‡æœŸ'
}
```

### æœåŠ¡ç«¯å®ç°

```typescript
// server/src/services/ArticleGenerationService.ts

class ArticleGenerationService {
  async generate(userId: number, params: GenerateParams): Promise<GenerationResult> {
    // 1. é¢„æ‰£å‡é…é¢
    const { reservationId } = await quotaService.reserve(userId, 'article_generation');
    
    try {
      // 2. è°ƒç”¨ AI API ç”Ÿæˆ
      const article = await this.callAI(params);
      
      // 3. ç¼“å­˜ç»“æœåˆ° Redisï¼ˆ10 åˆ†é’Ÿï¼‰
      const generationId = `gen-${uuidv4()}`;
      await redis.setex(
        `article:generation:${generationId}`,
        600,  // 10 åˆ†é’Ÿ
        JSON.stringify({ article, reservationId, userId })
      );
      
      // 4. ç¡®è®¤é…é¢æ¶ˆè´¹
      await quotaService.confirm(reservationId);
      
      return {
        generationId,
        article,
        expiresAt: new Date(Date.now() + 10 * 60 * 1000)
      };
    } catch (error) {
      // é‡Šæ”¾é…é¢
      await quotaService.release(reservationId, error.message);
      throw error;
    }
  }
  
  async confirm(generationId: string): Promise<void> {
    // å®¢æˆ·ç«¯ç¡®è®¤æ”¶åˆ°ï¼Œåˆ é™¤ç¼“å­˜
    await redis.del(`article:generation:${generationId}`);
  }
  
  async retrieve(generationId: string): Promise<Article | null> {
    const cached = await redis.get(`article:generation:${generationId}`);
    if (!cached) return null;
    return JSON.parse(cached).article;
  }
}
```

---

## å››ã€ğŸ”´ æ•°æ®åŒæ­¥åŠŸèƒ½ï¼ˆå¿…é¡»å®ç°ï¼‰

### åœºæ™¯

ç”¨æˆ·æ¢ç”µè„‘æˆ–é‡è£…ç³»ç»Ÿåï¼Œéœ€è¦æ¢å¤æœ¬åœ°æ•°æ®ã€‚

### è®¾è®¡åŸåˆ™

- ç”¨æˆ·ä¸»åŠ¨è§¦å‘ï¼Œéè‡ªåŠ¨åŒæ­¥
- æ•°æ®åŠ å¯†å­˜å‚¨
- é˜²æ­¢æ•°æ®ä¸¢å¤±çš„é‡è¦åŠŸèƒ½

### å¿«ç…§ç®¡ç†ç­–ç•¥

ä¸ºé˜²æ­¢å¿«ç…§æ— é™å¢é•¿ï¼Œé‡‡ç”¨ä»¥ä¸‹ç®¡ç†è§„åˆ™ï¼š

| è§„åˆ™ | è¯´æ˜ |
|------|------|
| æœ€å¤§å¿«ç…§æ•° | æ¯ç”¨æˆ·æœ€å¤šä¿ç•™ **3 ä¸ª** |
| è‡ªåŠ¨æ¸…ç† | ä¸Šä¼ æ–°å¿«ç…§æ—¶è‡ªåŠ¨åˆ é™¤æœ€æ—§çš„ |
| æ‰‹åŠ¨åˆ é™¤ | ç”¨æˆ·å¯ä¸»åŠ¨åˆ é™¤ä»»æ„å¿«ç…§ |
| è¿‡æœŸæ¸…ç† | 90 å¤©æœªä¸‹è½½çš„å¿«ç…§è‡ªåŠ¨åˆ é™¤ |
| å­˜å‚¨é™åˆ¶ | å•ä¸ªå¿«ç…§æœ€å¤§ 100MB |

### API è®¾è®¡

```typescript
// 1. ä¸Šä¼ æ•°æ®å¿«ç…§ï¼ˆè‡ªåŠ¨æ¸…ç†æ—§å¿«ç…§ï¼‰
POST /api/sync/upload
Request: (multipart/form-data)
{
  snapshot: File,  // åŠ å¯†çš„ SQLite æ•°æ®åº“æ–‡ä»¶ï¼ˆæœ€å¤§ 100MBï¼‰
  checksum: string,  // æ–‡ä»¶æ ¡éªŒå’Œ
  metadata: {
    version: '1.0.0',
    articleCount: 100,
    accountCount: 5,
    createdAt: '2025-01-14T12:00:00Z'
  }
}
Response:
{
  success: true,
  snapshotId: 'snap-xxx',
  uploadedAt: '2025-01-14T12:00:00Z',
  deletedOldSnapshots: 1,  // è‡ªåŠ¨åˆ é™¤çš„æ—§å¿«ç…§æ•°é‡
  remainingSnapshots: 3    // å½“å‰å‰©ä½™å¿«ç…§æ•°
}

// 2. è·å–å¿«ç…§åˆ—è¡¨
GET /api/sync/snapshots
Response:
{
  snapshots: [
    {
      id: 'snap-xxx',
      metadata: { ... },
      uploadedAt: '2025-01-14T12:00:00Z',
      lastDownloadedAt: '2025-01-15T10:00:00Z',  // æœ€åä¸‹è½½æ—¶é—´
      expiresAt: '2025-04-14T12:00:00Z',  // è¿‡æœŸæ—¶é—´ï¼ˆ90å¤©åï¼‰
      size: 1024000
    }
  ],
  maxSnapshots: 3,
  maxSizeBytes: 104857600  // 100MB
}

// 3. ä¸‹è½½æ•°æ®å¿«ç…§
GET /api/sync/download/:snapshotId
Response: File (åŠ å¯†çš„ SQLite æ•°æ®åº“)
// ä¸‹è½½åè‡ªåŠ¨æ›´æ–° lastDownloadedAtï¼Œé‡ç½®è¿‡æœŸæ—¶é—´

// 4. åˆ é™¤å¿«ç…§
DELETE /api/sync/snapshots/:snapshotId
```

### æœåŠ¡ç«¯å®ç°

```typescript
// server/src/services/SyncService.ts

class SyncService {
  private readonly MAX_SNAPSHOTS = 3;
  private readonly MAX_SIZE_BYTES = 100 * 1024 * 1024;  // 100MB
  private readonly EXPIRE_DAYS = 90;

  async uploadSnapshot(userId: number, file: Buffer, metadata: object): Promise<UploadResult> {
    // 1. éªŒè¯æ–‡ä»¶å¤§å°
    if (file.length > this.MAX_SIZE_BYTES) {
      throw new Error('å¿«ç…§æ–‡ä»¶è¶…è¿‡ 100MB é™åˆ¶');
    }

    // 2. ä¿å­˜æ–°å¿«ç…§
    const newSnapshot = await this.saveSnapshot(userId, file, metadata);

    // 3. æ£€æŸ¥å¹¶æ¸…ç†æ—§å¿«ç…§
    const deletedCount = await this.cleanupOldSnapshots(userId);

    return {
      snapshotId: newSnapshot.id,
      deletedOldSnapshots: deletedCount,
      remainingSnapshots: await this.getSnapshotCount(userId)
    };
  }

  private async cleanupOldSnapshots(userId: number): Promise<number> {
    const snapshots = await db('sync_snapshots')
      .where({ user_id: userId })
      .orderBy('created_at', 'desc');

    // ä¿ç•™æœ€æ–°çš„ 3 ä¸ªï¼Œåˆ é™¤å…¶ä½™
    if (snapshots.length <= this.MAX_SNAPSHOTS) {
      return 0;
    }

    const toDelete = snapshots.slice(this.MAX_SNAPSHOTS);
    for (const snap of toDelete) {
      await this.deleteSnapshotFile(snap.file_path);
      await db('sync_snapshots').where({ id: snap.id }).delete();
    }

    return toDelete.length;
  }

  // å®šæ—¶ä»»åŠ¡ï¼šæ¸…ç†è¿‡æœŸå¿«ç…§ï¼ˆæ¯å¤©æ‰§è¡Œï¼‰
  async cleanupExpiredSnapshots(): Promise<number> {
    const expired = await db('sync_snapshots')
      .where('expires_at', '<', new Date())
      .select('*');

    for (const snap of expired) {
      await this.deleteSnapshotFile(snap.file_path);
      await db('sync_snapshots').where({ id: snap.id }).delete();
    }

    return expired.length;
  }

  // ä¸‹è½½æ—¶æ›´æ–°è¿‡æœŸæ—¶é—´
  async downloadSnapshot(snapshotId: string): Promise<Buffer> {
    const snapshot = await db('sync_snapshots').where({ id: snapshotId }).first();
    if (!snapshot) throw new Error('å¿«ç…§ä¸å­˜åœ¨');

    // æ›´æ–°æœ€åä¸‹è½½æ—¶é—´å’Œè¿‡æœŸæ—¶é—´
    await db('sync_snapshots')
      .where({ id: snapshotId })
      .update({
        last_downloaded_at: new Date(),
        expires_at: new Date(Date.now() + this.EXPIRE_DAYS * 24 * 60 * 60 * 1000)
      });

    return await this.readSnapshotFile(snapshot.file_path);
  }
}
```

### Windows ç«¯å®ç°

```typescript
// windows-login-manager/electron/services/SyncService.ts

class SyncService {
  private encryptionKey: string;
  
  // å¯¼å‡ºå¹¶ä¸Šä¼ 
  async backup(): Promise<BackupResult> {
    // 1. å¯¼å‡º SQLite æ•°æ®åº“
    const dbPath = this.getDbPath();
    
    // 2. åŠ å¯†æ•°æ®åº“æ–‡ä»¶
    const encrypted = await this.encrypt(dbPath);
    
    // 3. æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆ100MB é™åˆ¶ï¼‰
    if (encrypted.length > 100 * 1024 * 1024) {
      throw new Error('æ•°æ®åº“æ–‡ä»¶è¿‡å¤§ï¼Œæ— æ³•å¤‡ä»½');
    }
    
    // 4. è®¡ç®—æ ¡éªŒå’Œ
    const checksum = await this.calculateChecksum(encrypted);
    
    // 5. ä¸Šä¼ åˆ°æœåŠ¡å™¨
    const result = await apiClient.post('/api/sync/upload', {
      snapshot: encrypted,
      checksum,
      metadata: await this.getMetadata()
    });
    
    // 6. æç¤ºç”¨æˆ·æ¸…ç†æƒ…å†µ
    if (result.deletedOldSnapshots > 0) {
      console.log(`å·²è‡ªåŠ¨åˆ é™¤ ${result.deletedOldSnapshots} ä¸ªæ—§å¿«ç…§`);
    }
    
    return result;
  }
  
  // ä¸‹è½½å¹¶æ¢å¤
  async restore(snapshotId: string): Promise<void> {
    // 1. ä¸‹è½½å¿«ç…§
    const encrypted = await apiClient.get(`/api/sync/download/${snapshotId}`);
    
    // 2. éªŒè¯æ ¡éªŒå’Œ
    // 3. è§£å¯†
    const decrypted = await this.decrypt(encrypted);
    
    // 4. å¤‡ä»½å½“å‰æ•°æ®åº“
    await this.backupCurrentDb();
    
    // 5. æ¢å¤æ•°æ®åº“
    await this.restoreDb(decrypted);
  }
  
  // è·å–å¿«ç…§åˆ—è¡¨ï¼ˆå¸¦è¿‡æœŸæé†’ï¼‰
  async getSnapshots(): Promise<SnapshotInfo[]> {
    const result = await apiClient.get('/api/sync/snapshots');
    
    // æ ‡è®°å³å°†è¿‡æœŸçš„å¿«ç…§ï¼ˆ7 å¤©å†…ï¼‰
    return result.snapshots.map(snap => ({
      ...snap,
      isExpiringSoon: new Date(snap.expiresAt).getTime() - Date.now() < 7 * 24 * 60 * 60 * 1000
    }));
  }
}

---

## äº”ã€ï¿½ åˆ†æä¸ŠæŠ¥åŠŸèƒ½ï¼ˆå¿…é¡»å®ç°ï¼‰

### ç›®çš„

- ç»Ÿè®¡å‘å¸ƒæˆåŠŸç‡
- è¿½è¸ªå¸¸è§é”™è¯¯
- ä¼˜åŒ–å¹³å°é€‚é…å™¨
- ä¸ºç®¡ç†å‘˜æä¾›ç³»ç»Ÿè¿è¥æ•°æ®

### API è®¾è®¡

```typescript
// 1. å‘å¸ƒç»“æœä¸ŠæŠ¥ï¼ˆå¼‚æ­¥ï¼Œä¸é˜»å¡ä¸»æµç¨‹ï¼‰
POST /api/analytics/publish-report
Request:
{
  taskId: string,
  platform: string,
  status: 'success' | 'failed',
  duration: number,  // æ‰§è¡Œè€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
  errorCode?: string,
  errorMessage?: string,
  metadata?: {
    articleLength?: number,
    imageCount?: number,
    retryCount?: number
  }
}
Response:
{
  success: true
}

// 2. æ‰¹é‡ä¸ŠæŠ¥ï¼ˆç¦»çº¿åæ¢å¤ï¼‰
POST /api/analytics/publish-report/batch
Request:
{
  reports: [...]
}

// 3. ç®¡ç†å‘˜æŸ¥è¯¢æ¥å£
GET /api/admin/analytics/overview
Query: { startDate, endDate }
Response:
{
  totalPublishes: 12500,
  successCount: 11200,
  failedCount: 1300,
  successRate: 89.6,
  avgDuration: 15000,
  platformStats: [
    { platform: 'xiaohongshu', total: 3200, success: 2900, failed: 300, successRate: 90.6 },
    { platform: 'douyin', total: 2800, success: 2500, failed: 300, successRate: 89.3 },
    // ...
  ],
  errorStats: [
    { errorCode: 'LOGIN_FAILED', count: 450, percentage: 34.6 },
    { errorCode: 'NETWORK_TIMEOUT', count: 320, percentage: 24.6 },
    // ...
  ],
  dailyTrend: [
    { date: '2025-01-01', total: 450, success: 400, failed: 50 },
    { date: '2025-01-02', total: 520, success: 470, failed: 50 },
    // ...
  ]
}

// 4. å¹³å°è¯¦ç»†ç»Ÿè®¡
GET /api/admin/analytics/platform/:platformId
Query: { startDate, endDate }
Response:
{
  platform: 'xiaohongshu',
  totalPublishes: 3200,
  successCount: 2900,
  failedCount: 300,
  successRate: 90.6,
  avgDuration: 12000,
  errorBreakdown: [
    { errorCode: 'LOGIN_FAILED', count: 150, percentage: 50 },
    { errorCode: 'IMAGE_UPLOAD_FAILED', count: 80, percentage: 26.7 },
    // ...
  ],
  hourlyDistribution: [
    { hour: 0, count: 50 },
    { hour: 1, count: 30 },
    // ...
  ],
  recentErrors: [
    {
      taskId: 'task-xxx',
      userId: 123,
      username: 'user@example.com',
      errorCode: 'LOGIN_FAILED',
      errorMessage: 'ç™»å½•å¤±è´¥ï¼šéªŒè¯ç é”™è¯¯',
      createdAt: '2025-01-14T10:30:00Z'
    },
    // ...
  ]
}

// 5. é”™è¯¯è¯¦æƒ…æŸ¥è¯¢
GET /api/admin/analytics/errors
Query: { platform?, errorCode?, startDate, endDate, page, pageSize }
Response:
{
  total: 1300,
  page: 1,
  pageSize: 20,
  errors: [
    {
      id: 1,
      taskId: 'task-xxx',
      userId: 123,
      username: 'user@example.com',
      platform: 'xiaohongshu',
      errorCode: 'LOGIN_FAILED',
      errorMessage: 'ç™»å½•å¤±è´¥ï¼šéªŒè¯ç é”™è¯¯',
      duration: 5000,
      metadata: { retryCount: 3 },
      createdAt: '2025-01-14T10:30:00Z'
    },
    // ...
  ]
}

// 6. ç”¨æˆ·å‘å¸ƒç»Ÿè®¡
GET /api/admin/analytics/users
Query: { startDate, endDate, sortBy, page, pageSize }
Response:
{
  total: 500,
  users: [
    {
      userId: 123,
      username: 'user@example.com',
      totalPublishes: 450,
      successCount: 420,
      failedCount: 30,
      successRate: 93.3,
      avgDuration: 14000,
      mostUsedPlatform: 'xiaohongshu'
    },
    // ...
  ]
}
```

### Windows ç«¯å®ç°

```typescript
// windows-login-manager/electron/services/AnalyticsService.ts

class AnalyticsService {
  private pendingReports: PublishReport[] = [];
  
  // ä¸ŠæŠ¥å‘å¸ƒç»“æœï¼ˆéé˜»å¡ï¼‰
  async reportPublish(report: PublishReport): Promise<void> {
    try {
      await apiClient.post('/api/analytics/publish-report', report);
    } catch (error) {
      // ç½‘ç»œå¤±è´¥æ—¶ï¼Œä¿å­˜åˆ°æœ¬åœ°é˜Ÿåˆ—
      this.pendingReports.push(report);
      await this.savePendingReports();
    }
  }
  
  // å®šæ—¶é‡è¯•ä¸ŠæŠ¥
  async flushPendingReports(): Promise<void> {
    if (this.pendingReports.length === 0) return;
    
    try {
      await apiClient.post('/api/analytics/publish-report/batch', {
        reports: this.pendingReports
      });
      this.pendingReports = [];
      await this.savePendingReports();
    } catch (error) {
      // ç»§ç»­ä¿ç•™ï¼Œä¸‹æ¬¡é‡è¯•
    }
  }
}
```

### ç®¡ç†å‘˜é¡µé¢è®¾è®¡ï¼ˆå¿…é¡»å®ç°ï¼‰

#### é¡µé¢ä½ç½®
- è·¯ç”±ï¼š`/admin/analytics`
- èœå•ï¼šç®¡ç†å‘˜èœå• â†’ å‘å¸ƒåˆ†æ
- æƒé™ï¼šä»…ç®¡ç†å‘˜å¯è®¿é—®

#### é¡µé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‘å¸ƒåˆ†æ                                    [æ—¥æœŸé€‰æ‹©å™¨]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ æ€»å‘å¸ƒæ¬¡æ•°   â”‚  â”‚ æˆåŠŸæ¬¡æ•°     â”‚  â”‚ å¤±è´¥æ¬¡æ•°     â”‚         â”‚
â”‚  â”‚   12,500    â”‚  â”‚   11,200    â”‚  â”‚   1,300     â”‚         â”‚
â”‚  â”‚  â†‘ 15.2%   â”‚  â”‚  â†‘ 18.3%   â”‚  â”‚  â†“ 8.5%    â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ æˆåŠŸç‡       â”‚  â”‚ å¹³å‡è€—æ—¶     â”‚  â”‚ æ´»è·ƒç”¨æˆ·     â”‚         â”‚
â”‚  â”‚   89.6%     â”‚  â”‚   15.2s     â”‚  â”‚    450      â”‚         â”‚
â”‚  â”‚  â†‘ 2.1%    â”‚  â”‚  â†“ 1.3s    â”‚  â”‚  â†‘ 12.5%   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‘å¸ƒè¶‹åŠ¿å›¾ï¼ˆæŠ˜çº¿å›¾ï¼‰                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚  500 â”¤                                    â•­â”€â•®         â”‚ â”‚
â”‚  â”‚      â”‚                          â•­â”€â•®      â•­â•¯ â•°â•®        â”‚ â”‚
â”‚  â”‚  400 â”¤                    â•­â”€â•®  â•­â•¯ â•°â•®    â•­â•¯   â•°â•®       â”‚ â”‚
â”‚  â”‚      â”‚              â•­â”€â•®  â•­â•¯ â•°â•®â•­â•¯   â•°â•®  â•­â•¯     â•°â•®      â”‚ â”‚
â”‚  â”‚  300 â”¤        â•­â”€â•®  â•­â•¯ â•°â•®â•­â•¯   â•°â•¯     â•°â•®â•­â•¯       â•°â•®     â”‚ â”‚
â”‚  â”‚      â”‚  â•­â”€â•®  â•­â•¯ â•°â•®â•­â•¯   â•°â•¯             â•°â•¯         â•°â”€   â”‚ â”‚
â”‚  â”‚  200 â”¼â”€â”€â”´â”€â”´â”€â”€â”´â”€â”€â”€â”´â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”‚
â”‚  â”‚      1/1  1/3  1/5  1/7  1/9  1/11 1/13 1/15 1/17     â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚  â”€â”€â”€ æ€»å‘å¸ƒ  â”€â”€â”€ æˆåŠŸ  â”€â”€â”€ å¤±è´¥                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¹³å°ç»Ÿè®¡ï¼ˆè¡¨æ ¼ + æŸ±çŠ¶å›¾ï¼‰                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ å¹³å°      â”‚ æ€»æ•°  â”‚ æˆåŠŸ  â”‚ å¤±è´¥ â”‚ æˆåŠŸç‡ â”‚ å¹³å‡è€—æ—¶ â”‚   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ å°çº¢ä¹¦    â”‚ 3,200â”‚ 2,900â”‚  300 â”‚ 90.6% â”‚ 12.0s   â”‚â–“â–“â–“â”‚ â”‚
â”‚  â”‚ æŠ–éŸ³      â”‚ 2,800â”‚ 2,500â”‚  300 â”‚ 89.3% â”‚ 18.5s   â”‚â–“â–“â–“â”‚ â”‚
â”‚  â”‚ å¤´æ¡å·    â”‚ 2,100â”‚ 1,900â”‚  200 â”‚ 90.5% â”‚ 10.2s   â”‚â–“â–“â–“â”‚ â”‚
â”‚  â”‚ çŸ¥ä¹      â”‚ 1,800â”‚ 1,600â”‚  200 â”‚ 88.9% â”‚ 15.8s   â”‚â–“â–“ â”‚ â”‚
â”‚  â”‚ ç™¾å®¶å·    â”‚ 1,500â”‚ 1,350â”‚  150 â”‚ 90.0% â”‚ 14.3s   â”‚â–“â–“ â”‚ â”‚
â”‚  â”‚ å¾®ä¿¡å…¬ä¼—å· â”‚ 1,100â”‚  950 â”‚  150 â”‚ 86.4% â”‚ 20.1s   â”‚â–“â–“ â”‚ â”‚
â”‚  â”‚ [æŸ¥çœ‹è¯¦æƒ…] æŒ‰é’®                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é”™è¯¯ç»Ÿè®¡ï¼ˆé¥¼å›¾ + è¡¨æ ¼ï¼‰                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  â”‚  â”‚ é”™è¯¯ç±»å‹    â”‚ æ¬¡æ•° â”‚ å æ¯”    â”‚   â”‚
â”‚  â”‚      â•±â”€â•²         â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚    â•±34.6%â•²       â”‚  â”‚ ç™»å½•å¤±è´¥    â”‚ 450 â”‚ 34.6%  â”‚   â”‚
â”‚  â”‚   â”‚       â”‚      â”‚  â”‚ ç½‘ç»œè¶…æ—¶    â”‚ 320 â”‚ 24.6%  â”‚   â”‚
â”‚  â”‚   â”‚ 24.6% â”‚      â”‚  â”‚ å›¾ç‰‡ä¸Šä¼ å¤±è´¥â”‚ 280 â”‚ 21.5%  â”‚   â”‚
â”‚  â”‚    â•²     â•±       â”‚  â”‚ å†…å®¹å®¡æ ¸å¤±è´¥â”‚ 150 â”‚ 11.5%  â”‚   â”‚
â”‚  â”‚     â•²â”€â•±  21.5%   â”‚  â”‚ å…¶ä»–é”™è¯¯    â”‚ 100 â”‚  7.7%  â”‚   â”‚
â”‚  â”‚                  â”‚  â”‚ [æŸ¥çœ‹è¯¦æƒ…] æŒ‰é’®              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### é¡µé¢åŠŸèƒ½æ¨¡å—

**1. é¡¶éƒ¨ç»Ÿè®¡å¡ç‰‡ï¼ˆ6 ä¸ªï¼‰**
- æ€»å‘å¸ƒæ¬¡æ•°ï¼šæ˜¾ç¤ºæ€»æ•° + ç¯æ¯”å¢é•¿
- æˆåŠŸæ¬¡æ•°ï¼šæ˜¾ç¤ºæˆåŠŸæ•° + ç¯æ¯”å¢é•¿
- å¤±è´¥æ¬¡æ•°ï¼šæ˜¾ç¤ºå¤±è´¥æ•° + ç¯æ¯”å¢é•¿
- æˆåŠŸç‡ï¼šæ˜¾ç¤ºç™¾åˆ†æ¯” + ç¯æ¯”å˜åŒ–
- å¹³å‡è€—æ—¶ï¼šæ˜¾ç¤ºç§’æ•° + ç¯æ¯”å˜åŒ–
- æ´»è·ƒç”¨æˆ·ï¼šæ˜¾ç¤ºç”¨æˆ·æ•° + ç¯æ¯”å¢é•¿

**2. å‘å¸ƒè¶‹åŠ¿å›¾ï¼ˆECharts æŠ˜çº¿å›¾ï¼‰**
- X è½´ï¼šæ—¥æœŸ
- Y è½´ï¼šå‘å¸ƒæ¬¡æ•°
- ä¸‰æ¡çº¿ï¼šæ€»å‘å¸ƒã€æˆåŠŸã€å¤±è´¥
- æ”¯æŒç¼©æ”¾ã€æ•°æ®ç‚¹æ‚¬åœæ˜¾ç¤ºè¯¦æƒ…
- å¯åˆ‡æ¢æ—¶é—´ç²’åº¦ï¼šæŒ‰å¤©/æŒ‰å‘¨/æŒ‰æœˆ

**3. å¹³å°ç»Ÿè®¡è¡¨æ ¼**
- åˆ—ï¼šå¹³å°åç§°ã€æ€»æ•°ã€æˆåŠŸã€å¤±è´¥ã€æˆåŠŸç‡ã€å¹³å‡è€—æ—¶
- æˆåŠŸç‡åˆ—æ˜¾ç¤ºè¿›åº¦æ¡
- æ”¯æŒæŒ‰æˆåŠŸç‡/æ€»æ•°æ’åº
- æ¯è¡Œæœ‰"æŸ¥çœ‹è¯¦æƒ…"æŒ‰é’®ï¼Œè·³è½¬åˆ°å¹³å°è¯¦æƒ…é¡µ

**4. é”™è¯¯ç»Ÿè®¡**
- å·¦ä¾§ï¼šé¥¼å›¾æ˜¾ç¤ºé”™è¯¯ç±»å‹å æ¯”
- å³ä¾§ï¼šè¡¨æ ¼æ˜¾ç¤ºé”™è¯¯è¯¦æƒ…
- ç‚¹å‡»é¥¼å›¾æ‰‡åŒºé«˜äº®å¯¹åº”è¡¨æ ¼è¡Œ
- "æŸ¥çœ‹è¯¦æƒ…"æŒ‰é’®è·³è½¬åˆ°é”™è¯¯åˆ—è¡¨é¡µ

**5. æ—¥æœŸé€‰æ‹©å™¨**
- é¢„è®¾é€‰é¡¹ï¼šä»Šå¤©ã€æœ€è¿‘7å¤©ã€æœ€è¿‘30å¤©ã€è‡ªå®šä¹‰
- æ”¯æŒæ—¥æœŸèŒƒå›´é€‰æ‹©
- é€‰æ‹©åè‡ªåŠ¨åˆ·æ–°æ‰€æœ‰æ•°æ®

#### å¹³å°è¯¦æƒ…é¡µï¼ˆç‚¹å‡»å¹³å°ç»Ÿè®¡è¡¨æ ¼çš„"æŸ¥çœ‹è¯¦æƒ…"ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† è¿”å›  å°çº¢ä¹¦å‘å¸ƒåˆ†æ                    [æ—¥æœŸé€‰æ‹©å™¨]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ æ€»å‘å¸ƒæ¬¡æ•°   â”‚  â”‚ æˆåŠŸç‡       â”‚  â”‚ å¹³å‡è€—æ—¶     â”‚         â”‚
â”‚  â”‚   3,200     â”‚  â”‚   90.6%     â”‚  â”‚   12.0s     â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é”™è¯¯ç±»å‹åˆ†å¸ƒï¼ˆæŸ±çŠ¶å›¾ï¼‰                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 150 â”¤ â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“                                 â”‚ â”‚
â”‚  â”‚ 100 â”¤ â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“                     â”‚ â”‚
â”‚  â”‚  50 â”¤ â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“  â–“â–“â–“â–“â–“â–“             â”‚ â”‚
â”‚  â”‚   0 â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚ â”‚
â”‚  â”‚      ç™»å½•å¤±è´¥  å›¾ç‰‡ä¸Šä¼   å†…å®¹å®¡æ ¸  ç½‘ç»œè¶…æ—¶  å…¶ä»–      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‘å¸ƒæ—¶æ®µåˆ†å¸ƒï¼ˆçƒ­åŠ›å›¾ï¼‰                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æ—¶æ®µ â”‚ 0-6 â”‚ 6-12â”‚12-18â”‚18-24â”‚                        â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ å‘¨ä¸€ â”‚ â–‘â–‘  â”‚ â–“â–“â–“ â”‚ â–“â–“â–“ â”‚ â–“â–“  â”‚                        â”‚ â”‚
â”‚  â”‚ å‘¨äºŒ â”‚ â–‘   â”‚ â–“â–“â–“ â”‚ â–“â–“â–“ â”‚ â–“â–“â–“ â”‚                        â”‚ â”‚
â”‚  â”‚ å‘¨ä¸‰ â”‚ â–‘   â”‚ â–“â–“  â”‚ â–“â–“â–“ â”‚ â–“â–“  â”‚                        â”‚ â”‚
â”‚  â”‚ ...                                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æœ€è¿‘é”™è¯¯è®°å½•ï¼ˆè¡¨æ ¼ï¼‰                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æ—¶é—´      â”‚ ç”¨æˆ·      â”‚ é”™è¯¯ç±»å‹    â”‚ é”™è¯¯ä¿¡æ¯        â”‚   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ 10:30:25 â”‚ user@xx  â”‚ ç™»å½•å¤±è´¥    â”‚ éªŒè¯ç é”™è¯¯      â”‚   â”‚ â”‚
â”‚  â”‚ 10:28:15 â”‚ test@xx  â”‚ å›¾ç‰‡ä¸Šä¼ å¤±è´¥â”‚ æ–‡ä»¶è¿‡å¤§        â”‚   â”‚ â”‚
â”‚  â”‚ 10:25:40 â”‚ admin@xx â”‚ ç½‘ç»œè¶…æ—¶    â”‚ è¿æ¥è¶…æ—¶        â”‚   â”‚ â”‚
â”‚  â”‚ ...                                                    â”‚ â”‚
â”‚  â”‚ [åŠ è½½æ›´å¤š]                                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### é”™è¯¯åˆ—è¡¨é¡µï¼ˆç‚¹å‡»é”™è¯¯ç»Ÿè®¡çš„"æŸ¥çœ‹è¯¦æƒ…"ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† è¿”å›  é”™è¯¯è®°å½•                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç­›é€‰æ¡ä»¶ï¼š                                                   â”‚
â”‚  å¹³å°: [å…¨éƒ¨ â–¼]  é”™è¯¯ç±»å‹: [å…¨éƒ¨ â–¼]  æ—¥æœŸ: [æœ€è¿‘7å¤© â–¼]      â”‚
â”‚  æœç´¢: [è¾“å…¥ç”¨æˆ·åæˆ–ä»»åŠ¡ID]                    [æœç´¢] [é‡ç½®] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æ—¶é—´      â”‚å¹³å°â”‚ç”¨æˆ·â”‚é”™è¯¯ç±»å‹â”‚é”™è¯¯ä¿¡æ¯â”‚è€—æ—¶â”‚é‡è¯•â”‚æ“ä½œâ”‚   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ 01-14    â”‚å°çº¢â”‚userâ”‚ç™»å½•å¤±è´¥â”‚éªŒè¯ç é”™â”‚5.0sâ”‚ 3 â”‚è¯¦æƒ…â”‚   â”‚ â”‚
â”‚  â”‚ 10:30:25 â”‚ä¹¦ â”‚@xx â”‚        â”‚è¯¯      â”‚    â”‚   â”‚    â”‚   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ 01-14    â”‚æŠ–éŸ³â”‚testâ”‚å›¾ç‰‡ä¸Šä¼ â”‚æ–‡ä»¶è¿‡å¤§â”‚8.2sâ”‚ 2 â”‚è¯¦æƒ…â”‚   â”‚ â”‚
â”‚  â”‚ 10:28:15 â”‚   â”‚@xx â”‚å¤±è´¥    â”‚        â”‚    â”‚   â”‚    â”‚   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ ...                                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  å…± 1,300 æ¡  ç¬¬ 1/65 é¡µ  [ä¸Šä¸€é¡µ] [ä¸‹ä¸€é¡µ]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ç”¨æˆ·å‘å¸ƒç»Ÿè®¡é¡µï¼ˆæ–°å¢ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·å‘å¸ƒç»Ÿè®¡                              [æ—¥æœŸé€‰æ‹©å™¨]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ’åº: [å‘å¸ƒæ¬¡æ•° â–¼]  æœç´¢: [è¾“å…¥ç”¨æˆ·å]        [æœç´¢]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ç”¨æˆ·      â”‚æ€»å‘å¸ƒâ”‚æˆåŠŸâ”‚å¤±è´¥â”‚æˆåŠŸç‡â”‚å¹³å‡è€—æ—¶â”‚å¸¸ç”¨å¹³å°â”‚   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ user@xx   â”‚ 450 â”‚420â”‚ 30 â”‚93.3%â”‚ 14.0s â”‚å°çº¢ä¹¦  â”‚   â”‚ â”‚
â”‚  â”‚ test@xx   â”‚ 380 â”‚350â”‚ 30 â”‚92.1%â”‚ 15.2s â”‚æŠ–éŸ³    â”‚   â”‚ â”‚
â”‚  â”‚ admin@xx  â”‚ 320 â”‚300â”‚ 20 â”‚93.8%â”‚ 13.5s â”‚å¤´æ¡å·  â”‚   â”‚ â”‚
â”‚  â”‚ ...                                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  å…± 500 ä¸ªç”¨æˆ·  ç¬¬ 1/25 é¡µ  [ä¸Šä¸€é¡µ] [ä¸‹ä¸€é¡µ]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æŠ€æœ¯å®ç°è¦ç‚¹

**å‰ç«¯ç»„ä»¶ï¼ˆclient/src/pages/admin/ï¼‰**
```typescript
// AnalyticsOverviewPage.tsx - æ€»è§ˆé¡µ
// AnalyticsPlatformDetailPage.tsx - å¹³å°è¯¦æƒ…é¡µ
// AnalyticsErrorListPage.tsx - é”™è¯¯åˆ—è¡¨é¡µ
// AnalyticsUserStatsPage.tsx - ç”¨æˆ·ç»Ÿè®¡é¡µ
```

**æ•°æ®å¯è§†åŒ–åº“**
- ä½¿ç”¨ EChartsï¼ˆå·²æœ‰ä¾èµ–ï¼‰
- å›¾è¡¨ç±»å‹ï¼šæŠ˜çº¿å›¾ã€æŸ±çŠ¶å›¾ã€é¥¼å›¾ã€çƒ­åŠ›å›¾

**æ•°æ®åˆ·æ–°**
- é»˜è®¤è‡ªåŠ¨åˆ·æ–°ï¼šæ¯ 30 ç§’
- å¯æ‰‹åŠ¨åˆ·æ–°
- åˆ‡æ¢æ—¥æœŸèŒƒå›´æ—¶è‡ªåŠ¨åˆ·æ–°

**æƒé™æ§åˆ¶**
- è·¯ç”±å®ˆå«ï¼šæ£€æŸ¥ç”¨æˆ·è§’è‰²æ˜¯å¦ä¸º admin
- API ä¸­é—´ä»¶ï¼š`adminAuth` éªŒè¯ç®¡ç†å‘˜æƒé™

**æ€§èƒ½ä¼˜åŒ–**
- å¤§æ•°æ®é‡ä½¿ç”¨åˆ†é¡µ
- å›¾è¡¨æ•°æ®æŒ‰éœ€åŠ è½½
- ä½¿ç”¨ Redis ç¼“å­˜ç»Ÿè®¡ç»“æœï¼ˆ5 åˆ†é’Ÿï¼‰

---

## å…­ã€ğŸ”´ é€‚é…å™¨çƒ­æ›´æ–°åŠŸèƒ½ï¼ˆå¿…é¡»å®ç°ï¼‰

### é—®é¢˜åˆ†æ

å¹³å°é€‚é…å™¨ä»£ç åœ¨ Windows ç«¯ï¼Œå½“å¹³å°æ”¹ç‰ˆåï¼š
- åŸæ–¹æ¡ˆï¼šéœ€è¦å‘å¸ƒæ–°ç‰ˆå®¢æˆ·ç«¯ï¼Œç”¨æˆ·æ‰‹åŠ¨æ›´æ–°
- ä¼˜åŒ–æ–¹æ¡ˆï¼šæœåŠ¡å™¨æ¨é€é€‚é…å™¨æ›´æ–°ï¼Œå®¢æˆ·ç«¯è‡ªåŠ¨åŠ è½½

### è®¾è®¡åŸåˆ™

- é€‚é…å™¨ä»£ç ç‹¬ç«‹æ‰“åŒ…
- æœåŠ¡å™¨ç»´æŠ¤ç‰ˆæœ¬å·
- å®¢æˆ·ç«¯å¯åŠ¨æ—¶æ£€æŸ¥æ›´æ–°
- åŠ¨æ€åŠ è½½æ›´æ–°çš„é€‚é…å™¨

### API è®¾è®¡

```typescript
// 1. è·å–é€‚é…å™¨ç‰ˆæœ¬åˆ—è¡¨
GET /api/adapters/versions
Response:
{
  adapters: {
    xiaohongshu: { version: '1.2.3', updatedAt: '2025-01-14' },
    douyin: { version: '1.1.0', updatedAt: '2025-01-10' },
    zhihu: { version: '1.0.5', updatedAt: '2025-01-08' },
    // ...
  },
  minClientVersion: '2.0.0'  // æœ€ä½å®¢æˆ·ç«¯ç‰ˆæœ¬è¦æ±‚
}

// 2. ä¸‹è½½é€‚é…å™¨æ›´æ–°
GET /api/adapters/:platform/download
Response: JavaScript æ–‡ä»¶ï¼ˆé€‚é…å™¨ä»£ç ï¼‰

// 3. è·å–é€‚é…å™¨æ›´æ–°æ—¥å¿—
GET /api/adapters/:platform/changelog
Response:
{
  platform: 'xiaohongshu',
  versions: [
    { version: '1.2.3', date: '2025-01-14', changes: ['ä¿®å¤ç™»å½•æ£€æµ‹', 'ä¼˜åŒ–å›¾ç‰‡ä¸Šä¼ '] },
    { version: '1.2.2', date: '2025-01-10', changes: ['é€‚é…æ–°ç‰ˆç¼–è¾‘å™¨'] }
  ]
}
```

### Windows ç«¯å®ç°

```typescript
// windows-login-manager/electron/adapters/AdapterUpdater.ts

class AdapterUpdater {
  private adaptersDir: string;
  private localVersions: Map<string, string>;
  
  // æ£€æŸ¥å¹¶æ›´æ–°é€‚é…å™¨
  async checkAndUpdate(): Promise<UpdateResult> {
    // 1. è·å–æœåŠ¡å™¨ç‰ˆæœ¬
    const serverVersions = await apiClient.get('/api/adapters/versions');
    
    // 2. å¯¹æ¯”æœ¬åœ°ç‰ˆæœ¬
    const updates: string[] = [];
    for (const [platform, info] of Object.entries(serverVersions.adapters)) {
      const localVersion = this.localVersions.get(platform);
      if (!localVersion || this.isNewer(info.version, localVersion)) {
        updates.push(platform);
      }
    }
    
    // 3. ä¸‹è½½æ›´æ–°
    for (const platform of updates) {
      await this.downloadAdapter(platform);
    }
    
    return { updated: updates };
  }
  
  // ä¸‹è½½å•ä¸ªé€‚é…å™¨
  private async downloadAdapter(platform: string): Promise<void> {
    const code = await apiClient.get(`/api/adapters/${platform}/download`);
    
    // ä¿å­˜åˆ°æœ¬åœ°
    const filePath = path.join(this.adaptersDir, `${platform}.js`);
    await fs.writeFile(filePath, code);
    
    // æ›´æ–°æœ¬åœ°ç‰ˆæœ¬è®°å½•
    this.localVersions.set(platform, serverVersions.adapters[platform].version);
    await this.saveLocalVersions();
  }
  
  // åŠ¨æ€åŠ è½½é€‚é…å™¨
  loadAdapter(platform: string): PlatformAdapter {
    const filePath = path.join(this.adaptersDir, `${platform}.js`);
    
    // æ¸…é™¤ç¼“å­˜ï¼Œç¡®ä¿åŠ è½½æœ€æ–°ç‰ˆæœ¬
    delete require.cache[require.resolve(filePath)];
    
    const AdapterClass = require(filePath).default;
    return new AdapterClass();
  }
}
```

---

## ä¸ƒã€è¯¦ç»†è¿ç§»æ¸…å•ï¼ˆå®Œæ•´ç‰ˆï¼‰

### ğŸ“¦ ä»æœåŠ¡å™¨è¿ç§»çš„æ–‡ä»¶

#### 1. æµè§ˆå™¨è‡ªåŠ¨åŒ–æ¨¡å—

```bash
# æºæ–‡ä»¶ï¼ˆæœåŠ¡å™¨ï¼‰
server/src/services/BrowserAutomationService.ts
server/src/config/browserConfig.ts
server/src/services/LoginStatusChecker.ts
server/src/utils/cookieNormalizer.ts

# ç›®æ ‡ä½ç½®ï¼ˆWindows ç«¯ï¼‰
windows-login-manager/electron/browser/BrowserAutomationService.ts
windows-login-manager/electron/browser/browserConfig.ts
windows-login-manager/electron/browser/LoginStatusChecker.ts
windows-login-manager/electron/utils/cookieNormalizer.ts
```

#### 2. å‘å¸ƒå¼•æ“æ¨¡å—

```bash
# æºæ–‡ä»¶ï¼ˆæœåŠ¡å™¨ï¼‰
server/src/services/PublishingExecutor.ts
server/src/services/BatchExecutor.ts
server/src/services/TaskScheduler.ts
server/src/services/ImageUploadService.ts

# ç›®æ ‡ä½ç½®ï¼ˆWindows ç«¯ï¼‰
windows-login-manager/electron/publishing/PublishingExecutor.ts
windows-login-manager/electron/publishing/BatchExecutor.ts
windows-login-manager/electron/publishing/TaskScheduler.ts
windows-login-manager/electron/publishing/ImageUploadService.ts
```

#### 3. å¹³å°é€‚é…å™¨æ¨¡å—

```bash
# æºæ–‡ä»¶ï¼ˆæœåŠ¡å™¨ï¼‰
server/src/services/adapters/PlatformAdapter.ts
server/src/services/adapters/AdapterRegistry.ts
server/src/services/adapters/XiaohongshuAdapter.ts
server/src/services/adapters/DouyinAdapter.ts
server/src/services/adapters/ToutiaoAdapter.ts
server/src/services/adapters/ZhihuAdapter.ts
server/src/services/adapters/BaijiahaoAdapter.ts
server/src/services/adapters/WangyiAdapter.ts
server/src/services/adapters/SohuAdapter.ts
server/src/services/adapters/CSDNAdapter.ts
server/src/services/adapters/JianshuAdapter.ts
server/src/services/adapters/WechatAdapter.ts
server/src/services/adapters/QieAdapter.ts
server/src/services/adapters/BilibiliAdapter.ts

# ç›®æ ‡ä½ç½®ï¼ˆWindows ç«¯ï¼‰
windows-login-manager/electron/adapters/
ï¼ˆä¿æŒç›¸åŒçš„æ–‡ä»¶åï¼‰
```

#### 4. æ–‡æ¡£è§£ææ¨¡å—ï¼ˆè¡¥å……ï¼‰

```bash
# æºæ–‡ä»¶ï¼ˆæœåŠ¡å™¨ï¼‰
server/src/services/ContentParserService.ts
server/src/services/DocumentParserService.ts

# ç›®æ ‡ä½ç½®ï¼ˆWindows ç«¯ï¼‰
windows-login-manager/electron/services/ContentParserService.ts
windows-login-manager/electron/services/DocumentParserService.ts
```

#### 5. å·¥å…·å‡½æ•°ï¼ˆè¡¥å……ï¼‰

```bash
# æºæ–‡ä»¶ï¼ˆæœåŠ¡å™¨ï¼‰
server/src/utils/encryption.ts
server/src/utils/fileUtils.ts

# ç›®æ ‡ä½ç½®ï¼ˆWindows ç«¯ï¼‰
windows-login-manager/electron/utils/encryption.ts
windows-login-manager/electron/utils/fileUtils.ts
```

### ğŸ†• Windows ç«¯æ–°å»ºçš„æ–‡ä»¶

#### 1. æœ¬åœ°æ•°æ®åº“

```bash
windows-login-manager/electron/database/sqlite.ts          # SQLite ç®¡ç†å™¨
windows-login-manager/electron/database/migrations/        # æ•°æ®åº“è¿ç§»ç›®å½•
windows-login-manager/electron/database/migrations/001_init.sql
```

#### 2. æœ¬åœ°æœåŠ¡å±‚

```bash
windows-login-manager/electron/services/ArticleService.ts        # æ–‡ç«  CRUD
windows-login-manager/electron/services/KnowledgeBaseService.ts  # çŸ¥è¯†åº“ç®¡ç†
windows-login-manager/electron/services/GalleryService.ts        # å›¾åº“ç®¡ç†
windows-login-manager/electron/services/AccountService.ts        # è´¦å·ç®¡ç†
windows-login-manager/electron/services/TaskService.ts           # ä»»åŠ¡ç®¡ç†
windows-login-manager/electron/services/SyncService.ts           # æ•°æ®åŒæ­¥ï¼ˆå¯é€‰ï¼‰
windows-login-manager/electron/services/AnalyticsService.ts      # åˆ†æä¸ŠæŠ¥ï¼ˆå¯é€‰ï¼‰
```

#### 3. é…é¢å®¢æˆ·ç«¯

```bash
windows-login-manager/electron/services/QuotaClient.ts           # é…é¢é¢„æ‰£å‡å®¢æˆ·ç«¯
```

#### 4. æ–‡ä»¶ç®¡ç†å™¨

```bash
windows-login-manager/electron/storage/FileManager.ts            # æ–‡ä»¶å­˜å‚¨ç®¡ç†
windows-login-manager/electron/storage/paths.ts                  # è·¯å¾„é…ç½®
```

#### 5. IPC å¤„ç†å™¨

```bash
windows-login-manager/electron/ipc/articleHandlers.ts
windows-login-manager/electron/ipc/knowledgeHandlers.ts
windows-login-manager/electron/ipc/galleryHandlers.ts
windows-login-manager/electron/ipc/accountHandlers.ts
windows-login-manager/electron/ipc/taskHandlers.ts
windows-login-manager/electron/ipc/publishHandlers.ts
windows-login-manager/electron/ipc/syncHandlers.ts
windows-login-manager/electron/ipc/index.ts                      # ç»Ÿä¸€æ³¨å†Œ
```

### âŒ æœåŠ¡å™¨ç«¯åˆ é™¤çš„æ–‡ä»¶

```bash
# åˆ é™¤æ•°æ® CRUD è·¯ç”±
server/src/routes/article.ts
server/src/routes/knowledgeBase.ts
server/src/routes/gallery.ts
server/src/routes/platformAccounts.ts

# åˆ é™¤æµè§ˆå™¨è‡ªåŠ¨åŒ–
server/src/services/BrowserAutomationService.ts
server/src/config/browserConfig.ts
server/src/services/LoginStatusChecker.ts

# åˆ é™¤å‘å¸ƒæ‰§è¡Œ
server/src/services/PublishingExecutor.ts
server/src/services/BatchExecutor.ts
server/src/services/TaskScheduler.ts
server/src/services/ImageUploadService.ts

# åˆ é™¤å¹³å°é€‚é…å™¨
server/src/services/adapters/*

# åˆ é™¤æ–‡æ¡£è§£æï¼ˆå¦‚æœä¸å†éœ€è¦æœåŠ¡ç«¯è§£æï¼‰
server/src/services/ContentParserService.ts
server/src/services/DocumentParserService.ts
```

### ğŸ”§ æœåŠ¡å™¨ç«¯æ–°å¢çš„æ–‡ä»¶

```bash
# é…é¢é¢„æ‰£å‡æœåŠ¡
server/src/services/QuotaReservationService.ts

# é…é¢é¢„æ‰£å‡è·¯ç”±
server/src/routes/quotaReservation.ts

# æ•°æ®åŒæ­¥è·¯ç”±ï¼ˆå¯é€‰ï¼‰
server/src/routes/sync.ts

# åˆ†æä¸ŠæŠ¥è·¯ç”±ï¼ˆå¯é€‰ï¼‰
server/src/routes/analytics.ts

# é€‚é…å™¨ç‰ˆæœ¬ç®¡ç†ï¼ˆå¯é€‰ï¼‰
server/src/routes/adapters.ts
server/src/services/AdapterVersionService.ts
```

---

## å…«ã€API æ¥å£å˜åŒ–ï¼ˆå®Œæ•´ç‰ˆï¼‰

### ğŸŸ¢ ä¿ç•™çš„æœåŠ¡å™¨ APIï¼ˆä¸å˜ï¼‰

```typescript
// è®¤è¯
POST   /api/auth/login
POST   /api/auth/register
POST   /api/auth/refresh
POST   /api/auth/logout

// AI ç”Ÿæˆï¼ˆç•¥å¾®è°ƒæ•´ï¼‰
POST   /api/article-generation/generate    // è¿”å› generationId
POST   /api/article-generation/confirm     // æ–°å¢ï¼šç¡®è®¤æ”¶åˆ°
GET    /api/article-generation/retrieve/:id // æ–°å¢ï¼šé‡æ–°è·å–

// è’¸é¦
POST   /api/distillation/distill
POST   /api/distillation/topics

// è®¢é˜…
GET    /api/subscription/products
POST   /api/subscription/create-order
GET    /api/subscription/my

// æ”¯ä»˜
POST   /api/payment/wechat/native
GET    /api/payment/order/:orderNo

// ç”¨æˆ·ç®¡ç†
GET    /api/users
POST   /api/users
PUT    /api/users/:id
DELETE /api/users/:id

// ä»£ç†å•†
GET    /api/agents
POST   /api/agents
```

### ğŸ”„ æ”¹è¿›çš„æœåŠ¡å™¨ API

```typescript
// é…é¢ï¼ˆæ”¹è¿›ç‰ˆ - é¢„æ‰£å‡æœºåˆ¶ï¼‰
POST   /api/quota/reserve              // æ–°å¢ï¼šé¢„æ‰£å‡
POST   /api/quota/confirm              // æ–°å¢ï¼šç¡®è®¤æ¶ˆè´¹
POST   /api/quota/release              // æ–°å¢ï¼šé‡Šæ”¾é…é¢
GET    /api/quota/info                 // ä¿ç•™ï¼šè·å–é…é¢ä¿¡æ¯ï¼ˆå¢åŠ  reserved å­—æ®µï¼‰
```

### ğŸ†• æ–°å¢çš„æœåŠ¡å™¨ API

```typescript
// æ•°æ®åŒæ­¥ï¼ˆå¯é€‰ï¼‰
POST   /api/sync/upload                // ä¸Šä¼ æ•°æ®å¿«ç…§
GET    /api/sync/snapshots             // è·å–å¿«ç…§åˆ—è¡¨
GET    /api/sync/download/:id          // ä¸‹è½½å¿«ç…§
DELETE /api/sync/snapshots/:id         // åˆ é™¤å¿«ç…§

// åˆ†æä¸ŠæŠ¥ï¼ˆå¯é€‰ï¼‰
POST   /api/analytics/publish-report   // å•æ¡ä¸ŠæŠ¥
POST   /api/analytics/publish-report/batch  // æ‰¹é‡ä¸ŠæŠ¥

// é€‚é…å™¨ç‰ˆæœ¬ï¼ˆå¯é€‰ï¼‰
GET    /api/adapters/versions          // è·å–ç‰ˆæœ¬åˆ—è¡¨
GET    /api/adapters/:platform/download // ä¸‹è½½é€‚é…å™¨
GET    /api/adapters/:platform/changelog // æ›´æ–°æ—¥å¿—
```

### âŒ åˆ é™¤çš„æœåŠ¡å™¨ API

```typescript
// æ–‡ç«  CRUD
GET    /api/articles
POST   /api/articles
PUT    /api/articles/:id
DELETE /api/articles/:id

// çŸ¥è¯†åº“ CRUD
GET    /api/knowledge-bases
POST   /api/knowledge-bases/upload
DELETE /api/knowledge-bases/:id

// å›¾åº“ CRUD
GET    /api/gallery/albums
POST   /api/gallery/upload
DELETE /api/gallery/images/:id

// å¹³å°è´¦å· CRUD
GET    /api/platform-accounts
POST   /api/platform-accounts
PUT    /api/platform-accounts/:id
DELETE /api/platform-accounts/:id

// å‘å¸ƒä»»åŠ¡æ‰§è¡Œ
POST   /api/publishing/tasks
POST   /api/publishing/tasks/execute
GET    /api/publishing/tasks/:id
```

### ğŸ†• æ–°å¢çš„ IPC é€šé“ï¼ˆWindows ç«¯ï¼‰

```typescript
// æ–‡ç« 
ipcMain.handle('article:create', ...)
ipcMain.handle('article:findAll', ...)
ipcMain.handle('article:findById', ...)
ipcMain.handle('article:update', ...)
ipcMain.handle('article:delete', ...)
ipcMain.handle('article:search', ...)

// çŸ¥è¯†åº“
ipcMain.handle('knowledge:upload', ...)
ipcMain.handle('knowledge:findAll', ...)
ipcMain.handle('knowledge:findById', ...)
ipcMain.handle('knowledge:delete', ...)
ipcMain.handle('knowledge:parse', ...)

// å›¾åº“
ipcMain.handle('gallery:createAlbum', ...)
ipcMain.handle('gallery:findAlbums', ...)
ipcMain.handle('gallery:uploadImage', ...)
ipcMain.handle('gallery:findImages', ...)
ipcMain.handle('gallery:deleteImage', ...)

// å¹³å°è´¦å·
ipcMain.handle('account:create', ...)
ipcMain.handle('account:findAll', ...)
ipcMain.handle('account:findById', ...)
ipcMain.handle('account:update', ...)
ipcMain.handle('account:delete', ...)
ipcMain.handle('account:checkLogin', ...)

// å‘å¸ƒä»»åŠ¡
ipcMain.handle('task:create', ...)
ipcMain.handle('task:execute', ...)
ipcMain.handle('task:findAll', ...)
ipcMain.handle('task:findById', ...)
ipcMain.handle('task:cancel', ...)

// æµè§ˆå™¨
ipcMain.handle('browser:launch', ...)
ipcMain.handle('browser:close', ...)
ipcMain.handle('browser:screenshot', ...)

// æ•°æ®åŒæ­¥ï¼ˆå¯é€‰ï¼‰
ipcMain.handle('sync:backup', ...)
ipcMain.handle('sync:restore', ...)
ipcMain.handle('sync:getSnapshots', ...)
```

---

## ä¹ã€æ•°æ®åº“è®¾è®¡

### æœåŠ¡å™¨ç«¯æ–°å¢è¡¨

```sql
-- é…é¢é¢„ç•™è¡¨
CREATE TABLE quota_reservations (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id INTEGER NOT NULL REFERENCES users(id),
    quota_type VARCHAR(50) NOT NULL,
    amount INTEGER NOT NULL DEFAULT 1,
    status VARCHAR(20) NOT NULL DEFAULT 'reserved',
    client_id VARCHAR(100),
    task_info JSONB,
    created_at TIMESTAMP DEFAULT NOW(),
    expires_at TIMESTAMP NOT NULL,
    confirmed_at TIMESTAMP,
    released_at TIMESTAMP
);

CREATE INDEX idx_quota_reservations_user_status ON quota_reservations(user_id, status);
CREATE INDEX idx_quota_reservations_expires ON quota_reservations(expires_at) WHERE status = 'reserved';

-- AI ç”Ÿæˆç¼“å­˜è¡¨ï¼ˆå¯é€‰ï¼Œä¹Ÿå¯ä»¥åªç”¨ Redisï¼‰
CREATE TABLE generation_cache (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id INTEGER NOT NULL REFERENCES users(id),
    content JSONB NOT NULL,
    created_at TIMESTAMP DEFAULT NOW(),
    expires_at TIMESTAMP NOT NULL,
    confirmed_at TIMESTAMP
);

-- æ•°æ®åŒæ­¥å¿«ç…§è¡¨ï¼ˆå¸¦ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼‰
CREATE TABLE sync_snapshots (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id INTEGER NOT NULL REFERENCES users(id),
    file_path VARCHAR(500) NOT NULL,
    file_size BIGINT NOT NULL,
    checksum VARCHAR(64) NOT NULL,
    metadata JSONB,
    created_at TIMESTAMP DEFAULT NOW(),
    last_downloaded_at TIMESTAMP,  -- æœ€åä¸‹è½½æ—¶é—´
    expires_at TIMESTAMP NOT NULL DEFAULT (NOW() + INTERVAL '90 days')  -- 90 å¤©åè¿‡æœŸ
);

CREATE INDEX idx_sync_snapshots_user ON sync_snapshots(user_id);
CREATE INDEX idx_sync_snapshots_expires ON sync_snapshots(expires_at);

-- å¿«ç…§ç®¡ç†è§„åˆ™ï¼š
-- 1. æ¯ç”¨æˆ·æœ€å¤š 3 ä¸ªå¿«ç…§
-- 2. ä¸Šä¼ æ–°å¿«ç…§æ—¶è‡ªåŠ¨åˆ é™¤æœ€æ—§çš„
-- 3. 90 å¤©æœªä¸‹è½½çš„å¿«ç…§è‡ªåŠ¨è¿‡æœŸåˆ é™¤
-- 4. å•ä¸ªå¿«ç…§æœ€å¤§ 100MB

-- å‘å¸ƒåˆ†æè¡¨
CREATE TABLE publish_analytics (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    task_id VARCHAR(100),
    platform VARCHAR(50) NOT NULL,
    status VARCHAR(20) NOT NULL,
    duration INTEGER,
    error_code VARCHAR(50),
    error_message TEXT,
    metadata JSONB,
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_publish_analytics_user ON publish_analytics(user_id);
CREATE INDEX idx_publish_analytics_platform ON publish_analytics(platform);
CREATE INDEX idx_publish_analytics_created ON publish_analytics(created_at);
```

### Windows ç«¯ SQLite è¡¨

```sql
-- æ–‡ç« è¡¨
CREATE TABLE articles (
    id TEXT PRIMARY KEY,
    title TEXT NOT NULL,
    content TEXT,
    summary TEXT,
    status TEXT DEFAULT 'draft',
    platform TEXT,
    tags TEXT,  -- JSON æ•°ç»„
    images TEXT,  -- JSON æ•°ç»„
    metadata TEXT,  -- JSON å¯¹è±¡
    created_at TEXT DEFAULT (datetime('now')),
    updated_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX idx_articles_status ON articles(status);
CREATE INDEX idx_articles_created ON articles(created_at);

-- çŸ¥è¯†åº“è¡¨
CREATE TABLE knowledge_bases (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    file_path TEXT NOT NULL,
    file_type TEXT,
    file_size INTEGER,
    content TEXT,  -- è§£æåçš„æ–‡æœ¬å†…å®¹
    metadata TEXT,  -- JSON å¯¹è±¡
    created_at TEXT DEFAULT (datetime('now'))
);

-- ç›¸å†Œè¡¨
CREATE TABLE albums (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    description TEXT,
    cover_image TEXT,
    image_count INTEGER DEFAULT 0,
    created_at TEXT DEFAULT (datetime('now')),
    updated_at TEXT DEFAULT (datetime('now'))
);

-- å›¾ç‰‡è¡¨
CREATE TABLE images (
    id TEXT PRIMARY KEY,
    album_id TEXT REFERENCES albums(id),
    file_path TEXT NOT NULL,
    file_name TEXT,
    file_size INTEGER,
    width INTEGER,
    height INTEGER,
    thumbnail_path TEXT,
    metadata TEXT,  -- JSON å¯¹è±¡
    created_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX idx_images_album ON images(album_id);

-- å¹³å°è´¦å·è¡¨
CREATE TABLE platform_accounts (
    id TEXT PRIMARY KEY,
    platform TEXT NOT NULL,
    account_name TEXT,
    account_id TEXT,
    cookies TEXT,  -- åŠ å¯†å­˜å‚¨
    status TEXT DEFAULT 'unknown',
    last_check_at TEXT,
    metadata TEXT,  -- JSON å¯¹è±¡
    created_at TEXT DEFAULT (datetime('now')),
    updated_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX idx_accounts_platform ON platform_accounts(platform);

-- å‘å¸ƒä»»åŠ¡è¡¨
CREATE TABLE publish_tasks (
    id TEXT PRIMARY KEY,
    article_id TEXT REFERENCES articles(id),
    account_id TEXT REFERENCES platform_accounts(id),
    platform TEXT NOT NULL,
    status TEXT DEFAULT 'pending',
    result TEXT,  -- JSON å¯¹è±¡
    error_message TEXT,
    started_at TEXT,
    completed_at TEXT,
    created_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX idx_tasks_status ON publish_tasks(status);
CREATE INDEX idx_tasks_article ON publish_tasks(article_id);

-- é…ç½®è¡¨
CREATE TABLE settings (
    key TEXT PRIMARY KEY,
    value TEXT,
    updated_at TEXT DEFAULT (datetime('now'))
);
```

---

## åã€å·¥ä½œæµç¨‹å¯¹æ¯”ï¼ˆå®Œæ•´ç‰ˆï¼‰

### åœºæ™¯ 1ï¼šåˆ›å»ºæ–‡ç« 

#### æ”¹é€ å‰
```
1. ç”¨æˆ·åœ¨ Windows ç«¯è¾“å…¥å†…å®¹
2. è°ƒç”¨æœåŠ¡å™¨ API: POST /api/articles
3. æœåŠ¡å™¨ä¿å­˜åˆ° PostgreSQL
4. è¿”å›æ–‡ç«  ID
5. Windows ç«¯æ˜¾ç¤ºæˆåŠŸ
```

#### æ”¹é€ å
```
1. ç”¨æˆ·åœ¨ Windows ç«¯è¾“å…¥å†…å®¹
2. è°ƒç”¨æœ¬åœ° IPC: window.electron.invoke('article:create', data)
3. Electron ä¿å­˜åˆ°æœ¬åœ° SQLite
4. è¿”å›æ–‡ç«  ID
5. Windows ç«¯æ˜¾ç¤ºæˆåŠŸ
```

**å˜åŒ–ï¼š** æ•°æ®å­˜å‚¨ä»æœåŠ¡å™¨ â†’ æœ¬åœ°ï¼Œæ— éœ€ç½‘ç»œ

---

### åœºæ™¯ 2ï¼šAI ç”Ÿæˆæ–‡ç« 

#### æ”¹é€ å‰
```
1. ç”¨æˆ·ç‚¹å‡»"ç”Ÿæˆæ–‡ç« "
2. è°ƒç”¨æœåŠ¡å™¨ API: POST /api/article-generation/generate
3. æœåŠ¡å™¨éªŒè¯é…é¢
4. æœåŠ¡å™¨è°ƒç”¨ DeepSeek API
5. æœåŠ¡å™¨ä¿å­˜æ–‡ç« åˆ° PostgreSQL
6. æœåŠ¡å™¨æ‰£å‡é…é¢
7. è¿”å›æ–‡ç« 
```

#### æ”¹é€ å
```
1. ç”¨æˆ·ç‚¹å‡»"ç”Ÿæˆæ–‡ç« "
2. è°ƒç”¨æœåŠ¡å™¨ API: POST /api/article-generation/generate
3. æœåŠ¡å™¨é¢„æ‰£å‡é…é¢ï¼ˆreserveï¼‰
4. æœåŠ¡å™¨è°ƒç”¨ DeepSeek API
5. æœåŠ¡å™¨ç¼“å­˜ç»“æœåˆ° Redisï¼ˆ10 åˆ†é’Ÿï¼‰
6. æœåŠ¡å™¨ç¡®è®¤é…é¢æ¶ˆè´¹ï¼ˆconfirmï¼‰
7. è¿”å› generationId + æ–‡ç« å†…å®¹
8. Windows ç«¯ä¿å­˜åˆ°æœ¬åœ° SQLite
9. è°ƒç”¨ POST /api/article-generation/confirm ç¡®è®¤æ”¶åˆ°
10. æœåŠ¡å™¨åˆ é™¤ Redis ç¼“å­˜
```

**å˜åŒ–ï¼š** 
- æœåŠ¡å™¨ä¸å†ä¿å­˜æ–‡ç« ï¼Œåªè´Ÿè´£ç”Ÿæˆ
- å¢åŠ ç¼“å­˜æœºåˆ¶ï¼Œé˜²æ­¢ç½‘ç»œä¸­æ–­ä¸¢å¤±
- é…é¢ä½¿ç”¨é¢„æ‰£å‡æœºåˆ¶

---

### åœºæ™¯ 3ï¼šä¸Šä¼ çŸ¥è¯†åº“

#### æ”¹é€ å‰
```
1. ç”¨æˆ·é€‰æ‹©æ–‡ä»¶
2. ä¸Šä¼ åˆ°æœåŠ¡å™¨: POST /api/knowledge-bases/upload
3. æœåŠ¡å™¨éªŒè¯é…é¢
4. æœåŠ¡å™¨ä¿å­˜æ–‡ä»¶åˆ°æ–‡ä»¶ç³»ç»Ÿ
5. æœåŠ¡å™¨è§£ææ–‡æ¡£å†…å®¹
6. æœåŠ¡å™¨ä¿å­˜å…ƒæ•°æ®åˆ° PostgreSQL
7. æœåŠ¡å™¨æ‰£å‡é…é¢
8. è¿”å›æˆåŠŸ
```

#### æ”¹é€ å
```
1. ç”¨æˆ·é€‰æ‹©æ–‡ä»¶
2. è°ƒç”¨æœåŠ¡å™¨é¢„æ‰£å‡: POST /api/quota/reserve
3. æœåŠ¡å™¨è¿”å› reservationId
4. è°ƒç”¨æœ¬åœ° IPC: window.electron.invoke('knowledge:upload', file)
5. Electron ä¿å­˜æ–‡ä»¶åˆ°æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ
6. Electron è§£ææ–‡æ¡£å†…å®¹ï¼ˆmammoth/pdf-parseï¼‰
7. Electron ä¿å­˜å…ƒæ•°æ®åˆ°æœ¬åœ° SQLite
8. è°ƒç”¨æœåŠ¡å™¨ç¡®è®¤: POST /api/quota/confirm
9. æ˜¾ç¤ºæˆåŠŸ
```

**å˜åŒ–ï¼š** 
- æ–‡ä»¶å­˜å‚¨ä»æœåŠ¡å™¨ â†’ æœ¬åœ°
- æ–‡æ¡£è§£æåœ¨æœ¬åœ°æ‰§è¡Œ
- æœåŠ¡å™¨åªè´Ÿè´£é…é¢éªŒè¯

---

### åœºæ™¯ 4ï¼šå‘å¸ƒæ–‡ç« 

#### æ”¹é€ å‰
```
1. ç”¨æˆ·ç‚¹å‡»"å‘å¸ƒ"
2. è°ƒç”¨æœåŠ¡å™¨ API: POST /api/publishing/tasks
3. æœåŠ¡å™¨åˆ›å»ºä»»åŠ¡
4. æœåŠ¡å™¨å¯åŠ¨ Playwright æµè§ˆå™¨
5. æœåŠ¡å™¨æ‰§è¡Œå‘å¸ƒ
6. æœåŠ¡å™¨æ‰£å‡é…é¢
7. è¿”å›ç»“æœ
```

#### æ”¹é€ å
```
1. ç”¨æˆ·ç‚¹å‡»"å‘å¸ƒ"
2. è°ƒç”¨æœåŠ¡å™¨é¢„æ‰£å‡: POST /api/quota/reserve
3. æœåŠ¡å™¨è¿”å› reservationId
4. è°ƒç”¨æœ¬åœ° IPC: window.electron.invoke('task:execute', taskData)
5. Electron ä»æœ¬åœ° SQLite è¯»å–æ–‡ç« 
6. Electron ä»æœ¬åœ° SQLite è¯»å–è´¦å· Cookie
7. Electron å¯åŠ¨ Playwright æµè§ˆå™¨
8. Electron æ‰§è¡Œå‘å¸ƒï¼ˆä½¿ç”¨å¹³å°é€‚é…å™¨ï¼‰
9. å‘å¸ƒæˆåŠŸ:
   - è°ƒç”¨æœåŠ¡å™¨ç¡®è®¤: POST /api/quota/confirm
   - ä¸ŠæŠ¥åˆ†æ: POST /api/analytics/publish-reportï¼ˆå¼‚æ­¥ï¼‰
10. å‘å¸ƒå¤±è´¥:
    - è°ƒç”¨æœåŠ¡å™¨é‡Šæ”¾: POST /api/quota/release
    - ä¸ŠæŠ¥é”™è¯¯: POST /api/analytics/publish-reportï¼ˆå¼‚æ­¥ï¼‰
11. æ˜¾ç¤ºç»“æœ
```

**å˜åŒ–ï¼š** 
- å‘å¸ƒæ‰§è¡Œä»æœåŠ¡å™¨ â†’ æœ¬åœ°
- æµè§ˆå™¨è‡ªåŠ¨åŒ–åœ¨æœ¬åœ°è¿è¡Œ
- æœåŠ¡å™¨åªè´Ÿè´£é…é¢éªŒè¯
- å¢åŠ åˆ†æä¸ŠæŠ¥ï¼ˆå¯é€‰ï¼‰

---

### åœºæ™¯ 5ï¼šæ•°æ®å¤‡ä»½ä¸æ¢å¤ï¼ˆæ–°å¢ï¼‰

#### å¤‡ä»½æµç¨‹
```
1. ç”¨æˆ·ç‚¹å‡»"å¤‡ä»½æ•°æ®"
2. è°ƒç”¨æœ¬åœ° IPC: window.electron.invoke('sync:backup')
3. Electron å¯¼å‡º SQLite æ•°æ®åº“
4. Electron åŠ å¯†æ•°æ®åº“æ–‡ä»¶
5. è°ƒç”¨æœåŠ¡å™¨: POST /api/sync/upload
6. æœåŠ¡å™¨ä¿å­˜åˆ°äº‘å­˜å‚¨
7. æ˜¾ç¤ºæˆåŠŸ
```

#### æ¢å¤æµç¨‹
```
1. ç”¨æˆ·ç‚¹å‡»"æ¢å¤æ•°æ®"
2. è°ƒç”¨æœåŠ¡å™¨: GET /api/sync/snapshots
3. æ˜¾ç¤ºå¿«ç…§åˆ—è¡¨
4. ç”¨æˆ·é€‰æ‹©å¿«ç…§
5. è°ƒç”¨æœåŠ¡å™¨: GET /api/sync/download/:id
6. è°ƒç”¨æœ¬åœ° IPC: window.electron.invoke('sync:restore', data)
7. Electron è§£å¯†æ•°æ®åº“æ–‡ä»¶
8. Electron å¤‡ä»½å½“å‰æ•°æ®åº“
9. Electron æ¢å¤æ•°æ®åº“
10. æ˜¾ç¤ºæˆåŠŸ
```

---

## åä¸€ã€ä¾èµ–åŒ…å˜åŒ–ï¼ˆç‰ˆæœ¬ä¸ç°æœ‰é¡¹ç›®ä¸€è‡´ï¼‰

### Windows ç«¯æ–°å¢ä¾èµ–

```json
// windows-login-manager/package.json - æ–°å¢ä¾èµ–
{
  "dependencies": {
    // æ•°æ®åº“ï¼ˆElectron å…¼å®¹çš„ SQLiteï¼‰
    "better-sqlite3": "^9.6.0",
    
    // æ–‡æ¡£è§£æï¼ˆä¸æœåŠ¡å™¨ç‰ˆæœ¬ä¸€è‡´ï¼‰
    "mammoth": "^1.6.0",
    "pdf-parse": "^1.1.1",
    
    // åŠ å¯†
    "crypto-js": "^4.2.0",
    
    // æµè§ˆå™¨è‡ªåŠ¨åŒ–ï¼ˆä¸æœåŠ¡å™¨ç‰ˆæœ¬ä¸€è‡´ï¼‰
    "playwright": "^1.57.0",
    
    // å·¥å…·ï¼ˆä¸ç°æœ‰ç‰ˆæœ¬ä¸€è‡´ï¼‰
    "uuid": "^9.0.1",
    "dayjs": "^1.11.10",  // å·²æœ‰ï¼Œç‰ˆæœ¬ä¸€è‡´
    "axios": "^1.6.2",     // å·²æœ‰ï¼Œç‰ˆæœ¬ä¸€è‡´
    "ws": "^8.18.3"        // å·²æœ‰ï¼Œç‰ˆæœ¬ä¸€è‡´
  },
  "devDependencies": {
    // SQLite åŸç”Ÿæ¨¡å—æ„å»º
    "@electron/rebuild": "^3.6.0"
  }
}
```

### Windows ç«¯ç°æœ‰ä¾èµ–ï¼ˆä¿æŒä¸å˜ï¼‰

```json
// ä»¥ä¸‹ä¾èµ–å·²å­˜åœ¨ï¼Œæ— éœ€ä¿®æ”¹
{
  "dependencies": {
    "@ant-design/icons": "^5.3.7",
    "antd": "^5.12.8",
    "axios": "^1.6.2",
    "dayjs": "^1.11.10",
    "dompurify": "^3.0.8",
    "echarts": "^5.4.3",
    "echarts-for-react": "^3.0.0",
    "electron-log": "^5.0.1",
    "electron-store": "^8.1.0",
    "electron-updater": "^6.1.7",
    "form-data": "^4.0.5",
    "qrcode.react": "^3.1.0",
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-markdown": "^9.0.1",
    "react-quill": "^2.0.0",
    "react-resizable": "^3.0.5",
    "react-router-dom": "^6.20.0",
    "remark-gfm": "^4.0.0",
    "ws": "^8.18.3",
    "zustand": "^4.4.7"
  },
  "devDependencies": {
    "@types/node": "^20.10.4",
    "@types/react": "^18.2.43",
    "@types/react-dom": "^18.2.17",
    "@types/ws": "^8.18.1",
    "electron": "^28.0.0",
    "electron-builder": "^24.9.1",
    "typescript": "^5.3.3",
    "vite": "^5.0.7"
  }
}
```

### æœåŠ¡å™¨ç«¯å¯ç§»é™¤çš„ä¾èµ–

```json
// server/package.json - æ”¹é€ åå¯ç§»é™¤
{
  "dependencies": {
    // æµè§ˆå™¨è‡ªåŠ¨åŒ–ï¼ˆç§»é™¤ï¼Œè¿ç§»åˆ° Windows ç«¯ï¼‰
    "playwright": "^1.57.0"  // ç§»é™¤
  }
}
```

### æœåŠ¡å™¨ç«¯ä¿ç•™çš„ä¾èµ–ï¼ˆä¸å˜ï¼‰

```json
// server/package.json - ä¿ç•™
{
  "dependencies": {
    "axios": "^1.6.2",
    "bcrypt": "^6.0.0",
    "cookie-parser": "^1.4.7",
    "cors": "^2.8.5",
    "dotenv": "^16.3.1",
    "express": "^4.18.2",
    "express-rate-limit": "^8.2.1",
    "helmet": "^8.1.0",
    "ioredis": "^5.8.2",
    "jsonwebtoken": "^9.0.3",
    "mammoth": "^1.6.0",      // ä¿ç•™ï¼ˆAI ç”Ÿæˆæ—¶å¯èƒ½éœ€è¦è§£æçŸ¥è¯†åº“ï¼‰
    "multer": "^2.0.2",
    "node-cron": "^4.2.1",
    "nodemailer": "^7.0.12",
    "pdf-parse": "^1.1.1",    // ä¿ç•™ï¼ˆAI ç”Ÿæˆæ—¶å¯èƒ½éœ€è¦è§£æçŸ¥è¯†åº“ï¼‰
    "pg": "^8.11.3",
    "redis": "^5.10.0",
    "wechatpay-axios-plugin": "^0.9.5",
    "ws": "^8.18.3",
    "zod": "^3.22.4"
  }
}
```

---

## åäºŒã€æ•°æ®åº“è¿ç§»è¯¦ç»†æ–¹æ¡ˆ

### 12.1 æœåŠ¡å™¨ç«¯ PostgreSQL æ–°å¢è¡¨

#### é…é¢é¢„ç•™è¡¨ï¼ˆå¿…é¡»ï¼‰

```sql
-- è¿ç§»æ–‡ä»¶: 062_quota_reservation_system.sql

-- ==================== UP ====================

-- é…é¢é¢„ç•™è¡¨
CREATE TABLE IF NOT EXISTS quota_reservations (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    quota_type VARCHAR(50) NOT NULL,  -- 'article_generation', 'publish', 'knowledge_upload', 'image_upload'
    amount INTEGER NOT NULL DEFAULT 1,
    status VARCHAR(20) NOT NULL DEFAULT 'reserved',  -- 'reserved', 'confirmed', 'released', 'expired'
    client_id VARCHAR(100),  -- Windows å®¢æˆ·ç«¯æ ‡è¯†ï¼ˆæœºå™¨ç ï¼‰
    task_info JSONB,  -- ä»»åŠ¡ç›¸å…³ä¿¡æ¯
    created_at TIMESTAMP DEFAULT NOW(),
    expires_at TIMESTAMP NOT NULL,  -- é¢„ç•™è¿‡æœŸæ—¶é—´ï¼ˆé»˜è®¤ 10 åˆ†é’Ÿï¼‰
    confirmed_at TIMESTAMP,
    released_at TIMESTAMP
);

-- ç´¢å¼•
CREATE INDEX idx_quota_reservations_user_status ON quota_reservations(user_id, status);
CREATE INDEX idx_quota_reservations_expires ON quota_reservations(expires_at) WHERE status = 'reserved';
CREATE INDEX idx_quota_reservations_created ON quota_reservations(created_at);

-- æ³¨é‡Š
COMMENT ON TABLE quota_reservations IS 'é…é¢é¢„ç•™è¡¨ - ç”¨äºé¢„æ‰£å‡æœºåˆ¶';
COMMENT ON COLUMN quota_reservations.quota_type IS 'é…é¢ç±»å‹: article_generation, publish, knowledge_upload, image_upload';
COMMENT ON COLUMN quota_reservations.status IS 'çŠ¶æ€: reserved(é¢„ç•™ä¸­), confirmed(å·²ç¡®è®¤), released(å·²é‡Šæ”¾), expired(å·²è¿‡æœŸ)';
COMMENT ON COLUMN quota_reservations.expires_at IS 'é¢„ç•™è¿‡æœŸæ—¶é—´ï¼Œé»˜è®¤ 10 åˆ†é’Ÿåè¿‡æœŸ';

-- ==================== DOWN ====================
DROP TABLE IF EXISTS quota_reservations;
```

#### æ•°æ®åŒæ­¥å¿«ç…§è¡¨

```sql
-- è¿ç§»æ–‡ä»¶: 063_sync_snapshots.sql

-- ==================== UP ====================

-- æ•°æ®åŒæ­¥å¿«ç…§è¡¨
CREATE TABLE IF NOT EXISTS sync_snapshots (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    file_path VARCHAR(500) NOT NULL,
    file_size BIGINT NOT NULL,
    checksum VARCHAR(64) NOT NULL,
    metadata JSONB,  -- { version, articleCount, accountCount, ... }
    created_at TIMESTAMP DEFAULT NOW(),
    last_downloaded_at TIMESTAMP,
    expires_at TIMESTAMP NOT NULL DEFAULT (NOW() + INTERVAL '90 days')
);

-- ç´¢å¼•
CREATE INDEX idx_sync_snapshots_user ON sync_snapshots(user_id);
CREATE INDEX idx_sync_snapshots_expires ON sync_snapshots(expires_at);
CREATE INDEX idx_sync_snapshots_created ON sync_snapshots(created_at);

-- æ³¨é‡Š
COMMENT ON TABLE sync_snapshots IS 'æ•°æ®åŒæ­¥å¿«ç…§è¡¨ - æ¯ç”¨æˆ·æœ€å¤š 3 ä¸ªï¼Œ90 å¤©è¿‡æœŸ';

-- ==================== DOWN ====================
DROP TABLE IF EXISTS sync_snapshots;
```

#### å‘å¸ƒåˆ†æè¡¨

```sql
-- è¿ç§»æ–‡ä»¶: 064_publish_analytics.sql

-- ==================== UP ====================

-- å‘å¸ƒåˆ†æè¡¨
CREATE TABLE IF NOT EXISTS publish_analytics (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id) ON DELETE SET NULL,
    task_id VARCHAR(100),
    platform VARCHAR(50) NOT NULL,
    status VARCHAR(20) NOT NULL,  -- 'success', 'failed'
    duration INTEGER,  -- æ‰§è¡Œè€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
    error_code VARCHAR(50),
    error_message TEXT,
    metadata JSONB,  -- { articleLength, imageCount, retryCount, ... }
    created_at TIMESTAMP DEFAULT NOW()
);

-- ç´¢å¼•
CREATE INDEX idx_publish_analytics_user ON publish_analytics(user_id);
CREATE INDEX idx_publish_analytics_platform ON publish_analytics(platform);
CREATE INDEX idx_publish_analytics_status ON publish_analytics(status);
CREATE INDEX idx_publish_analytics_created ON publish_analytics(created_at);

-- æ³¨é‡Š
COMMENT ON TABLE publish_analytics IS 'å‘å¸ƒåˆ†æè¡¨ - ç”¨äºç»Ÿè®¡å‘å¸ƒæˆåŠŸç‡å’Œé”™è¯¯è¿½è¸ª';

-- ==================== DOWN ====================
DROP TABLE IF EXISTS publish_analytics;
```

### 12.2 Windows ç«¯ SQLite å®Œæ•´è¡¨ç»“æ„

ä»¥ä¸‹æ˜¯ Windows ç«¯ SQLite æ•°æ®åº“çš„å®Œæ•´è¡¨ç»“æ„ï¼Œ**ä¸æœåŠ¡å™¨ç«¯ PostgreSQL è¡¨ç»“æ„å¯¹åº”**ï¼š

```sql
-- æ–‡ä»¶: windows-login-manager/electron/database/migrations/001_init.sql

-- ========================================
-- 1. æ–‡ç« è¡¨ï¼ˆå¯¹åº”æœåŠ¡å™¨ articles è¡¨ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS articles (
    id TEXT PRIMARY KEY,  -- UUID
    user_id INTEGER NOT NULL,  -- ç”¨æˆ· IDï¼ˆä»æœåŠ¡å™¨è·å–ï¼‰
    title TEXT,
    keyword TEXT NOT NULL,
    distillation_id INTEGER,
    topic_id INTEGER,
    task_id INTEGER,
    image_id INTEGER,
    requirements TEXT,
    content TEXT NOT NULL,
    image_url TEXT,
    image_size_bytes INTEGER DEFAULT 0,
    provider TEXT NOT NULL,  -- 'deepseek', 'gemini', 'ollama'
    is_published INTEGER DEFAULT 0,  -- SQLite ç”¨ INTEGER ä»£æ›¿ BOOLEAN
    publishing_status TEXT,
    published_at TEXT,
    -- å¿«ç…§å­—æ®µ
    distillation_keyword_snapshot TEXT,
    topic_question_snapshot TEXT,
    created_at TEXT DEFAULT (datetime('now')),
    updated_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX IF NOT EXISTS idx_articles_user_id ON articles(user_id);
CREATE INDEX IF NOT EXISTS idx_articles_keyword ON articles(keyword);
CREATE INDEX IF NOT EXISTS idx_articles_is_published ON articles(is_published);
CREATE INDEX IF NOT EXISTS idx_articles_created_at ON articles(created_at);

-- ========================================
-- 2. ç›¸å†Œè¡¨ï¼ˆå¯¹åº”æœåŠ¡å™¨ albums è¡¨ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS albums (
    id TEXT PRIMARY KEY,
    user_id INTEGER NOT NULL,
    name TEXT NOT NULL,
    created_at TEXT DEFAULT (datetime('now')),
    updated_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX IF NOT EXISTS idx_albums_user_id ON albums(user_id);

-- ========================================
-- 3. å›¾ç‰‡è¡¨ï¼ˆå¯¹åº”æœåŠ¡å™¨ images è¡¨ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS images (
    id TEXT PRIMARY KEY,
    user_id INTEGER NOT NULL,
    album_id TEXT REFERENCES albums(id) ON DELETE CASCADE,
    filename TEXT NOT NULL,
    filepath TEXT NOT NULL,
    mime_type TEXT NOT NULL,
    size INTEGER NOT NULL,
    usage_count INTEGER DEFAULT 0,
    deleted_at TEXT,
    is_orphan INTEGER DEFAULT 0,
    reference_count INTEGER DEFAULT 0,
    created_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX IF NOT EXISTS idx_images_user_id ON images(user_id);
CREATE INDEX IF NOT EXISTS idx_images_album_id ON images(album_id);
CREATE INDEX IF NOT EXISTS idx_images_usage_count ON images(album_id, usage_count ASC, created_at ASC);

-- ========================================
-- 4. çŸ¥è¯†åº“è¡¨ï¼ˆå¯¹åº”æœåŠ¡å™¨ knowledge_bases è¡¨ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS knowledge_bases (
    id TEXT PRIMARY KEY,
    user_id INTEGER NOT NULL,
    name TEXT NOT NULL,
    description TEXT,
    created_at TEXT DEFAULT (datetime('now')),
    updated_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX IF NOT EXISTS idx_knowledge_bases_user_id ON knowledge_bases(user_id);

-- ========================================
-- 5. çŸ¥è¯†æ–‡æ¡£è¡¨ï¼ˆå¯¹åº”æœåŠ¡å™¨ knowledge_documents è¡¨ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS knowledge_documents (
    id TEXT PRIMARY KEY,
    knowledge_base_id TEXT NOT NULL REFERENCES knowledge_bases(id) ON DELETE CASCADE,
    filename TEXT NOT NULL,
    file_type TEXT NOT NULL,
    file_size INTEGER NOT NULL,
    content TEXT NOT NULL,  -- è§£æåçš„æ–‡æœ¬å†…å®¹
    created_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX IF NOT EXISTS idx_knowledge_documents_kb_id ON knowledge_documents(knowledge_base_id);

-- ========================================
-- 6. å¹³å°è´¦å·è¡¨ï¼ˆå¯¹åº”æœåŠ¡å™¨ platform_accounts è¡¨ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS platform_accounts (
    id TEXT PRIMARY KEY,
    user_id INTEGER NOT NULL,
    platform TEXT NOT NULL,
    platform_id TEXT,
    account_name TEXT,
    real_username TEXT,
    credentials TEXT,  -- åŠ å¯†å­˜å‚¨
    cookies TEXT,      -- åŠ å¯†å­˜å‚¨
    status TEXT DEFAULT 'inactive',
    is_default INTEGER DEFAULT 0,
    error_message TEXT,
    last_used_at TEXT,
    created_at TEXT DEFAULT (datetime('now')),
    updated_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX IF NOT EXISTS idx_platform_accounts_user_id ON platform_accounts(user_id);
CREATE INDEX IF NOT EXISTS idx_platform_accounts_platform ON platform_accounts(platform);
CREATE INDEX IF NOT EXISTS idx_platform_accounts_status ON platform_accounts(status);

-- ========================================
-- 7. å‘å¸ƒä»»åŠ¡è¡¨ï¼ˆå¯¹åº”æœåŠ¡å™¨ publishing_tasks è¡¨ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS publishing_tasks (
    id TEXT PRIMARY KEY,
    user_id INTEGER NOT NULL,
    article_id TEXT REFERENCES articles(id) ON DELETE SET NULL,
    account_id TEXT NOT NULL REFERENCES platform_accounts(id) ON DELETE CASCADE,
    platform_id TEXT NOT NULL,
    status TEXT DEFAULT 'pending',  -- 'pending', 'running', 'completed', 'failed'
    config TEXT NOT NULL,  -- JSON é…ç½®
    scheduled_at TEXT,
    started_at TEXT,
    completed_at TEXT,
    error_message TEXT,
    retry_count INTEGER DEFAULT 0,
    max_retries INTEGER DEFAULT 3,
    batch_id TEXT,
    batch_order INTEGER DEFAULT 0,
    interval_minutes INTEGER DEFAULT 0,
    -- å¿«ç…§å­—æ®µ
    article_title TEXT,
    article_content TEXT,
    article_keyword TEXT,
    article_image_url TEXT,
    created_at TEXT DEFAULT (datetime('now')),
    updated_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX IF NOT EXISTS idx_publishing_tasks_user_id ON publishing_tasks(user_id);
CREATE INDEX IF NOT EXISTS idx_publishing_tasks_status ON publishing_tasks(status);
CREATE INDEX IF NOT EXISTS idx_publishing_tasks_article ON publishing_tasks(article_id);
CREATE INDEX IF NOT EXISTS idx_publishing_tasks_batch_id ON publishing_tasks(batch_id);

-- ========================================
-- 8. å‘å¸ƒè®°å½•è¡¨ï¼ˆå¯¹åº”æœåŠ¡å™¨ publishing_records è¡¨ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS publishing_records (
    id TEXT PRIMARY KEY,
    user_id INTEGER NOT NULL,
    article_id TEXT REFERENCES articles(id) ON DELETE SET NULL,
    task_id TEXT REFERENCES publishing_tasks(id) ON DELETE SET NULL,
    account_id TEXT NOT NULL REFERENCES platform_accounts(id) ON DELETE CASCADE,
    account_name TEXT,
    platform_id TEXT NOT NULL,
    platform_article_id TEXT,
    platform_url TEXT,
    status TEXT DEFAULT 'pending',
    publishing_status TEXT DEFAULT 'draft',
    published_at TEXT,
    error_message TEXT,
    -- å¿«ç…§å­—æ®µ
    article_title TEXT,
    article_content TEXT,
    article_keyword TEXT,
    article_image_url TEXT,
    topic_question TEXT,
    article_setting_name TEXT,
    distillation_keyword TEXT,
    created_at TEXT DEFAULT (datetime('now')),
    updated_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX IF NOT EXISTS idx_publishing_records_user_id ON publishing_records(user_id);
CREATE INDEX IF NOT EXISTS idx_publishing_records_article_id ON publishing_records(article_id);
CREATE INDEX IF NOT EXISTS idx_publishing_records_platform_id ON publishing_records(platform_id);
CREATE INDEX IF NOT EXISTS idx_publishing_records_status ON publishing_records(status);

-- ========================================
-- 9. å‘å¸ƒæ—¥å¿—è¡¨ï¼ˆå¯¹åº”æœåŠ¡å™¨ publishing_logs è¡¨ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS publishing_logs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    task_id TEXT NOT NULL REFERENCES publishing_tasks(id) ON DELETE CASCADE,
    level TEXT NOT NULL,  -- 'info', 'warn', 'error'
    message TEXT NOT NULL,
    details TEXT,
    created_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX IF NOT EXISTS idx_publishing_logs_task ON publishing_logs(task_id);

-- ========================================
-- 10. è½¬åŒ–ç›®æ ‡è¡¨ï¼ˆå¯¹åº”æœåŠ¡å™¨ conversion_targets è¡¨ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS conversion_targets (
    id TEXT PRIMARY KEY,
    user_id INTEGER NOT NULL,
    company_name TEXT NOT NULL,
    industry TEXT,
    company_size TEXT,
    features TEXT,
    contact_info TEXT,
    website TEXT,
    target_audience TEXT,
    core_products TEXT,
    address TEXT,
    created_at TEXT DEFAULT (datetime('now')),
    updated_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX IF NOT EXISTS idx_conversion_targets_user_id ON conversion_targets(user_id);

-- ========================================
-- 11. è’¸é¦è®°å½•è¡¨ï¼ˆå¯¹åº”æœåŠ¡å™¨ distillations è¡¨ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS distillations (
    id TEXT PRIMARY KEY,
    user_id INTEGER NOT NULL,
    keyword TEXT NOT NULL,
    provider TEXT NOT NULL,
    usage_count INTEGER DEFAULT 0,
    created_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX IF NOT EXISTS idx_distillations_user_id ON distillations(user_id);
CREATE INDEX IF NOT EXISTS idx_distillations_keyword ON distillations(keyword);

-- ========================================
-- 12. è¯é¢˜è¡¨ï¼ˆå¯¹åº”æœåŠ¡å™¨ topics è¡¨ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS topics (
    id TEXT PRIMARY KEY,
    user_id INTEGER NOT NULL,
    distillation_id TEXT REFERENCES distillations(id) ON DELETE CASCADE,
    keyword TEXT NOT NULL,
    question TEXT NOT NULL,
    usage_count INTEGER DEFAULT 0,
    created_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX IF NOT EXISTS idx_topics_user_id ON topics(user_id);
CREATE INDEX IF NOT EXISTS idx_topics_distillation ON topics(distillation_id);

-- ========================================
-- 13. æ–‡ç« è®¾ç½®è¡¨ï¼ˆå¯¹åº”æœåŠ¡å™¨ article_settings è¡¨ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS article_settings (
    id TEXT PRIMARY KEY,
    user_id INTEGER NOT NULL,
    name TEXT NOT NULL,
    prompt TEXT NOT NULL,
    created_at TEXT DEFAULT (datetime('now')),
    updated_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX IF NOT EXISTS idx_article_settings_user_id ON article_settings(user_id);

-- ========================================
-- 14. è’¸é¦é…ç½®è¡¨ï¼ˆå¯¹åº”æœåŠ¡å™¨ distillation_config è¡¨ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS distillation_config (
    id TEXT PRIMARY KEY,
    user_id INTEGER NOT NULL,
    prompt TEXT NOT NULL,
    topic_count INTEGER NOT NULL DEFAULT 12,
    is_active INTEGER DEFAULT 1,
    created_at TEXT DEFAULT (datetime('now')),
    updated_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX IF NOT EXISTS idx_distillation_config_user_id ON distillation_config(user_id);

-- ========================================
-- 15. å›¾ç‰‡ä½¿ç”¨è¿½è¸ªè¡¨ï¼ˆå¯¹åº”æœåŠ¡å™¨ image_usage è¡¨ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS image_usage (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    image_id TEXT NOT NULL REFERENCES images(id) ON DELETE CASCADE,
    article_id TEXT NOT NULL REFERENCES articles(id) ON DELETE CASCADE,
    used_at TEXT DEFAULT (datetime('now')),
    UNIQUE(image_id, article_id)
);

CREATE INDEX IF NOT EXISTS idx_image_usage_image_id ON image_usage(image_id);
CREATE INDEX IF NOT EXISTS idx_image_usage_article_id ON image_usage(article_id);

-- ========================================
-- 16. æœ¬åœ°é…ç½®è¡¨ï¼ˆæ–°å¢ï¼Œç”¨äºå­˜å‚¨æœ¬åœ°è®¾ç½®ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS local_settings (
    key TEXT PRIMARY KEY,
    value TEXT,
    updated_at TEXT DEFAULT (datetime('now'))
);

-- ========================================
-- 17. å¾…ä¸ŠæŠ¥åˆ†æé˜Ÿåˆ—ï¼ˆç”¨äºç¦»çº¿ä¸ŠæŠ¥ï¼‰
-- ========================================
CREATE TABLE IF NOT EXISTS pending_analytics (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    report_type TEXT NOT NULL,  -- 'publish'
    report_data TEXT NOT NULL,  -- JSON
    retry_count INTEGER DEFAULT 0,
    created_at TEXT DEFAULT (datetime('now'))
);

CREATE INDEX IF NOT EXISTS idx_pending_analytics_type ON pending_analytics(report_type);
```

### 12.3 å­—æ®µå¯¹ç…§è¡¨

| æœåŠ¡å™¨ PostgreSQL | Windows SQLite | è¯´æ˜ |
|------------------|----------------|------|
| `SERIAL` | `INTEGER PRIMARY KEY AUTOINCREMENT` | è‡ªå¢ä¸»é”® |
| `UUID` | `TEXT` | UUID å­˜ä¸ºå­—ç¬¦ä¸² |
| `BOOLEAN` | `INTEGER` | 0/1 ä»£æ›¿ true/false |
| `TIMESTAMP` | `TEXT` | ISO 8601 æ ¼å¼å­—ç¬¦ä¸² |
| `JSONB` | `TEXT` | JSON å­—ç¬¦ä¸² |
| `VARCHAR(n)` | `TEXT` | SQLite æ— é•¿åº¦é™åˆ¶ |
| `DECIMAL(m,n)` | `REAL` | æµ®ç‚¹æ•° |
| `REFERENCES ... ON DELETE CASCADE` | `REFERENCES ... ON DELETE CASCADE` | éœ€å¯ç”¨å¤–é”® |

### 12.3.1 ID æ ¼å¼ç»Ÿä¸€è§„èŒƒï¼ˆé‡è¦ï¼‰

**é—®é¢˜ï¼š** æœåŠ¡å™¨å’Œ Windows ç«¯ä½¿ç”¨ä¸åŒæ•°æ®åº“ï¼ŒID æ ¼å¼å¿…é¡»ç»Ÿä¸€æ‰èƒ½äº’ç›¸å¼•ç”¨ã€‚

**è§£å†³æ–¹æ¡ˆï¼š** ç»Ÿä¸€ä½¿ç”¨ UUID v4 æ ¼å¼

| åœºæ™¯ | æœåŠ¡å™¨ï¼ˆPostgreSQLï¼‰ | Windows ç«¯ï¼ˆSQLiteï¼‰ | ç¤ºä¾‹ |
|------|---------------------|---------------------|------|
| é…é¢é¢„ç•™ ID | `UUID` ç±»å‹ | `TEXT` å­˜å‚¨ | `550e8400-e29b-41d4-a716-446655440000` |
| æ–‡ç«  ID | `SERIAL` (æ•°å­—) | `TEXT` (UUID) | Windows ç«¯ç”Ÿæˆ UUID |
| ä»»åŠ¡ ID | - | `TEXT` (UUID) | Windows ç«¯ç”Ÿæˆ UUID |
| ç”¨æˆ· ID | `SERIAL` (æ•°å­—) | `INTEGER` | æœåŠ¡å™¨è¿”å›ï¼ŒWindows ç«¯å­˜å‚¨ |

**å…³é”®è§„åˆ™ï¼š**

1. **æœåŠ¡å™¨ç”Ÿæˆçš„ ID**ï¼ˆå¦‚ `reservationId`ï¼‰
   - æœåŠ¡å™¨ï¼šUUID ç±»å‹
   - Windows ç«¯ï¼šTEXT å­˜å‚¨
   - ç¤ºä¾‹ï¼š`reservationId: '550e8400-e29b-41d4-a716-446655440000'`

2. **Windows ç«¯ç”Ÿæˆçš„ ID**ï¼ˆå¦‚æ–‡ç« ã€ä»»åŠ¡ï¼‰
   - ä½¿ç”¨ `uuid` åŒ…ç”Ÿæˆ v4 UUID
   - å­˜å‚¨ä¸º TEXT
   - ç¤ºä¾‹ï¼š`articleId: uuid.v4()`

3. **ç”¨æˆ· ID**ï¼ˆç‰¹æ®Šæƒ…å†µï¼‰
   - æœåŠ¡å™¨ï¼šSERIALï¼ˆæ•°å­—ï¼Œå¦‚ `123`ï¼‰
   - Windows ç«¯ï¼šINTEGER å­˜å‚¨
   - ä»æœåŠ¡å™¨ JWT token ä¸­è·å–

**ä»£ç ç¤ºä¾‹ï¼š**

```typescript
// Windows ç«¯ç”Ÿæˆ UUID
import { v4 as uuidv4 } from 'uuid';

// åˆ›å»ºæ–‡ç« 
const articleId = uuidv4();  // '550e8400-e29b-41d4-a716-446655440000'
db.prepare('INSERT INTO articles (id, ...) VALUES (?, ...)').run(articleId, ...);

// å…³è”æœåŠ¡å™¨çš„é¢„ç•™ ID
const { reservationId } = await apiClient.post('/api/quota/reserve', { ... });
// reservationId æ˜¯æœåŠ¡å™¨ç”Ÿæˆçš„ UUID å­—ç¬¦ä¸²
db.prepare('UPDATE publishing_tasks SET reservation_id = ? WHERE id = ?')
  .run(reservationId, taskId);
```

**éªŒè¯æ–¹æ³•ï¼š**

```typescript
// UUID æ ¼å¼éªŒè¯
const UUID_REGEX = /^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;

function isValidUUID(id: string): boolean {
  return UUID_REGEX.test(id);
}
```

### 12.4 SQLite åˆå§‹åŒ–ä»£ç 

```typescript
// windows-login-manager/electron/database/sqlite.ts

import Database from 'better-sqlite3';
import path from 'path';
import { app } from 'electron';
import fs from 'fs';

class SQLiteManager {
  private db: Database.Database;
  private dbPath: string;

  constructor() {
    // æ•°æ®åº“å­˜å‚¨åœ¨ç”¨æˆ·æ•°æ®ç›®å½•
    const userDataPath = app.getPath('userData');
    this.dbPath = path.join(userDataPath, 'geo-data.db');
    
    // ç¡®ä¿ç›®å½•å­˜åœ¨
    const dir = path.dirname(this.dbPath);
    if (!fs.existsSync(dir)) {
      fs.mkdirSync(dir, { recursive: true });
    }
    
    // åˆå§‹åŒ–æ•°æ®åº“
    this.db = new Database(this.dbPath);
    
    // å¯ç”¨å¤–é”®çº¦æŸ
    this.db.pragma('foreign_keys = ON');
    
    // å¯ç”¨ WAL æ¨¡å¼ï¼ˆæé«˜å¹¶å‘æ€§èƒ½ï¼‰
    this.db.pragma('journal_mode = WAL');
    
    // è¿è¡Œè¿ç§»
    this.runMigrations();
  }

  private runMigrations(): void {
    const migrationsDir = path.join(__dirname, 'migrations');
    const migrationFiles = fs.readdirSync(migrationsDir)
      .filter(f => f.endsWith('.sql'))
      .sort();
    
    // åˆ›å»ºè¿ç§»è®°å½•è¡¨
    this.db.exec(`
      CREATE TABLE IF NOT EXISTS _migrations (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        name TEXT UNIQUE NOT NULL,
        applied_at TEXT DEFAULT (datetime('now'))
      )
    `);
    
    // æ‰§è¡Œæœªåº”ç”¨çš„è¿ç§»
    for (const file of migrationFiles) {
      const applied = this.db.prepare(
        'SELECT 1 FROM _migrations WHERE name = ?'
      ).get(file);
      
      if (!applied) {
        const sql = fs.readFileSync(path.join(migrationsDir, file), 'utf-8');
        this.db.exec(sql);
        this.db.prepare('INSERT INTO _migrations (name) VALUES (?)').run(file);
        console.log(`Applied migration: ${file}`);
      }
    }
  }

  getDatabase(): Database.Database {
    return this.db;
  }

  close(): void {
    this.db.close();
  }
}

export const sqliteManager = new SQLiteManager();
export const db = sqliteManager.getDatabase();
```

---

## åä¸‰ã€å®æ–½æ­¥éª¤ï¼ˆä¼˜åŒ–ç‰ˆï¼‰

### Phase 1: æœåŠ¡å™¨ç«¯æ”¹é€ ï¼ˆ3 å¤©ï¼‰

#### 1.1 é…é¢é¢„æ‰£å‡æœºåˆ¶
- åˆ›å»º `quota_reservations` è¡¨
- å®ç° `QuotaReservationService`
- æ·»åŠ  `/api/quota/reserve`ã€`/api/quota/confirm`ã€`/api/quota/release` è·¯ç”±
- æ·»åŠ è¿‡æœŸé¢„ç•™æ¸…ç†å®šæ—¶ä»»åŠ¡

#### 1.2 AI ç”Ÿæˆç¡®è®¤æœºåˆ¶
- ä¿®æ”¹ `ArticleGenerationService`ï¼Œå¢åŠ  Redis ç¼“å­˜
- æ·»åŠ  `/api/article-generation/confirm`ã€`/api/article-generation/retrieve` è·¯ç”±

#### 1.3 å¿…é¡»å®ç°çš„åŠŸèƒ½
- æ•°æ®åŒæ­¥ API
- åˆ†æä¸ŠæŠ¥ API + ç®¡ç†å‘˜åˆ†æé¡µé¢
- é€‚é…å™¨ç‰ˆæœ¬ API

### Phase 2: Windows ç«¯æœ¬åœ°æ•°æ®åº“ï¼ˆ2 å¤©ï¼‰

#### 2.1 SQLite é›†æˆ
- å®‰è£… `better-sqlite3`
- åˆ›å»ºæ•°æ®åº“ç®¡ç†å™¨ `sqlite.ts`
- åˆ›å»ºè¿ç§»ç³»ç»Ÿ
- åˆ›å»ºæ‰€æœ‰æ•°æ®è¡¨

#### 2.2 æ•°æ®æœåŠ¡å±‚
- `ArticleService` - æ–‡ç«  CRUD
- `KnowledgeBaseService` - çŸ¥è¯†åº“ç®¡ç†
- `GalleryService` - å›¾åº“ç®¡ç†
- `AccountService` - è´¦å·ç®¡ç†
- `TaskService` - ä»»åŠ¡ç®¡ç†

### Phase 3: è¿ç§»æµè§ˆå™¨è‡ªåŠ¨åŒ–ï¼ˆ2 å¤©ï¼‰

#### 3.1 å¤åˆ¶æ ¸å¿ƒæ–‡ä»¶
- `BrowserAutomationService.ts`
- `browserConfig.ts`
- `LoginStatusChecker.ts`
- `cookieNormalizer.ts`

#### 3.2 é€‚é…æœ¬åœ°ç¯å¢ƒ
- ä¿®æ”¹å¯¼å…¥è·¯å¾„
- è°ƒæ•´é…ç½®è¯»å–æ–¹å¼
- æµ‹è¯•æµè§ˆå™¨å¯åŠ¨

### Phase 4: è¿ç§»å¹³å°é€‚é…å™¨ï¼ˆ1 å¤©ï¼‰

#### 4.1 å¤åˆ¶é€‚é…å™¨
- å¤åˆ¶æ•´ä¸ª `adapters/` ç›®å½•
- ä¿®æ”¹å¯¼å…¥è·¯å¾„

#### 4.2 é€‚é…å™¨æ³¨å†Œ
- æ›´æ–° `AdapterRegistry`
- æµ‹è¯•å„å¹³å°é€‚é…å™¨

### Phase 5: è¿ç§»å‘å¸ƒå¼•æ“ï¼ˆ2 å¤©ï¼‰

#### 5.1 å¤åˆ¶å‘å¸ƒæ¨¡å—
- `PublishingExecutor.ts`
- `BatchExecutor.ts`
- `TaskScheduler.ts`
- `ImageUploadService.ts`

#### 5.2 é›†æˆé…é¢å®¢æˆ·ç«¯
- åˆ›å»º `QuotaClient`
- å®ç° `executeWithQuota` åŒ…è£…å™¨
- é›†æˆåˆ°å‘å¸ƒæµç¨‹

### Phase 6: æ³¨å†Œ IPC å¤„ç†å™¨ï¼ˆ1 å¤©ï¼‰

#### 6.1 åˆ›å»º IPC handlers
- `articleHandlers.ts`
- `knowledgeHandlers.ts`
- `galleryHandlers.ts`
- `accountHandlers.ts`
- `taskHandlers.ts`
- `publishHandlers.ts`

#### 6.2 ç»Ÿä¸€æ³¨å†Œ
- åˆ›å»º `ipc/index.ts`
- åœ¨ `main.ts` ä¸­æ³¨å†Œæ‰€æœ‰å¤„ç†å™¨

### Phase 7: æ›´æ–°å‰ç«¯è°ƒç”¨ï¼ˆ3 å¤©ï¼‰

#### 7.1 åˆ›å»º API æŠ½è±¡å±‚
```typescript
// ç»Ÿä¸€çš„ API è°ƒç”¨æ¥å£
const api = {
  // æœ¬åœ°æ“ä½œ
  articles: {
    create: (data) => window.electron.invoke('article:create', data),
    findAll: () => window.electron.invoke('article:findAll'),
    // ...
  },
  // æœåŠ¡å™¨æ“ä½œ
  quota: {
    reserve: (type) => httpClient.post('/api/quota/reserve', { quotaType: type }),
    confirm: (id) => httpClient.post('/api/quota/confirm', { reservationId: id }),
    // ...
  },
  ai: {
    generate: (params) => httpClient.post('/api/article-generation/generate', params),
    // ...
  }
};
```

#### 7.2 æ›´æ–°é¡µé¢ç»„ä»¶
- æ–‡ç« ç®¡ç†é¡µé¢
- çŸ¥è¯†åº“é¡µé¢
- å›¾åº“é¡µé¢
- è´¦å·ç®¡ç†é¡µé¢
- å‘å¸ƒä»»åŠ¡é¡µé¢

### Phase 8: åˆ é™¤æœåŠ¡å™¨ä»£ç ï¼ˆ1 å¤©ï¼‰

#### 8.1 åˆ é™¤è·¯ç”±
- `article.ts`
- `knowledgeBase.ts`
- `gallery.ts`
- `platformAccounts.ts`
- `publishing.ts`ï¼ˆæ‰§è¡Œéƒ¨åˆ†ï¼‰

#### 8.2 åˆ é™¤æœåŠ¡
- `BrowserAutomationService.ts`
- `PublishingExecutor.ts`
- `adapters/*`

#### 8.3 æ¸…ç†ä¾èµ–
- ç§»é™¤ `playwright` ç­‰ä¸å†éœ€è¦çš„åŒ…

### Phase 9: æµ‹è¯•ä¸ä¼˜åŒ–ï¼ˆ3 å¤©ï¼‰

#### 9.1 åŠŸèƒ½æµ‹è¯•
- æ–‡ç«  CRUD
- çŸ¥è¯†åº“ä¸Šä¼ /è§£æ
- å›¾åº“ç®¡ç†
- è´¦å·ç™»å½•æ£€æµ‹
- å‘å¸ƒä»»åŠ¡æ‰§è¡Œ
- é…é¢é¢„æ‰£å‡æµç¨‹

#### 9.2 è¾¹ç•Œæµ‹è¯•
- ç½‘ç»œä¸­æ–­æ¢å¤
- é…é¢ä¸è¶³
- å‘å¸ƒå¤±è´¥å›æ»š
- æ•°æ®å¤‡ä»½æ¢å¤

#### 9.3 æ€§èƒ½æµ‹è¯•
- SQLite æŸ¥è¯¢æ€§èƒ½
- å¤§æ–‡ä»¶å¤„ç†
- æ‰¹é‡å‘å¸ƒ

**æ€»è®¡ï¼š18 å¤©**

---

## åä¸‰ã€é£é™©ä¸åº”å¯¹

### é£é™© 1ï¼šé…é¢é¢„ç•™è¿‡æœŸ

**åœºæ™¯ï¼š** ç”¨æˆ·é¢„æ‰£å‡é…é¢åï¼Œé•¿æ—¶é—´æœªå®Œæˆä»»åŠ¡ï¼ˆå¦‚å‘å¸ƒå¡ä½ï¼‰

**åº”å¯¹ï¼š**
- é¢„ç•™é»˜è®¤ 10 åˆ†é’Ÿè¿‡æœŸ
- å®šæ—¶ä»»åŠ¡æ¯åˆ†é’Ÿæ¸…ç†è¿‡æœŸé¢„ç•™
- å®¢æˆ·ç«¯åœ¨ä»»åŠ¡è¶…æ—¶æ—¶ä¸»åŠ¨é‡Šæ”¾

```typescript
// Windows ç«¯è¶…æ—¶å¤„ç†
async executeWithQuota(quotaType, taskFn, timeout = 5 * 60 * 1000) {
  const { reservationId } = await this.reserve(quotaType);
  
  const timeoutPromise = new Promise((_, reject) => {
    setTimeout(() => reject(new Error('Task timeout')), timeout);
  });
  
  try {
    const result = await Promise.race([taskFn(), timeoutPromise]);
    await this.confirm(reservationId);
    return result;
  } catch (error) {
    await this.release(reservationId, error.message);
    throw error;
  }
}
```

### é£é™© 2ï¼šSQLite å¹¶å‘å†™å…¥

**åœºæ™¯ï¼š** å¤šä¸ªæ“ä½œåŒæ—¶å†™å…¥ SQLite

**åº”å¯¹ï¼š**
- SQLite ä½¿ç”¨ WAL æ¨¡å¼
- å†™æ“ä½œä½¿ç”¨é˜Ÿåˆ—ä¸²è¡ŒåŒ–

```typescript
// å†™æ“ä½œé˜Ÿåˆ—
class WriteQueue {
  private queue: Promise<any> = Promise.resolve();
  
  async write<T>(fn: () => Promise<T>): Promise<T> {
    this.queue = this.queue.then(fn).catch(() => fn());
    return this.queue;
  }
}
```

### é£é™© 3ï¼šæ•°æ®ä¸¢å¤±

**åœºæ™¯ï¼š** ç”¨æˆ·å¸è½½åº”ç”¨æˆ–ç³»ç»Ÿå´©æºƒ

**åº”å¯¹ï¼š**
- æä¾›æ•°æ®å¤‡ä»½åŠŸèƒ½
- é¦–æ¬¡ä½¿ç”¨æ—¶æç¤ºå¤‡ä»½
- å®šæœŸæé†’å¤‡ä»½

### é£é™© 4ï¼šé€‚é…å™¨ç‰ˆæœ¬ä¸å…¼å®¹

**åœºæ™¯ï¼š** çƒ­æ›´æ–°çš„é€‚é…å™¨ä¸å®¢æˆ·ç«¯ç‰ˆæœ¬ä¸å…¼å®¹

**åº”å¯¹ï¼š**
- æœåŠ¡å™¨è¿”å› `minClientVersion`
- å®¢æˆ·ç«¯æ£€æŸ¥ç‰ˆæœ¬å…¼å®¹æ€§
- ä¸å…¼å®¹æ—¶æç¤ºæ›´æ–°å®¢æˆ·ç«¯

### é£é™© 5ï¼šCookie å®‰å…¨

**åœºæ™¯ï¼š** æœ¬åœ°å­˜å‚¨çš„ Cookie è¢«çªƒå–

**åº”å¯¹ï¼š**
- ä½¿ç”¨ AES-256 åŠ å¯†å­˜å‚¨
- å¯†é’¥åŸºäºæœºå™¨ç ç”Ÿæˆ
- ä¸åŒè®¾å¤‡æ— æ³•è§£å¯†

```typescript
// åŸºäºæœºå™¨ç çš„åŠ å¯†
import { machineIdSync } from 'node-machine-id';
import CryptoJS from 'crypto-js';

const machineKey = machineIdSync();

function encrypt(data: string): string {
  return CryptoJS.AES.encrypt(data, machineKey).toString();
}

function decrypt(encrypted: string): string {
  return CryptoJS.AES.decrypt(encrypted, machineKey).toString(CryptoJS.enc.Utf8);
}
```

---

## åå››ã€å…³é”®è¦ç‚¹æ€»ç»“

### âœ… è¦åšçš„

1. **é…é¢é¢„æ‰£å‡æœºåˆ¶** - é˜²æ­¢ç«æ€æ¡ä»¶
2. **AI ç”Ÿæˆç¡®è®¤æœºåˆ¶** - é˜²æ­¢ç½‘ç»œä¸­æ–­ä¸¢å¤±
3. **è¿ç§»æ•°æ®å­˜å‚¨** - PostgreSQL â†’ SQLite
4. **è¿ç§»æµè§ˆå™¨è‡ªåŠ¨åŒ–** - æœåŠ¡å™¨ â†’ æœ¬åœ°
5. **è¿ç§»å‘å¸ƒæ‰§è¡Œ** - æœåŠ¡å™¨ â†’ æœ¬åœ°
6. **è°ƒæ•´å‰ç«¯è°ƒç”¨æ–¹å¼** - HTTP â†’ IPCï¼ˆæœ¬åœ°æ“ä½œï¼‰

### âŒ ä¸è¦åšçš„

1. ä¸è¦æ–°å¢ä»»ä½•åŠŸèƒ½
2. ä¸è¦ä¿®æ”¹æœåŠ¡å™¨çš„ AI/è®¢é˜… API æ ¸å¿ƒé€»è¾‘
3. ä¸è¦æ”¹å˜ç”¨æˆ·ç•Œé¢
4. ä¸è¦ç ´åç°æœ‰çš„è®¤è¯æœºåˆ¶

### ğŸ¯ æ ¸å¿ƒç›®æ ‡

| ç»„ä»¶ | æ”¹é€ å‰ | æ”¹é€ å |
|------|--------|--------|
| æœåŠ¡å™¨ | æ‰§è¡Œæ‰€æœ‰æ“ä½œ | ç®¡ç†ã€éªŒè¯ã€æ§åˆ¶ |
| Windows ç«¯ | ä»…ç•Œé¢å±•ç¤º | ç•Œé¢ + æ‰§è¡Œ + å­˜å‚¨ |
| ç”¨æˆ·ä½“éªŒ | - | å®Œå…¨ä¸å˜ |

### ğŸ“Š é¢„æœŸæ”¶ç›Š

1. **æœåŠ¡å™¨æˆæœ¬é™ä½** - æ— éœ€ Playwrightã€å¤§å­˜å‚¨
2. **å‘å¸ƒæ›´ç¨³å®š** - æœ¬åœ°æ‰§è¡Œï¼Œä¸å—æœåŠ¡å™¨ç½‘ç»œå½±å“
3. **æ•°æ®æ›´å®‰å…¨** - Cookie ç­‰æ•æ„Ÿæ•°æ®æœ¬åœ°åŠ å¯†
4. **å“åº”æ›´å¿«** - æœ¬åœ°æ“ä½œæ— ç½‘ç»œå»¶è¿Ÿ

---

## åäº”ã€é™„å½•ï¼šç›®å½•ç»“æ„å¯¹æ¯”

### æ”¹é€ åçš„ Windows ç«¯ç›®å½•ç»“æ„

```
windows-login-manager/
â”œâ”€â”€ electron/
â”‚   â”œâ”€â”€ main.ts                      # ä¸»è¿›ç¨‹å…¥å£
â”‚   â”œâ”€â”€ preload.ts                   # é¢„åŠ è½½è„šæœ¬
â”‚   â”‚
â”‚   â”œâ”€â”€ database/                    # æœ¬åœ°æ•°æ®åº“
â”‚   â”‚   â”œâ”€â”€ sqlite.ts                # SQLite ç®¡ç†å™¨
â”‚   â”‚   â””â”€â”€ migrations/              # è¿ç§»æ–‡ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                    # æœ¬åœ°æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ ArticleService.ts
â”‚   â”‚   â”œâ”€â”€ KnowledgeBaseService.ts
â”‚   â”‚   â”œâ”€â”€ GalleryService.ts
â”‚   â”‚   â”œâ”€â”€ AccountService.ts
â”‚   â”‚   â”œâ”€â”€ TaskService.ts
â”‚   â”‚   â”œâ”€â”€ QuotaClient.ts           # é…é¢å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ ContentParserService.ts  # æ–‡æ¡£è§£æ
â”‚   â”‚   â”œâ”€â”€ SyncService.ts           # æ•°æ®åŒæ­¥ï¼ˆå¯é€‰ï¼‰
â”‚   â”‚   â””â”€â”€ AnalyticsService.ts      # åˆ†æä¸ŠæŠ¥ï¼ˆå¯é€‰ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ browser/                     # æµè§ˆå™¨è‡ªåŠ¨åŒ–
â”‚   â”‚   â”œâ”€â”€ BrowserAutomationService.ts
â”‚   â”‚   â”œâ”€â”€ browserConfig.ts
â”‚   â”‚   â””â”€â”€ LoginStatusChecker.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ publishing/                  # å‘å¸ƒå¼•æ“
â”‚   â”‚   â”œâ”€â”€ PublishingExecutor.ts
â”‚   â”‚   â”œâ”€â”€ BatchExecutor.ts
â”‚   â”‚   â”œâ”€â”€ TaskScheduler.ts
â”‚   â”‚   â””â”€â”€ ImageUploadService.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ adapters/                    # å¹³å°é€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ PlatformAdapter.ts
â”‚   â”‚   â”œâ”€â”€ AdapterRegistry.ts
â”‚   â”‚   â”œâ”€â”€ XiaohongshuAdapter.ts
â”‚   â”‚   â”œâ”€â”€ DouyinAdapter.ts
â”‚   â”‚   â””â”€â”€ ...ï¼ˆ12+ å¹³å°ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ ipc/                         # IPC å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ articleHandlers.ts
â”‚   â”‚   â”œâ”€â”€ knowledgeHandlers.ts
â”‚   â”‚   â”œâ”€â”€ galleryHandlers.ts
â”‚   â”‚   â”œâ”€â”€ accountHandlers.ts
â”‚   â”‚   â”œâ”€â”€ taskHandlers.ts
â”‚   â”‚   â”œâ”€â”€ publishHandlers.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ storage/                     # æ–‡ä»¶å­˜å‚¨
â”‚   â”‚   â”œâ”€â”€ FileManager.ts
â”‚   â”‚   â””â”€â”€ paths.ts
â”‚   â”‚
â”‚   â””â”€â”€ utils/                       # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ encryption.ts
â”‚       â”œâ”€â”€ cookieNormalizer.ts
â”‚       â””â”€â”€ fileUtils.ts
â”‚
â”œâ”€â”€ src/                             # æ¸²æŸ“è¿›ç¨‹ï¼ˆReactï¼‰
â”‚   â”œâ”€â”€ api/                         # API æŠ½è±¡å±‚
â”‚   â”‚   â”œâ”€â”€ local.ts                 # æœ¬åœ° IPC è°ƒç”¨
â”‚   â”‚   â””â”€â”€ remote.ts                # æœåŠ¡å™¨ HTTP è°ƒç”¨
â”‚   â”œâ”€â”€ pages/                       # é¡µé¢ç»„ä»¶
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ package.json
```

### æ”¹é€ åçš„æœåŠ¡å™¨ç«¯ç›®å½•ç»“æ„

```
server/src/
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ auth.ts                      # è®¤è¯ï¼ˆä¿ç•™ï¼‰
â”‚   â”œâ”€â”€ quota.ts                     # é…é¢ï¼ˆæ”¹è¿›ï¼‰
â”‚   â”œâ”€â”€ quotaReservation.ts          # é…é¢é¢„æ‰£å‡ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ articleGeneration.ts         # AI ç”Ÿæˆï¼ˆæ”¹è¿›ï¼‰
â”‚   â”œâ”€â”€ distillation.ts              # è’¸é¦ï¼ˆä¿ç•™ï¼‰
â”‚   â”œâ”€â”€ subscription.ts              # è®¢é˜…ï¼ˆä¿ç•™ï¼‰
â”‚   â”œâ”€â”€ payment.ts                   # æ”¯ä»˜ï¼ˆä¿ç•™ï¼‰
â”‚   â”œâ”€â”€ users.ts                     # ç”¨æˆ·ç®¡ç†ï¼ˆä¿ç•™ï¼‰
â”‚   â”œâ”€â”€ agent.ts                     # ä»£ç†å•†ï¼ˆä¿ç•™ï¼‰
â”‚   â”œâ”€â”€ security.ts                  # å®‰å…¨å®¡è®¡ï¼ˆä¿ç•™ï¼‰
â”‚   â”œâ”€â”€ sync.ts                      # æ•°æ®åŒæ­¥ï¼ˆæ–°å¢ï¼Œå¯é€‰ï¼‰
â”‚   â”œâ”€â”€ analytics.ts                 # åˆ†æä¸ŠæŠ¥ï¼ˆæ–°å¢ï¼Œå¯é€‰ï¼‰
â”‚   â””â”€â”€ adapters.ts                  # é€‚é…å™¨ç‰ˆæœ¬ï¼ˆæ–°å¢ï¼Œå¯é€‰ï¼‰
â”‚
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ QuotaService.ts              # é…é¢æœåŠ¡ï¼ˆä¿ç•™ï¼‰
â”‚   â”œâ”€â”€ QuotaReservationService.ts   # é…é¢é¢„æ‰£å‡ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ ArticleGenerationService.ts  # AI ç”Ÿæˆï¼ˆæ”¹è¿›ï¼‰
â”‚   â”œâ”€â”€ DistillationService.ts       # è’¸é¦ï¼ˆä¿ç•™ï¼‰
â”‚   â”œâ”€â”€ SubscriptionService.ts       # è®¢é˜…ï¼ˆä¿ç•™ï¼‰
â”‚   â”œâ”€â”€ PaymentService.ts            # æ”¯ä»˜ï¼ˆä¿ç•™ï¼‰
â”‚   â”œâ”€â”€ UserService.ts               # ç”¨æˆ·ï¼ˆä¿ç•™ï¼‰
â”‚   â”œâ”€â”€ AgentService.ts              # ä»£ç†å•†ï¼ˆä¿ç•™ï¼‰
â”‚   â”œâ”€â”€ SyncService.ts               # æ•°æ®åŒæ­¥ï¼ˆæ–°å¢ï¼Œå¯é€‰ï¼‰
â”‚   â””â”€â”€ AdapterVersionService.ts     # é€‚é…å™¨ç‰ˆæœ¬ï¼ˆæ–°å¢ï¼Œå¯é€‰ï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ adapters/                    # âŒ åˆ é™¤
â”‚
â”œâ”€â”€ middleware/                      # ä¸­é—´ä»¶ï¼ˆä¿ç•™ï¼‰
â”œâ”€â”€ db/                              # æ•°æ®åº“ï¼ˆä¿ç•™ï¼‰
â”œâ”€â”€ config/                          # é…ç½®ï¼ˆä¿ç•™ï¼Œåˆ é™¤ browserConfigï¼‰
â””â”€â”€ utils/                           # å·¥å…·ï¼ˆä¿ç•™ï¼‰
```

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v3.0ï¼ˆä¼˜åŒ–ç‰ˆï¼‰  
**æœ€åæ›´æ–°ï¼š** 2025-01-14  
**çŠ¶æ€ï¼š** å·²ä¼˜åŒ–ï¼Œå‡†å¤‡å®æ–½
