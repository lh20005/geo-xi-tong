# 网易号自动发布使用说明

## 快速开始

网易号适配器已经完成开发并集成到系统中，可以通过以下方式使用。

## 使用方法

### 方法一：通过前端界面（推荐）

1. **登录系统**
   ```
   访问 http://localhost:5173
   使用你的账号登录
   ```

2. **添加网易号账号**
   - 进入"账号管理"页面
   - 点击"添加账号"
   - 选择"网易号"平台
   - 使用 Windows 登录管理器完成登录
   - 系统会自动保存 Cookie

3. **发布文章**
   - 进入"发布管理"页面
   - 选择要发布的文章
   - 勾选网易号账号
   - 点击"发布"按钮
   - 系统会自动完成发布流程

### 方法二：通过 API 调用

```bash
# 发布文章到网易号
curl -X POST http://localhost:3000/api/publishing/publish \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{
    "articleId": 123,
    "platformAccountIds": [456]
  }'
```

### 方法三：测试脚本（开发调试）

```bash
# 运行测试脚本
node scripts/test-wangyi-adapter.js
```

## 功能特性

### ✅ 已实现功能

1. **Cookie 登录**
   - 自动使用保存的 Cookie 登录
   - Cookie 失效时提示重新登录

2. **自动发布**
   - 自动填写标题
   - 自动填写正文
   - 自动上传封面图片
   - 自动点击发布按钮

3. **人性化操作**
   - 每次操作间隔 3-5 秒（随机）
   - 模拟真实用户行为
   - 避免被平台检测

4. **智能验证**
   - 多重登录状态检测
   - 发布结果自动验证
   - 详细的日志记录

5. **错误处理**
   - Cookie 失效提醒
   - 图片缺失检测
   - 发布失败重试

## 文章要求

### 标题要求
- 长度：2-30 个字
- 建议：简洁明了，吸引眼球

### 正文要求
- 长度：建议 300 字以上
- 格式：支持 Markdown 格式（系统会自动转换）
- 内容：避免敏感词汇

### 图片要求
- **必须包含至少一张图片**（网易号强制要求）
- 格式：JPG、PNG
- 尺寸：建议 1200x630 或 16:9 比例
- 位置：在文章内容中使用 Markdown 语法插入

示例：
```markdown
![图片描述](uploads/image.jpg)
```

## 常见问题

### Q1: 提示"Cookie 登录失败"怎么办？

**解决方法：**
1. 打开 Windows 登录管理器
2. 重新登录网易号
3. 系统会自动更新 Cookie

### Q2: 提示"文章必须上传图片"怎么办？

**解决方法：**
1. 在文章内容中添加图片
2. 使用 Markdown 语法：`![描述](uploads/image.jpg)`
3. 确保图片文件存在于 `uploads/` 目录

### Q3: 发布后如何确认是否成功？

**验证方法：**
1. 查看系统日志，寻找"发布成功"提示
2. 登录网易号后台查看文章列表
3. 检查文章状态（已发布/审核中）

### Q4: 发布速度太慢怎么办？

**说明：**
- 系统故意设置了 3-5 秒的随机间隔
- 这是为了模拟真实用户行为
- 避免被平台检测为机器人
- **不建议修改间隔时间**

### Q5: 可以批量发布吗？

**可以！**
1. 在发布管理页面选择多篇文章
2. 勾选网易号账号
3. 点击"批量发布"
4. 系统会依次发布每篇文章

## 技术细节

### 适配器位置
```
server/src/services/adapters/WangyiAdapter.ts
```

### 关键配置
```typescript
platformId: 'wangyi'
platformName: '网易号'
loginUrl: 'https://mp.163.com/login.html'
publishUrl: 'https://mp.163.com/subscribe_v4/index.html#/'
```

### 发布流程
```
1. 检查登录状态
2. 导航到发布页面
3. 点击发布按钮
4. 输入标题
5. 输入正文
6. 上传封面图片
7. 点击发布
8. 验证结果
```

### 操作间隔
- 点击前等待：3-5 秒（随机）
- 点击后等待：3-5 秒（随机）
- 输入前等待：3-5 秒（随机）
- 输入后等待：3-5 秒（随机）

## 最佳实践

### 1. 定期更新 Cookie
- 建议每周重新登录一次
- 保持 Cookie 的有效性
- 避免发布时登录失效

### 2. 准备高质量图片
- 使用清晰的图片
- 图片与文章内容相关
- 避免使用版权图片

### 3. 合理安排发布时间
- 避免在深夜发布
- 选择用户活跃时段
- 提高文章曝光率

### 4. 监控发布结果
- 定期查看发布日志
- 及时处理失败的发布
- 分析失败原因

## 参考文档

- [网易号发布实现指南](./WANGYI_PUBLISH_GUIDE.md)
- [平台适配器开发文档](./docs/07-开发文档/实施指南/)
- [多平台发布系统说明](./docs/02-功能说明/)

## 技术支持

如遇到问题，请：
1. 查看系统日志：`server/logs/`
2. 查看浏览器控制台
3. 运行测试脚本进行调试
4. 查阅相关文档

## 更新日志

- **2025-01-03**: 完成网易号适配器开发
- **2025-01-03**: 添加人性化操作
- **2025-01-03**: 完善错误处理
- **2025-01-03**: 创建使用文档
