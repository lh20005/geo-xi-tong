# PostgreSQL 迁移 - 阶段 6：步骤 10 实际测试指南

**创建时间**: 2026-01-16  
**状态**: ⏳ 待执行  
**目标**: 在实际 Electron 应用中验证所有迁移后的功能

---

## 🚀 快速开始

### 1. 启动应用

```bash
cd windows-login-manager
npm run dev
```

### 2. 登录测试账号

使用以下测试账号登录：
- **用户名**: `test_user` 或 `admin`
- **密码**: 查看数据库中的测试账号

---

## ✅ 测试检查清单

### 模块 1: 文章管理 (12 个处理器)

**测试页面**: 文章列表页面

- [ ] **查询文章列表**: 打开文章列表，验证能看到文章
- [ ] **查看文章详情**: 点击某篇文章，查看详情
- [ ] **创建新文章**: 点击"新建文章"，填写信息并保存
- [ ] **编辑文章**: 编辑某篇文章，修改标题或内容
- [ ] **删除文章**: 删除一篇测试文章
- [ ] **搜索文章**: 使用搜索功能查找文章
- [ ] **批量删除**: 选择多篇文章，批量删除

**预期结果**: 所有操作成功，数据正确显示

---

### 模块 2: 图库管理 (13 个处理器)

**测试页面**: 图库页面

#### 相册操作 (5 个)

- [ ] **查询相册列表**: 打开图库，查看相册列表
- [ ] **创建相册**: 点击"新建相册"，输入名称并保存
- [ ] **编辑相册**: 修改相册名称或描述
- [ ] **删除相册**: 删除一个测试相册
- [ ] **查看相册详情**: 点击相册，查看其中的图片

#### 图片操作 (8 个)

- [ ] **上传图片**: 在相册中上传图片
- [ ] **查询图片列表**: 查看相册中的图片列表
- [ ] **查看图片详情**: 点击图片，查看大图和详情
- [ ] **编辑图片**: 修改图片标题或描述
- [ ] **删除图片**: 删除一张测试图片
- [ ] **批量删除图片**: 选择多张图片，批量删除
- [ ] **搜索图片**: 使用搜索功能查找图片

**预期结果**: 所有操作成功，图片正确显示

---

### 模块 3: 知识库管理 (12 个处理器)

**测试页面**: 知识库页面

- [ ] **查询知识库列表**: 打开知识库，查看文档列表
- [ ] **上传文档**: 上传 Word 或 PDF 文档
- [ ] **查看文档详情**: 点击文档，查看解析后的内容
- [ ] **编辑文档**: 修改文档标题或描述
- [ ] **删除文档**: 删除一个测试文档
- [ ] **搜索文档**: 使用搜索功能查找文档
- [ ] **批量删除**: 选择多个文档，批量删除

**预期结果**: 文档上传成功，内容正确解析

---

### 模块 4: 平台账号管理 (13 个处理器)

**测试页面**: 平台账号页面

- [ ] **查询账号列表**: 打开平台账号，查看已添加的账号
- [ ] **添加账号**: 点击"添加账号"，选择平台并登录
- [ ] **查看账号详情**: 点击账号，查看详情
- [ ] **编辑账号**: 修改账号备注或设置
- [ ] **删除账号**: 删除一个测试账号
- [ ] **设置默认账号**: 将某个账号设为默认
- [ ] **检查登录状态**: 验证账号登录状态
- [ ] **搜索账号**: 使用搜索功能查找账号

**预期结果**: 账号管理正常，Cookie 正确加密存储

---

### 模块 5: 发布任务管理 (15 个处理器)

**测试页面**: 发布任务页面

- [ ] **查询任务列表**: 打开发布任务，查看任务列表
- [ ] **创建发布任务**: 创建一个新的发布任务
- [ ] **查看任务详情**: 点击任务，查看详情
- [ ] **编辑任务**: 修改任务配置
- [ ] **删除任务**: 删除一个测试任务
- [ ] **执行任务**: 执行一个发布任务（可以选择测试平台）
- [ ] **取消任务**: 取消正在执行的任务
- [ ] **查看发布记录**: 查看任务的发布记录
- [ ] **搜索任务**: 使用搜索功能查找任务

**预期结果**: 任务创建和执行正常

---

### 模块 6: 蒸馏管理 (11 个处理器)

**测试页面**: 蒸馏页面

- [ ] **查询蒸馏列表**: 打开蒸馏页面，查看蒸馏记录
- [ ] **创建蒸馏**: 输入关键词，创建新的蒸馏记录
- [ ] **查看蒸馏详情**: 点击蒸馏记录，查看详情
- [ ] **编辑蒸馏**: 修改蒸馏的关键词或配置
- [ ] **删除蒸馏**: 删除一个测试蒸馏记录
- [ ] **搜索蒸馏**: 使用搜索功能查找蒸馏记录
- [ ] **查看统计信息**: 查看蒸馏的统计数据

**预期结果**: 蒸馏记录管理正常

---

### 模块 7: 话题管理 (12 个处理器)

**测试页面**: 话题页面

- [ ] **查询话题列表**: 打开话题页面，查看话题列表
- [ ] **创建话题**: 从蒸馏记录创建话题
- [ ] **查看话题详情**: 点击话题，查看详情
- [ ] **编辑话题**: 修改话题内容
- [ ] **删除话题**: 删除一个测试话题
- [ ] **搜索话题**: 使用搜索功能查找话题
- [ ] **查看关联蒸馏**: 验证话题与蒸馏的关联

**预期结果**: 话题管理正常，关联数据正确

---

### 模块 8: 转化目标管理 (13 个处理器)

**测试页面**: 转化目标页面

- [ ] **查询转化目标列表**: 打开转化目标页面，查看列表
- [ ] **创建转化目标**: 创建新的转化目标
- [ ] **查看转化目标详情**: 点击转化目标，查看详情
- [ ] **编辑转化目标**: 修改转化目标内容
- [ ] **删除转化目标**: 删除一个测试转化目标
- [ ] **设置默认转化目标**: 将某个转化目标设为默认
- [ ] **搜索转化目标**: 使用搜索功能查找转化目标

**预期结果**: 转化目标管理正常，默认值功能正常

---

### 模块 9: 文章设置管理 (11 个处理器)

**测试页面**: 文章设置页面

- [ ] **查询文章设置列表**: 打开文章设置页面，查看列表
- [ ] **创建文章设置**: 创建新的文章设置模板
- [ ] **查看文章设置详情**: 点击设置，查看详情
- [ ] **编辑文章设置**: 修改设置内容
- [ ] **删除文章设置**: 删除一个测试设置
- [ ] **设置默认文章设置**: 将某个设置设为默认
- [ ] **搜索文章设置**: 使用搜索功能查找设置

**预期结果**: 文章设置管理正常，默认值功能正常

---

## 🔍 关键验证点

### 1. 数据隔离验证

**测试步骤**:
1. 使用用户 A 登录，创建一些数据（文章、相册等）
2. 退出登录
3. 使用用户 B 登录
4. 验证看不到用户 A 的数据
5. 创建用户 B 的数据
6. 切换回用户 A，验证看不到用户 B 的数据

**预期结果**: 用户只能看到自己的数据

---

### 2. 关联数据验证

**测试步骤**:
1. 创建蒸馏记录
2. 从蒸馏记录创建话题
3. 使用话题生成文章
4. 在文章中关联图片和知识库
5. 验证所有关联关系正确

**预期结果**: 
- 话题能正确关联到蒸馏记录
- 文章能正确关联到话题
- 文章能正确关联到图片和知识库

---

### 3. 默认值功能验证

**测试步骤**:
1. 创建多个转化目标
2. 将其中一个设为默认
3. 创建新文章时，验证默认转化目标自动选中
4. 修改默认转化目标
5. 验证新的默认值生效

**预期结果**: 默认值功能正常工作

---

### 4. 搜索和过滤验证

**测试步骤**:
1. 创建多篇文章，标题包含不同关键词
2. 使用搜索功能查找特定关键词
3. 验证搜索结果正确
4. 测试分页功能
5. 测试排序功能

**预期结果**: 搜索、分页、排序功能正常

---

### 5. 统计信息验证

**测试步骤**:
1. 查看各模块的统计信息
2. 手动计数实际数据
3. 对比统计信息是否准确

**预期结果**: 统计信息准确

---

## 🐛 问题记录

### 发现的问题

如果在测试过程中发现问题，请记录以下信息：

1. **问题描述**: 详细描述问题现象
2. **重现步骤**: 如何重现该问题
3. **预期结果**: 应该是什么样的
4. **实际结果**: 实际发生了什么
5. **错误信息**: 控制台或日志中的错误信息
6. **截图**: 如果可能，提供截图

**示例**:

```
问题 1: 文章列表查询失败

描述: 打开文章列表页面时，显示"加载失败"

重现步骤:
1. 登录应用
2. 点击"文章管理"菜单
3. 页面显示错误

预期结果: 显示文章列表

实际结果: 显示"加载失败"错误

错误信息:
Error: Cannot read property 'id' of undefined
  at ArticleServicePostgres.findAll (ArticleServicePostgres.ts:123)

截图: [附上截图]
```

---

## 📊 测试结果汇总

### 测试统计

- **总测试项**: 112 个处理器
- **已测试**: 0
- **通过**: 0
- **失败**: 0
- **跳过**: 0

### 模块测试结果

| 模块 | 处理器数量 | 通过 | 失败 | 跳过 |
|------|-----------|------|------|------|
| 文章管理 | 12 | 0 | 0 | 0 |
| 图库管理 | 13 | 0 | 0 | 0 |
| 知识库管理 | 12 | 0 | 0 | 0 |
| 平台账号管理 | 13 | 0 | 0 | 0 |
| 发布任务管理 | 15 | 0 | 0 | 0 |
| 蒸馏管理 | 11 | 0 | 0 | 0 |
| 话题管理 | 12 | 0 | 0 | 0 |
| 转化目标管理 | 13 | 0 | 0 | 0 |
| 文章设置管理 | 11 | 0 | 0 | 0 |
| **总计** | **112** | **0** | **0** | **0** |

---

## 🎯 测试完成标准

### 基本功能

- [ ] 所有模块的 CRUD 操作正常
- [ ] 数据正确保存和读取
- [ ] 错误处理正常
- [ ] 日志记录完整

### 数据安全

- [ ] 用户只能访问自己的数据
- [ ] 不能修改或删除他人数据
- [ ] Cookie 正确加密存储

### 关联数据

- [ ] 蒸馏 → 话题关联正确
- [ ] 话题 → 文章关联正确
- [ ] 文章 → 图片关联正确
- [ ] 文章 → 知识库关联正确

### 特殊功能

- [ ] 默认值设置正常
- [ ] 搜索功能正常
- [ ] 分页功能正常
- [ ] 统计信息准确

### 性能

- [ ] 查询速度正常（< 1 秒）
- [ ] 插入速度正常（< 500ms）
- [ ] 没有明显的卡顿
- [ ] 内存使用正常

---

## 📝 测试建议

### 测试顺序

建议按以下顺序测试，从简单到复杂：

1. **文章管理** - 最基础的功能
2. **图库管理** - 涉及文件系统
3. **知识库管理** - 涉及文档解析
4. **蒸馏管理** - 本地数据模块
5. **话题管理** - 关联数据
6. **转化目标管理** - 默认值功能
7. **文章设置管理** - 默认值功能
8. **平台账号管理** - Cookie 加密
9. **发布任务管理** - 最复杂的功能

### 测试技巧

1. **先测试查询**: 确保能看到数据
2. **再测试创建**: 创建新数据
3. **然后测试编辑**: 修改数据
4. **最后测试删除**: 删除测试数据
5. **验证关联**: 测试模块间的关联

### 注意事项

1. **备份数据**: 测试前备份数据库
2. **使用测试账号**: 不要使用生产数据
3. **记录问题**: 及时记录发现的问题
4. **清理测试数据**: 测试后清理测试数据

---

## 🔧 调试技巧

### 查看日志

```bash
# 查看 Electron 主进程日志
# 日志位置: ~/Library/Logs/windows-login-manager/main.log

# 查看浏览器控制台
# 在应用中按 Cmd+Option+I 打开开发者工具
```

### 查看数据库

```bash
# 连接到本地 PostgreSQL
psql -U geo_user -d geo_windows

# 查询用户数据
SELECT * FROM users;

# 查询文章数据
SELECT * FROM windows_articles WHERE user_id = 1;
```

### 常见问题排查

1. **数据库连接失败**: 检查 PostgreSQL 是否启动
2. **用户未登录**: 检查 JWT token 是否有效
3. **数据查询为空**: 检查 user_id 是否正确
4. **文件操作失败**: 检查文件路径和权限

---

## ✅ 测试完成后

### 1. 更新测试结果

在本文档中更新测试统计和结果

### 2. 记录问题

将发现的问题记录到问题列表

### 3. 创建问题修复计划

如果发现问题，创建修复计划

### 4. 更新完成报告

更新 `PostgreSQL迁移-阶段6完成报告.md`

---

**文档版本**: 1.0  
**最后更新**: 2026-01-16  
**负责人**: AI Assistant  
**状态**: ⏳ 待执行测试
