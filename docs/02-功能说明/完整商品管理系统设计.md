# å®Œæ•´å•†å“ç®¡ç†ç³»ç»Ÿè®¾è®¡æ–¹æ¡ˆ

## ğŸ“‹ éœ€æ±‚åˆ†æ

åŸºäºç”¨æˆ·éœ€æ±‚å’Œè¡Œä¸šæœ€ä½³å®è·µï¼Œè®¾è®¡ä¸€ä¸ªå®Œæ•´çš„ SaaS è®¢é˜…å•†å“ç®¡ç†ç³»ç»Ÿã€‚

### æ ¸å¿ƒéœ€æ±‚

1. **å•†å“ç®¡ç†åå°**ï¼šç®¡ç†å‘˜å¯ä¿®æ”¹å¥—é¤åç§°ã€ä»·æ ¼ã€è®¡è´¹å‘¨æœŸã€åŠŸèƒ½é…é¢
2. **å®æ—¶åŒæ­¥**ï¼šä¿®æ”¹åçš„ä¿¡æ¯å®æ—¶åŒæ­¥åˆ°è½åœ°é¡µï¼ˆ8080ç«¯å£ï¼‰
3. **é…é¢ä¸‹å‘ä¸è¿½è¸ª**ï¼šç”¨æˆ·è´­ä¹°åè‡ªåŠ¨ä¸‹å‘é…é¢ï¼Œå®æ—¶è¿½è¸ªä½¿ç”¨é‡
4. **ä½¿ç”¨é‡æé†’**ï¼šé…é¢ç”¨å®Œæ—¶æé†’ç”¨æˆ·ç»­è´¹
5. **ç”¨æˆ·ä¸­å¿ƒå®æ—¶å±•ç¤º**ï¼šç”¨æˆ·ä¸­å¿ƒæ˜¾ç¤ºå®æ—¶çš„å¥—é¤å‰©ä½™æ•°æ®

### è¡Œä¸šæœ€ä½³å®è·µï¼ˆåŸºäºè°ƒç ”ï¼‰

æ ¹æ® [Togai](https://www.togai.com/blog/usage-based-saas-subscription-management/)ã€[Lago](https://getlago.com/blog/usage-based-pricing-tactics-for-saas-and-ai) ç­‰ SaaS è®¡è´¹å¹³å°çš„æœ€ä½³å®è·µï¼š

1. **å®æ—¶è®¡é‡ï¼ˆReal-time Meteringï¼‰**ï¼šæ¯æ¬¡ä½¿ç”¨ç«‹å³è®°å½•ï¼Œé¿å…å»¶è¿Ÿ
2. **å¹‚ç­‰æ€§ï¼ˆIdempotencyï¼‰**ï¼šé˜²æ­¢é‡å¤è®¡è´¹
3. **æ¸è¿›å¼è½®è¯¢ï¼ˆProgressive Pollingï¼‰**ï¼šå‰æœŸé¢‘ç¹æ£€æŸ¥ï¼ŒåæœŸé™ä½é¢‘ç‡
4. **é…é¢é¢„è­¦ï¼ˆQuota Alertsï¼‰**ï¼šæ¥è¿‘é™é¢æ—¶æå‰é€šçŸ¥
5. **å®¡è®¡è¿½è¸ªï¼ˆAudit Trailï¼‰**ï¼šå®Œæ•´çš„é…ç½®å˜æ›´å†å²
6. **ç¼“å­˜ç­–ç•¥ï¼ˆCachingï¼‰**ï¼šé«˜é¢‘è¯»å–çš„é…ç½®ä½¿ç”¨ Redis ç¼“å­˜

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•°æ®åº“è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     è®¢é˜…ç³»ç»Ÿæ•°æ®æ¨¡å‹                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

subscription_plans (å¥—é¤é…ç½®è¡¨)
â”œâ”€â”€ id
â”œâ”€â”€ plan_code (free/professional/enterprise)
â”œâ”€â”€ plan_name
â”œâ”€â”€ price
â”œâ”€â”€ billing_cycle (monthly/yearly)
â”œâ”€â”€ duration_days
â”œâ”€â”€ is_active
â”œâ”€â”€ description
â””â”€â”€ display_order

plan_features (åŠŸèƒ½é…é¢è¡¨)
â”œâ”€â”€ id
â”œâ”€â”€ plan_id â†’ subscription_plans.id
â”œâ”€â”€ feature_code (articles_per_day, publish_per_day, etc.)
â”œâ”€â”€ feature_name
â”œâ”€â”€ feature_value (-1 è¡¨ç¤ºæ— é™åˆ¶)
â””â”€â”€ feature_unit

user_subscriptions (ç”¨æˆ·è®¢é˜…è¡¨)
â”œâ”€â”€ id
â”œâ”€â”€ user_id â†’ users.id
â”œâ”€â”€ plan_id â†’ subscription_plans.id
â”œâ”€â”€ status (active/expired/cancelled)
â”œâ”€â”€ start_date
â”œâ”€â”€ end_date
â””â”€â”€ auto_renew

user_usage (ä½¿ç”¨é‡ç»Ÿè®¡è¡¨)
â”œâ”€â”€ id
â”œâ”€â”€ user_id â†’ users.id
â”œâ”€â”€ feature_code
â”œâ”€â”€ usage_count (å½“å‰å‘¨æœŸä½¿ç”¨é‡)
â”œâ”€â”€ period_start (å‘¨æœŸå¼€å§‹æ—¶é—´)
â”œâ”€â”€ period_end (å‘¨æœŸç»“æŸæ—¶é—´)
â””â”€â”€ updated_at

usage_records (ä½¿ç”¨è®°å½•æ˜ç»†è¡¨) - æ–°å¢
â”œâ”€â”€ id
â”œâ”€â”€ user_id â†’ users.id
â”œâ”€â”€ feature_code
â”œâ”€â”€ resource_type (article/publish/distillation)
â”œâ”€â”€ resource_id (å…³è”çš„èµ„æºID)
â”œâ”€â”€ amount (æœ¬æ¬¡ä½¿ç”¨é‡ï¼Œé€šå¸¸ä¸º1)
â”œâ”€â”€ metadata (JSONï¼Œå­˜å‚¨é¢å¤–ä¿¡æ¯)
â””â”€â”€ created_at

product_config_history (é…ç½®å˜æ›´å†å²è¡¨)
â”œâ”€â”€ id
â”œâ”€â”€ plan_id â†’ subscription_plans.id
â”œâ”€â”€ changed_by â†’ users.id
â”œâ”€â”€ change_type (price/feature/name/status)
â”œâ”€â”€ old_value
â”œâ”€â”€ new_value
â””â”€â”€ created_at

quota_alerts (é…é¢é¢„è­¦è¡¨) - æ–°å¢
â”œâ”€â”€ id
â”œâ”€â”€ user_id â†’ users.id
â”œâ”€â”€ feature_code
â”œâ”€â”€ alert_type (warning/critical/depleted)
â”œâ”€â”€ threshold_percentage (è§¦å‘é˜ˆå€¼ï¼š80%, 95%, 100%)
â”œâ”€â”€ is_sent (æ˜¯å¦å·²å‘é€)
â””â”€â”€ created_at
```

### ç³»ç»Ÿç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç³»ç»Ÿæ¶æ„å›¾                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç®¡ç†åå° (5173) â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤  åç«¯ API (3000) â”‚
â”‚  - å•†å“ç®¡ç†      â”‚         â”‚  - è®¢é˜…æœåŠ¡      â”‚
â”‚  - é…é¢ç®¡ç†      â”‚         â”‚  - ä½¿ç”¨é‡è¿½è¸ª    â”‚
â”‚  - å˜æ›´å†å²      â”‚         â”‚  - é…é¢æ£€æŸ¥      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  è½åœ°é¡µ (8080)   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  - å¥—é¤å±•ç¤º      â”‚                  â”‚
â”‚  - æ”¯ä»˜è´­ä¹°      â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
                                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  ç”¨æˆ·ä¸­å¿ƒ (5173) â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  - å¥—é¤ä¿¡æ¯      â”‚                  â”‚
â”‚  - ä½¿ç”¨ç»Ÿè®¡      â”‚                  â”‚
â”‚  - é…é¢æé†’      â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
                                      â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                   â”‚
              â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ PostgreSQL â”‚                   â”‚     Redis      â”‚
              â”‚  - æŒä¹…åŒ–  â”‚                   â”‚  - é…ç½®ç¼“å­˜    â”‚
              â”‚  - äº‹åŠ¡    â”‚                   â”‚  - ä½¿ç”¨é‡ç¼“å­˜  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ æ ¸å¿ƒæµç¨‹

### 1. å•†å“é…ç½®ç®¡ç†æµç¨‹

```
ç®¡ç†å‘˜ä¿®æ”¹å¥—é¤é…ç½®
    â†“
éªŒè¯æƒé™ï¼ˆç®¡ç†å‘˜ï¼‰
    â†“
è®°å½•å˜æ›´å†å²ï¼ˆproduct_config_historyï¼‰
    â†“
æ›´æ–°æ•°æ®åº“ï¼ˆsubscription_plans / plan_featuresï¼‰
    â†“
æ¸…é™¤ Redis ç¼“å­˜
    â†“
WebSocket å¹¿æ’­æ›´æ–°é€šçŸ¥
    â†“
å‰ç«¯å®æ—¶åˆ·æ–°å±•ç¤º
```

### 2. ç”¨æˆ·è´­ä¹°æµç¨‹

```
ç”¨æˆ·é€‰æ‹©å¥—é¤
    â†“
åˆ›å»ºè®¢å•ï¼ˆordersè¡¨ï¼‰
    â†“
ç”Ÿæˆå¾®ä¿¡æ”¯ä»˜äºŒç»´ç 
    â†“
ç”¨æˆ·æ‰«ç æ”¯ä»˜
    â†“
å¾®ä¿¡æ”¯ä»˜å›è°ƒ
    â†“
éªŒè¯ç­¾å â†’ æ›´æ–°è®¢å•çŠ¶æ€
    â†“
åˆ›å»º/æ›´æ–°ç”¨æˆ·è®¢é˜…ï¼ˆuser_subscriptionsï¼‰
    â†“
åˆå§‹åŒ–é…é¢ï¼ˆuser_usageï¼‰
    â†“
WebSocket æ¨é€è®¢é˜…æ›´æ–°
    â†“
ç”¨æˆ·ä¸­å¿ƒæ˜¾ç¤ºæ–°å¥—é¤
```

### 3. ä½¿ç”¨é‡è¿½è¸ªæµç¨‹

```
ç”¨æˆ·æ‰§è¡Œæ“ä½œï¼ˆç”Ÿæˆæ–‡ç« /å‘å¸ƒï¼‰
    â†“
æ£€æŸ¥é…é¢ï¼ˆcheckQuota middlewareï¼‰
    â†“
é…é¢å……è¶³ï¼Ÿ
    â”œâ”€ æ˜¯ â†’ æ‰§è¡Œæ“ä½œ
    â”‚       â†“
    â”‚   è®°å½•ä½¿ç”¨é‡ï¼ˆusage_recordsï¼‰
    â”‚       â†“
    â”‚   æ›´æ–°ç»Ÿè®¡ï¼ˆuser_usageï¼‰
    â”‚       â†“
    â”‚   æ£€æŸ¥é¢„è­¦é˜ˆå€¼
    â”‚       â†“
    â”‚   WebSocket æ¨é€é…é¢æ›´æ–°
    â”‚       â†“
    â”‚   ç”¨æˆ·ä¸­å¿ƒå®æ—¶æ›´æ–°
    â”‚
    â””â”€ å¦ â†’ è¿”å›é…é¢ä¸è¶³é”™è¯¯
            â†“
        æ˜¾ç¤ºç»­è´¹æç¤º
```

### 4. é…é¢é¢„è­¦æµç¨‹

```
ä½¿ç”¨é‡æ›´æ–°å
    â†“
è®¡ç®—ä½¿ç”¨ç™¾åˆ†æ¯”
    â†“
è¾¾åˆ°é¢„è­¦é˜ˆå€¼ï¼Ÿ(80%, 95%, 100%)
    â”œâ”€ æ˜¯ â†’ åˆ›å»ºé¢„è­¦è®°å½•ï¼ˆquota_alertsï¼‰
    â”‚       â†“
    â”‚   WebSocket æ¨é€é¢„è­¦é€šçŸ¥
    â”‚       â†“
    â”‚   å‰ç«¯æ˜¾ç¤ºæé†’å¼¹çª—
    â”‚       â†“
    â”‚   å¼•å¯¼ç”¨æˆ·ç»­è´¹
    â”‚
    â””â”€ å¦ â†’ ç»§ç»­æ­£å¸¸ä½¿ç”¨
```

## ğŸ“Š åŠŸèƒ½é…é¢å®šä¹‰

### å½“å‰æ”¯æŒçš„åŠŸèƒ½

```typescript
export const FEATURE_DEFINITIONS = {
  articles_per_day: {
    code: 'articles_per_day',
    name: 'æ¯æ—¥ç”Ÿæˆæ–‡ç« æ•°',
    unit: 'ç¯‡',
    resetPeriod: 'daily',
    warningThresholds: [80, 95, 100] // é¢„è­¦é˜ˆå€¼
  },
  publish_per_day: {
    code: 'publish_per_day',
    name: 'æ¯æ—¥å‘å¸ƒæ–‡ç« æ•°',
    unit: 'ç¯‡',
    resetPeriod: 'daily',
    warningThresholds: [80, 95, 100]
  },
  platform_accounts: {
    code: 'platform_accounts',
    name: 'å¯ç®¡ç†å¹³å°è´¦å·æ•°',
    unit: 'ä¸ª',
    resetPeriod: 'never',
    warningThresholds: [90, 100]
  },
  keyword_distillation: {
    code: 'keyword_distillation',
    name: 'å…³é”®è¯è’¸é¦æ•°',
    unit: 'ä¸ª',
    resetPeriod: 'monthly',
    warningThresholds: [80, 95, 100]
  }
};
```

### å¥—é¤é…ç½®ç¤ºä¾‹

| å¥—é¤ | ä»·æ ¼ | æ¯æ—¥ç”Ÿæˆ | æ¯æ—¥å‘å¸ƒ | å¹³å°è´¦å· | å…³é”®è¯è’¸é¦ |
|------|------|----------|----------|----------|------------|
| ä½“éªŒç‰ˆ | Â¥0 | 5ç¯‡ | 10ç¯‡ | 1ä¸ª | 10ä¸ª/æœˆ |
| ä¸“ä¸šç‰ˆ | Â¥99/æœˆ | 50ç¯‡ | 100ç¯‡ | 5ä¸ª | 100ä¸ª/æœˆ |
| ä¼ä¸šç‰ˆ | Â¥299/æœˆ | æ— é™åˆ¶ | æ— é™åˆ¶ | æ— é™åˆ¶ | æ— é™åˆ¶ |

## ğŸ” å®‰å…¨ä¸æ€§èƒ½

### å®‰å…¨æªæ–½

1. **æƒé™æ§åˆ¶**ï¼šåªæœ‰ç®¡ç†å‘˜å¯ä¿®æ”¹å•†å“é…ç½®
2. **å®¡è®¡æ—¥å¿—**ï¼šæ‰€æœ‰é…ç½®å˜æ›´è®°å½•åˆ° audit_logs
3. **äº‹åŠ¡ä¿è¯**ï¼šä½¿ç”¨æ•°æ®åº“äº‹åŠ¡ç¡®ä¿æ•°æ®ä¸€è‡´æ€§
4. **å¹‚ç­‰æ€§**ï¼šä½¿ç”¨é‡è®°å½•é˜²æ­¢é‡å¤è®¡è´¹

### æ€§èƒ½ä¼˜åŒ–

1. **Redis ç¼“å­˜**ï¼šå¥—é¤é…ç½®ç¼“å­˜1å°æ—¶
2. **æ‰¹é‡æŸ¥è¯¢**ï¼šä½¿ç”¨ JOIN å‡å°‘æ•°æ®åº“æŸ¥è¯¢
3. **ç´¢å¼•ä¼˜åŒ–**ï¼šå…³é”®å­—æ®µæ·»åŠ ç´¢å¼•
4. **WebSocket**ï¼šå®æ—¶æ¨é€é¿å…è½®è¯¢

## ğŸ“± ç”¨æˆ·ç•Œé¢

### ç®¡ç†åå° - å•†å“ç®¡ç†é¡µé¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å•†å“ç®¡ç†                                    [+ æ–°å¢å¥—é¤] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ä½“éªŒç‰ˆ                          [ç¼–è¾‘] [åœç”¨]  â”‚    â”‚
â”‚  â”‚ Â¥0 / æœˆ                                        â”‚    â”‚
â”‚  â”‚                                                â”‚    â”‚
â”‚  â”‚ åŠŸèƒ½é…é¢ï¼š                                     â”‚    â”‚
â”‚  â”‚  â€¢ æ¯æ—¥ç”Ÿæˆæ–‡ç« æ•°: 5ç¯‡                        â”‚    â”‚
â”‚  â”‚  â€¢ æ¯æ—¥å‘å¸ƒæ–‡ç« æ•°: 10ç¯‡                       â”‚    â”‚
â”‚  â”‚  â€¢ å¹³å°è´¦å·æ•°: 1ä¸ª                            â”‚    â”‚
â”‚  â”‚  â€¢ å…³é”®è¯è’¸é¦: 10ä¸ª/æœˆ                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ä¸“ä¸šç‰ˆ                          [ç¼–è¾‘] [åœç”¨]  â”‚    â”‚
â”‚  â”‚ Â¥99 / æœˆ                                       â”‚    â”‚
â”‚  â”‚ ...                                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç”¨æˆ·ä¸­å¿ƒ - å¥—é¤ä½¿ç”¨æƒ…å†µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æˆ‘çš„å¥—é¤                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  å½“å‰å¥—é¤ï¼šä¸“ä¸šç‰ˆ                        [å‡çº§å¥—é¤]     â”‚
â”‚  æœ‰æ•ˆæœŸè‡³ï¼š2026-02-04                                   â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ æ¯æ—¥ç”Ÿæˆæ–‡ç« æ•°                                 â”‚    â”‚
â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 35/50 (70%)              â”‚    â”‚
â”‚  â”‚ ä»Šæ—¥å‰©ä½™ï¼š15ç¯‡  |  é‡ç½®æ—¶é—´ï¼š23:45:12          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ æ¯æ—¥å‘å¸ƒæ–‡ç« æ•°                                 â”‚    â”‚
â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 85/100 (85%) âš ï¸          â”‚    â”‚
â”‚  â”‚ ä»Šæ—¥å‰©ä½™ï¼š15ç¯‡  |  é‡ç½®æ—¶é—´ï¼š23:45:12          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ å…³é”®è¯è’¸é¦                                     â”‚    â”‚
â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 98/100 (98%) ğŸ”´          â”‚    â”‚
â”‚  â”‚ æœ¬æœˆå‰©ä½™ï¼š2ä¸ª  |  é‡ç½®æ—¶é—´ï¼š2026-02-01         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å®æ–½è®¡åˆ’

### Phase 1: æ•°æ®åº“ä¸åç«¯ APIï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰

1. åˆ›å»ºæ•°æ®åº“è¿ç§»æ–‡ä»¶
   - usage_records è¡¨
   - quota_alerts è¡¨
   - æ›´æ–° user_usage è¡¨ç»“æ„

2. å®ç°åç«¯æœåŠ¡
   - ProductManagementServiceï¼ˆå•†å“ç®¡ç†ï¼‰
   - UsageTrackingServiceï¼ˆä½¿ç”¨é‡è¿½è¸ªï¼‰
   - QuotaAlertServiceï¼ˆé…é¢é¢„è­¦ï¼‰

3. åˆ›å»º API è·¯ç”±
   - /api/admin/productsï¼ˆå•†å“ç®¡ç†ï¼‰
   - /api/subscription/usage-detailï¼ˆä½¿ç”¨æ˜ç»†ï¼‰
   - /api/subscription/quota-alertsï¼ˆé…é¢é¢„è­¦ï¼‰

### Phase 2: ç®¡ç†åå°ç•Œé¢ï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰

1. å•†å“ç®¡ç†é¡µé¢
   - å¥—é¤åˆ—è¡¨å±•ç¤º
   - ç¼–è¾‘å¥—é¤ä¿¡æ¯
   - é…é¢é…ç½®
   - å˜æ›´å†å²æŸ¥çœ‹

2. ä½¿ç”¨é‡ç›‘æ§é¡µé¢
   - ç”¨æˆ·ä½¿ç”¨ç»Ÿè®¡
   - é…é¢ä½¿ç”¨è¶‹åŠ¿å›¾
   - å¼‚å¸¸ä½¿ç”¨æ£€æµ‹

### Phase 3: ç”¨æˆ·ä¸­å¿ƒä¼˜åŒ–ï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰

1. å®æ—¶é…é¢å±•ç¤º
   - WebSocket å®æ—¶æ›´æ–°
   - è¿›åº¦æ¡å¯è§†åŒ–
   - é¢„è­¦æç¤º

2. ä½¿ç”¨æ˜ç»†æŸ¥è¯¢
   - æŒ‰åŠŸèƒ½æŸ¥çœ‹ä½¿ç”¨è®°å½•
   - æ—¶é—´èŒƒå›´ç­›é€‰
   - å¯¼å‡ºåŠŸèƒ½

### Phase 4: è½åœ°é¡µåŒæ­¥ï¼ˆä¼˜å…ˆçº§ï¼šä¸­ï¼‰

1. å¥—é¤ä¿¡æ¯å®æ—¶è·å–
   - API æ¥å£å¯¹æ¥
   - ç¼“å­˜ç­–ç•¥
   - é™çº§æ–¹æ¡ˆ

2. æ”¯ä»˜æµç¨‹ä¼˜åŒ–
   - é…é¢ç«‹å³ç”Ÿæ•ˆ
   - æ”¯ä»˜æˆåŠŸé€šçŸ¥

### Phase 5: ä½¿ç”¨é‡é›†æˆï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰

1. æ–‡ç« ç”Ÿæˆé›†æˆ
   - ç”Ÿæˆå‰æ£€æŸ¥é…é¢
   - ç”Ÿæˆåè®°å½•ä½¿ç”¨é‡
   - é…é¢ä¸è¶³æç¤º

2. æ–‡ç« å‘å¸ƒé›†æˆ
   - å‘å¸ƒå‰æ£€æŸ¥é…é¢
   - å‘å¸ƒåè®°å½•ä½¿ç”¨é‡
   - æ‰¹é‡å‘å¸ƒé…é¢è®¡ç®—

3. å…³é”®è¯è’¸é¦é›†æˆ
   - è’¸é¦å‰æ£€æŸ¥é…é¢
   - è’¸é¦åè®°å½•ä½¿ç”¨é‡

## ğŸ“ˆ ç›‘æ§ä¸å‘Šè­¦

### å…³é”®æŒ‡æ ‡

1. **ä¸šåŠ¡æŒ‡æ ‡**
   - å¥—é¤è´­ä¹°è½¬åŒ–ç‡
   - é…é¢ä½¿ç”¨ç‡
   - ç»­è´¹ç‡

2. **æŠ€æœ¯æŒ‡æ ‡**
   - API å“åº”æ—¶é—´
   - ç¼“å­˜å‘½ä¸­ç‡
   - WebSocket è¿æ¥æ•°

3. **å¼‚å¸¸æŒ‡æ ‡**
   - é…é¢è¶…é™æ¬¡æ•°
   - æ”¯ä»˜å¤±è´¥ç‡
   - é…ç½®å˜æ›´é¢‘ç‡

## ğŸ”„ åç»­ä¼˜åŒ–æ–¹å‘

1. **æ™ºèƒ½æ¨è**ï¼šæ ¹æ®ä½¿ç”¨ä¹ æƒ¯æ¨èåˆé€‚å¥—é¤
2. **å¼¹æ€§é…é¢**ï¼šä¸´æ—¶å¢åŠ é…é¢åŠŸèƒ½
3. **é…é¢å…±äº«**ï¼šå›¢é˜Ÿæˆå‘˜é—´é…é¢å…±äº«
4. **ä½¿ç”¨åˆ†æ**ï¼šè¯¦ç»†çš„ä½¿ç”¨è¡Œä¸ºåˆ†ææŠ¥å‘Š
5. **è‡ªåŠ¨ç»­è´¹**ï¼šåˆ°æœŸè‡ªåŠ¨ç»­è´¹åŠŸèƒ½
6. **å‘ç¥¨ç®¡ç†**ï¼šç”µå­å‘ç¥¨è‡ªåŠ¨å¼€å…·

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¶é—´**: 2026-01-04  
**æœ€åæ›´æ–°**: 2026-01-04  
**è´Ÿè´£äºº**: Kiro AI Assistant
