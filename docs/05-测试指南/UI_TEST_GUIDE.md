# 前端UI测试指南 - 蒸馏结果使用追踪功能

## 测试概述

本文档提供了蒸馏结果使用追踪功能的前端UI测试指南，包括测试场景、预期结果和边缘情况处理。

## 测试环境准备

### 1. 启动开发服务器

```bash
# 启动后端服务
cd server
npm run dev

# 启动前端服务
cd client
npm run dev
```

### 2. 准备测试数据

确保数据库中有以下测试数据：
- 至少3个蒸馏结果（不同的使用次数）
- 至少1个蒸馏结果没有话题
- 至少1个已删除的蒸馏结果（用于测试显示"已删除"）
- 一些文章生成任务

## 测试场景

### 场景1: 任务列表页面 - 关键词显示

**测试目标:** 验证任务列表中"蒸馏结果"列正确显示关键词而非提供商

**测试步骤:**
1. 访问文章生成任务列表页面
2. 查看"蒸馏结果"列

**预期结果:**
- ✓ "蒸馏结果"列显示关键词（如"AI技术"）
- ✓ 不显示提供商名称（如"deepseek"）
- ✓ 如果蒸馏结果被删除，显示"已删除"或"-"

**边缘情况:**
- [ ] 蒸馏结果被删除后的显示
- [ ] 关键词包含特殊字符
- [ ] 关键词很长的情况

**截图位置:** `screenshots/task-list-keyword-display.png`

---

### 场景2: 蒸馏结果页面 - 使用次数列

**测试目标:** 验证蒸馏结果列表显示使用次数

**测试步骤:**
1. 访问蒸馏结果列表页面
2. 查看表格列

**预期结果:**
- ✓ 表格中有"使用次数"列
- ✓ 每个蒸馏结果显示正确的使用次数
- ✓ 列表按使用次数升序排序（使用次数少的在前）
- ✓ 使用次数最少的前3个有推荐标记

**边缘情况:**
- [ ] 使用次数为0的显示
- [ ] 使用次数很大的显示（如1000+）
- [ ] 多个蒸馏结果使用次数相同时的排序

**截图位置:** `screenshots/distillation-list-usage-count.png`

---

### 场景3: 蒸馏结果页面 - 使用历史

**测试目标:** 验证查看使用历史功能

**测试步骤:**
1. 在蒸馏结果列表中点击"查看使用历史"按钮
2. 查看弹出的历史记录弹窗

**预期结果:**
- ✓ 弹窗正确打开
- ✓ 显示该蒸馏结果的所有使用记录
- ✓ 每条记录包含：任务ID、文章标题、使用时间
- ✓ 记录按使用时间降序排序（最新的在前）
- ✓ 支持分页（如果记录较多）

**边缘情况:**
- [ ] 没有使用历史的蒸馏结果
- [ ] 文章被删除后显示"文章已删除"
- [ ] 使用历史记录很多时的分页

**截图位置:** `screenshots/usage-history-modal.png`

---

### 场景4: 任务配置页面 - 蒸馏结果选择

**测试目标:** 验证任务配置页面的蒸馏结果下拉列表增强功能

**测试步骤:**
1. 点击"新建文章生成任务"按钮
2. 打开蒸馏结果下拉列表

**预期结果:**
- ✓ 每个选项显示使用次数（如"使用 3 次"）
- ✓ 使用次数最少的前3个有金色"推荐"标记
- ✓ 悬停在推荐标记上显示推荐原因
- ✓ 没有话题的蒸馏结果被禁用并显示"(无可用话题)"
- ✓ 列表按使用次数升序排序

**边缘情况:**
- [ ] 所有蒸馏结果使用次数相同
- [ ] 只有1-2个蒸馏结果（少于3个推荐）
- [ ] 所有蒸馏结果都没有话题

**截图位置:** `screenshots/task-config-distillation-select.png`

---

### 场景5: 任务配置页面 - 推荐提示

**测试目标:** 验证推荐标记的提示功能

**测试步骤:**
1. 在任务配置页面打开蒸馏结果下拉列表
2. 将鼠标悬停在"推荐"标记上

**预期结果:**
- ✓ 显示提示框
- ✓ 提示内容包含推荐原因（如"推荐：使用次数较少 (0次)"）
- ✓ 提示框样式美观

**截图位置:** `screenshots/recommendation-tooltip.png`

---

### 场景6: 完整文章生成流程

**测试目标:** 验证完整的文章生成流程中使用次数的更新

**测试步骤:**
1. 记录某个蒸馏结果的当前使用次数
2. 创建使用该蒸馏结果的文章生成任务
3. 等待任务完成
4. 刷新蒸馏结果列表页面

**预期结果:**
- ✓ 使用次数增加了正确的数量
- ✓ 使用历史中有新的记录
- ✓ 如果该蒸馏结果之前是推荐的，排序可能发生变化

**边缘情况:**
- [ ] 生成多篇文章时的使用次数更新
- [ ] 任务失败时使用次数不应增加

---

### 场景7: 文章删除后的一致性

**测试目标:** 验证删除文章后使用次数正确减少

**测试步骤:**
1. 记录某个蒸馏结果的当前使用次数
2. 删除一篇使用该蒸馏结果生成的文章
3. 刷新蒸馏结果列表页面

**预期结果:**
- ✓ 使用次数减少1
- ✓ 使用历史中对应的记录被删除

---

## UI/UX优化检查

### 视觉设计
- [ ] 使用次数的字体大小和颜色合适
- [ ] 推荐标记的颜色和图标清晰可见
- [ ] 禁用选项的视觉反馈明显
- [ ] 提示框的样式与整体设计一致

### 交互体验
- [ ] 下拉列表的滚动流畅
- [ ] 推荐标记的悬停响应及时
- [ ] 使用历史弹窗的打开/关闭动画流畅
- [ ] 分页控件易于使用

### 响应式设计
- [ ] 在不同屏幕尺寸下显示正常
- [ ] 移动端的触摸交互友好
- [ ] 长文本的截断和省略号处理

### 性能
- [ ] 列表加载速度快
- [ ] 下拉列表打开无延迟
- [ ] 使用历史查询响应快

## 边缘情况测试清单

### 数据边缘情况
- [ ] 没有蒸馏结果时的显示
- [ ] 所有蒸馏结果都没有话题
- [ ] 使用次数为0的蒸馏结果
- [ ] 使用次数非常大（1000+）
- [ ] 关键词包含特殊字符（emoji、中英文混合）
- [ ] 关键词很长（超过50个字符）

### 操作边缘情况
- [ ] 快速连续点击"查看使用历史"
- [ ] 在加载过程中切换页面
- [ ] 网络请求失败时的错误提示
- [ ] 并发创建多个任务

### 权限边缘情况
- [ ] 普通用户无法访问管理功能
- [ ] 未登录用户的访问限制

## 错误处理测试

### API错误
- [ ] 获取蒸馏结果列表失败
- [ ] 获取使用历史失败
- [ ] 创建任务失败

**预期结果:**
- ✓ 显示友好的错误提示
- ✓ 不影响页面其他功能
- ✓ 提供重试选项

### 数据错误
- [ ] 蒸馏结果数据不完整
- [ ] 使用历史数据格式错误
- [ ] 关联数据缺失

**预期结果:**
- ✓ 优雅降级，显示可用信息
- ✓ 不崩溃或白屏

## 浏览器兼容性测试

测试以下浏览器：
- [ ] Chrome (最新版本)
- [ ] Firefox (最新版本)
- [ ] Safari (最新版本)
- [ ] Edge (最新版本)

## 测试报告模板

```markdown
## 测试日期: YYYY-MM-DD
## 测试人员: [姓名]

### 测试环境
- 浏览器: [浏览器名称和版本]
- 操作系统: [操作系统]
- 屏幕分辨率: [分辨率]

### 测试结果

#### 场景1: 任务列表页面
- 状态: ✓ 通过 / ✗ 失败
- 问题: [如有问题，描述详情]
- 截图: [附上截图]

#### 场景2: 蒸馏结果页面
- 状态: ✓ 通过 / ✗ 失败
- 问题: [如有问题，描述详情]
- 截图: [附上截图]

[继续其他场景...]

### 发现的问题
1. [问题描述]
   - 严重程度: 高/中/低
   - 复现步骤: [步骤]
   - 预期结果: [描述]
   - 实际结果: [描述]

### 优化建议
1. [建议内容]

### 总体评价
[总体测试结果和建议]
```

## 自动化测试

已有的自动化测试：
- `TaskConfigModal.test.tsx` - 任务配置页面组件测试
- 其他相关组件测试

运行测试：
```bash
cd client
npm test
```

## 测试完成标准

所有以下条件满足时，测试通过：
- [ ] 所有测试场景通过
- [ ] 所有边缘情况处理正确
- [ ] 所有浏览器兼容性测试通过
- [ ] 没有严重或中等级别的bug
- [ ] UI/UX优化检查全部通过
- [ ] 性能测试通过
- [ ] 自动化测试全部通过

## 问题反馈

如发现问题，请在GitHub Issues中创建新issue，包含：
- 问题标题
- 详细描述
- 复现步骤
- 截图或录屏
- 浏览器和操作系统信息
