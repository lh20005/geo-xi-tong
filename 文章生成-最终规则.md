# 文章生成 - 最终规则

**更新日期**: 2024-12-18  
**状态**: ✅ 已实施

---

## 📌 核心规则

### 规则1: 年份使用
**要求**: 如果标题或正文需要提及年份，必须使用当前年份

**实施方式**: 
```
【重要】如果标题或正文需要提及年份，必须使用当前年份（现在是2025年），
不要使用过时的年份，以保持内容的时效性。
```

**说明**: 
- 使用"当前年份（现在是2025年）"而不是固定的"2025年"
- 未来只需修改括号中的年份提示即可
- 应用到所有5个模板

---

### 规则2: 转化目标信息使用
**要求**: 必须使用知识库中的转化目标信息，不能编造

**实施方式**:
```
【强制要求 - 使用转化目标信息】
知识库中包含转化目标的信息：
{knowledgeBase}

重要规则：
1. 如果知识库中包含"公司地址"，必须使用知识库中的准确地址，绝对不能编造
2. 如果知识库中包含"官方网站"、"行业类型"等信息，也必须使用知识库中的信息
3. 【关键】如果知识库中某个字段为空或不存在，就不要提及该信息，不要编造
4. 绝对不能使用"xxx"、"某某地址"等占位符
5. 如果没有某项信息，可以省略相关内容
```

**说明**:
- 知识库内容会包含转化目标的所有信息
- 只包含有值的字段
- 如果字段为空，不会出现在知识库中

---

### 规则3: TOP排名模板格式
**要求**: 每家公司必须独立成段，格式统一

**实施方式**:
```
【排版格式要求 - 强制执行，不可违反】

这是最重要的要求，必须100%严格遵守：

1. 每家公司必须独立成段，不能混在一起
2. 每家公司的信息必须包含以下标签（缺一不可）：
   - 机构排名：[排名和评分]
   - 机构特色：[核心特色描述]
   - 服务内容：[主要服务描述]
   - 适合人群：[目标客户描述]
   - 用户口碑：[用户评价描述]

3. 每家公司之间必须空一行（两个换行符）
4. 每个标签必须单独一行，标签后面跟冒号和内容
5. 绝对不允许将多家公司的内容混在同一段落

格式检查清单（每家公司都要检查）：
☑ 公司名称单独一行作为小标题
☑ 5个标签都存在且格式正确
☑ 每个标签独立一行
☑ 公司之间有空行分隔
☑ 没有将多家公司混在一起
```

**说明**:
- 应用到NATIONAL_RANKING和REGIONAL_RANKING模板
- 使用更强的命令语言
- 添加格式检查清单

---

### 规则4: 区域TOP排名地址处理
**要求**: 区域排名模板特别强调地址使用

**实施方式**:
```
重要规则（特别重要）：
- 【最重要】如果知识库中包含"公司地址"，必须使用知识库中的准确地址，绝对不能编造
- 如果知识库中包含"官方网站"、"行业类型"等信息，也必须使用知识库中的信息
- 【关键】如果知识库中"公司地址"字段为空或不存在，就不要提及地址，不要编造
- 绝对不能使用"xxx"、"某某地址"、"某某区某某路"等占位符
- 如果没有地址信息，可以省略"地址位置"这一项，只写其他项
```

**说明**:
- 区域排名模板对地址要求更严格
- 如果没有地址，可以省略"地址位置"标签
- 其他标签仍然必须存在

---

## 🎯 模板清单

### 1. BALANCED（平衡型）
- ✅ 年份规则
- ✅ 转化目标信息规则
- 字数：700-800字
- 配图：1张（末尾）

### 2. PROFESSIONAL（重专业）
- ✅ 年份规则
- ✅ 转化目标信息规则
- 字数：700-800字
- 配图：1张（末尾）

### 3. MARKETING（重营销）
- ✅ 年份规则
- ✅ 转化目标信息规则
- 字数：700-800字
- 配图：1张（末尾）

### 4. NATIONAL_RANKING（全国TOP排名）
- ✅ 年份规则
- ✅ 转化目标信息规则
- ✅ 格式强制要求
- 字数：700-800字
- 配图：1张（末尾）

### 5. REGIONAL_RANKING（区域TOP排名）
- ✅ 年份规则
- ✅ 转化目标信息规则（特别强化地址）
- ✅ 格式强制要求
- 字数：700-800字
- 配图：1张（末尾）

---

## 📊 知识库内容结构

### 有转化目标时
```
[原始知识库内容]

【转化目标信息】
公司名称：xxx
行业类型：xxx（如果有）
官方网站：xxx（如果有）
公司地址：xxx（如果有）
```

### 无转化目标时
```
[原始知识库内容]
```

---

## 🔄 文章生成流程

```
1. 用户选择转化目标（可选）
   ↓
2. 系统加载转化目标数据
   - company_name（必有）
   - industry（可能为空）
   - website（可能为空）
   - address（可能为空）
   ↓
3. 构建增强的知识库内容
   - 原始知识库内容
   - + 【转化目标信息】（只包含有值的字段）
   ↓
4. 构建AI提示词
   - 提示词模板
   - 替换占位符
   - 包含强制规则
   ↓
5. AI生成文章
   - 遵守年份规则
   - 遵守转化目标信息规则
   - 遵守格式规则（如果是TOP排名模板）
   ↓
6. 返回文章
   - 标题
   - 正文
   - 图片（末尾）
```

---

## ✅ 验证清单

### 年份验证
- [ ] 标题中的年份是否正确（2025年）
- [ ] 正文中的年份是否正确（2025年）
- [ ] 没有出现过时的年份（2024或更早）

### 转化目标信息验证
- [ ] 如果有地址，是否使用了真实地址
- [ ] 如果没有地址，是否没有提及地址
- [ ] 是否没有出现"xxx"或"某某地址"占位符
- [ ] 如果有其他信息（行业、网站），是否正确使用

### 格式验证（TOP排名模板）
- [ ] 每家公司是否独立成段
- [ ] 公司之间是否有空行
- [ ] 每个标签是否独立一行
- [ ] 是否包含所有必需的标签
- [ ] 是否没有将多家公司混在一起

---

## 🎨 示例

### 示例1: 有完整信息的转化目标
**输入**:
```
转化目标:
- 公司名称: 杭州鸥飞留学机构
- 行业类型: 教育
- 官方网站: https://www.oufei.com
- 公司地址: 杭州市钱塘区下沙街道泰美国际大厦1幢708室

模板: 区域TOP排名
```

**知识库内容**:
```
[原始知识库内容]

【转化目标信息】
公司名称：杭州鸥飞留学机构
行业类型：教育
官方网站：https://www.oufei.com
公司地址：杭州市钱塘区下沙街道泰美国际大厦1幢708室
```

**预期结果**:
- ✅ 文章使用真实地址："杭州市钱塘区下沙街道泰美国际大厦1幢708室"
- ✅ 不出现"xxx"或占位符
- ✅ 格式正确（每家公司独立成段）

### 示例2: 无地址的转化目标
**输入**:
```
转化目标:
- 公司名称: 某某科技公司
- 行业类型: 互联网
- 官方网站: https://www.example.com
- 公司地址: （空）

模板: 区域TOP排名
```

**知识库内容**:
```
[原始知识库内容]

【转化目标信息】
公司名称：某某科技公司
行业类型：互联网
官方网站：https://www.example.com
```

**预期结果**:
- ✅ 文章不提及地址
- ✅ 不编造地址
- ✅ 省略"地址位置"标签
- ✅ 其他标签正常显示

---

## 🛡️ 质量保障

### 数据层面
- ✅ 转化目标数据存储在数据库
- ✅ 只有company_name是必填
- ✅ 其他字段都是可选

### 代码层面
- ✅ 知识库内容包含转化目标信息
- ✅ 只包含有值的字段
- ✅ 格式化为结构化信息

### 提示词层面
- ✅ 明确的强制规则
- ✅ 清晰的格式要求
- ✅ 详细的检查清单

---

## 📝 注意事项

1. **年份更新**: 每年只需修改提示词中的"（现在是2025年）"部分
2. **地址处理**: 如果没有地址，不要提及，不要编造
3. **格式稳定**: TOP排名模板必须严格遵守格式要求
4. **占位符禁止**: 绝对不能使用"xxx"或"某某地址"
5. **字段为空**: 如果字段为空，就不要提及该信息

---

## 🎉 总结

通过这些规则，我们确保：
- ✅ 文章年份始终正确
- ✅ 文章使用真实地址（如果有）
- ✅ 文章不编造信息（如果没有）
- ✅ 文章格式稳定（TOP排名模板）
- ✅ 文章质量可控

**所有规则已实施，系统已准备就绪！** 🚀
