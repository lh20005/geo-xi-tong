# Bug 修复工作流规则

## 服务器数据库/迁移问题修复流程

当发现服务器上因迁移问题导致的数据库错误时，必须按以下顺序处理：

### 1. 先修复服务器问题
- 直接在服务器数据库上执行修复 SQL
- 确保服务器功能恢复正常
- 验证修复是否生效

### 2. 修改本地迁移文件
- 找到导致问题的原始迁移文件
- 修改该迁移文件，使其包含正确的逻辑
- **不要创建新的修复迁移文件**（除非是新功能）

### 3. 清理临时文件
- 如果创建了临时修复迁移文件，在修改原始文件后删除它
- 保持迁移文件的整洁

## 原因

- 避免下次全新部署时重复出现同样的问题
- 保持迁移历史的简洁性
- 确保新环境部署时能一次性正确执行

## 示例

错误做法：
```
发现问题 → 创建 058_fix_xxx.sql → 部署修复
```

正确做法：
```
发现问题 → 服务器直接修复 → 修改原始迁移文件（如 031_xxx.sql）→ 删除临时修复文件
```

## 注意事项

- 修改已执行的迁移文件不会影响已部署的服务器（因为迁移只执行一次）
- 但会确保新环境部署时使用正确的逻辑
- 如果是代码与数据库函数签名不匹配的问题，需要同时检查代码调用方式

修改文件后，需要重新编译 Electron 便于我在本地调试