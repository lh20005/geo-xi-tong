# 需求文档

## 简介

本功能旨在修复蒸馏结果模块中的两个关键bug：
1. "按关键词筛选"下拉列表只显示当前页数据的关键词，而不是所有关键词
2. "搜索问题内容"功能只能搜索当前筛选条件下的数据，无法搜索全部数据

这些问题导致用户无法有效地浏览和搜索所有蒸馏结果。

## 术语表

- **关键词列表（Keyword List）**: 用于筛选的所有唯一关键词的集合
- **搜索（Search）**: 在话题内容中进行模糊匹配查找
- **筛选（Filter）**: 按关键词或AI模型限制显示的数据范围
- **话题（Topic）**: 存储在topics表中的蒸馏问题记录
- **蒸馏结果（Distillation Result）**: 通过关键词蒸馏生成的话题问题

## 需求

### 需求 1

**用户故事：** 作为用户，我希望在"按关键词筛选"下拉列表中看到所有关键词，以便我可以筛选任何关键词的蒸馏结果

#### 验收标准

1. WHEN 用户打开蒸馏结果页面 THEN 系统应当加载并显示数据库中所有唯一的关键词
2. WHEN 关键词列表加载 THEN 系统应当去重并按字母顺序排序
3. WHEN 用户选择某个关键词 THEN 系统应当只显示该关键词的蒸馏结果
4. WHEN 用户清除关键词筛选 THEN 系统应当恢复显示所有蒸馏结果
5. WHEN 数据库中添加新关键词 THEN 刷新页面后关键词列表应当包含新关键词

### 需求 2

**用户故事：** 作为用户，我希望搜索功能能够搜索所有蒸馏结果，而不仅仅是当前筛选的结果，以便我可以找到任何话题

#### 验收标准

1. WHEN 用户在搜索框输入内容 THEN 系统应当在所有话题中进行搜索，不受当前筛选条件限制
2. WHEN 搜索返回结果 THEN 系统应当显示匹配的话题及其关联的关键词信息
3. WHEN 搜索框为空 THEN 系统应当恢复显示当前筛选条件下的所有结果
4. WHEN 用户输入搜索内容 THEN 系统应当在300ms延迟后执行搜索（防抖）
5. WHEN 搜索执行 THEN 系统应当清除之前的关键词和AI模型筛选条件

### 需求 3

**用户故事：** 作为用户，我希望筛选和搜索功能能够独立工作，以便我可以灵活地查找数据

#### 验收标准

1. WHEN 用户使用关键词筛选 THEN 搜索框应当被清空
2. WHEN 用户使用搜索功能 THEN 关键词和AI模型筛选应当被清空
3. WHEN 用户点击"清除筛选" THEN 系统应当清除所有筛选条件和搜索内容
4. WHEN 筛选或搜索条件改变 THEN 系统应当重置分页到第一页
5. WHEN 筛选或搜索条件改变 THEN 统计信息应当更新以反映当前显示的数据

### 需求 4

**用户故事：** 作为开发者，我希望后端API能够支持独立的关键词列表查询和全局搜索，以便前端能够正确实现这些功能

#### 验收标准

1. WHEN 前端请求关键词列表 THEN 后端应当返回数据库中所有唯一的关键词
2. WHEN 前端发送搜索请求 THEN 后端应当在所有话题中搜索，忽略其他筛选条件
3. WHEN 后端执行搜索 THEN 系统应当使用数据库的LIKE或全文搜索功能
4. WHEN API返回搜索结果 THEN 响应应当包含完整的话题信息和统计数据
5. WHEN API请求失败 THEN 系统应当返回明确的错误信息

### 需求 5

**用户故事：** 作为用户，我希望看到清晰的UI反馈，以便我知道当前应用了哪些筛选或搜索条件

#### 验收标准

1. WHEN 用户应用关键词筛选 THEN 筛选框应当显示选中的关键词
2. WHEN 用户输入搜索内容 THEN 搜索框应当显示输入的文本
3. WHEN 用户应用筛选或搜索 THEN 统计卡片应当显示"当前显示"数量
4. WHEN 没有应用任何筛选或搜索 THEN "清除筛选"按钮应当被禁用
5. WHEN 搜索或筛选无结果 THEN 系统应当显示友好的空状态提示
