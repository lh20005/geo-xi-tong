# 平台登录快速命令

## 🚀 启动系统

```bash
# 启动后端服务
./启动GEO系统.command

# 启动Windows登录管理器
./启动Windows管理器.command

# 重启系统
./重启GEO系统.command

# 检查服务状态
./检查服务状态.command
```

## 🧪 测试命令

### 单平台测试

```bash
# 自媒体平台
./test-platform-login.sh toutiao      # 头条号（已测试）
./test-platform-login.sh wangyi       # 网易号
./test-platform-login.sh souhu        # 搜狐号
./test-platform-login.sh baijiahao    # 百家号
./test-platform-login.sh qie          # 企鹅号

# 社交媒体平台
./test-platform-login.sh xiaohongshu  # 小红书
./test-platform-login.sh wechat       # 微信公众号
./test-platform-login.sh bilibili     # B站

# 技术社区平台
./test-platform-login.sh zhihu        # 知乎
./test-platform-login.sh csdn         # CSDN
./test-platform-login.sh jianshu      # 简书
./test-platform-login.sh juejin       # 掘金
./test-platform-login.sh segmentfault # SegmentFault
./test-platform-login.sh oschina      # 开源中国
./test-platform-login.sh cnblogs      # 博客园
./test-platform-login.sh v2ex         # V2EX
```

### 批量测试

```bash
# 交互式批量测试
./test-all-platforms.sh

# 选择选项1：逐个测试
# 选择选项2：查看配置
# 选择选项3：测试特定平台
```

## 🔍 查看账号

### 使用API

```bash
# 设置token（首次使用）
TOKEN="your_auth_token_here"

# 查看所有账号
curl http://localhost:3000/api/platform-accounts \
  -H "Authorization: Bearer $TOKEN" | jq '.'

# 查看特定平台账号
curl "http://localhost:3000/api/platform-accounts?platform=wangyi" \
  -H "Authorization: Bearer $TOKEN" | jq '.'

# 格式化显示账号信息
curl http://localhost:3000/api/platform-accounts \
  -H "Authorization: Bearer $TOKEN" | \
  jq '.accounts[] | {id, platform_id, account_name, real_username, status}'
```

### 使用界面

```
1. 打开 Windows登录管理器
2. 进入 "平台管理" 页面
3. 查看 "账号管理" 表格
```

## 🐛 调试命令

### 查看日志

```bash
# 查看后端日志（如果使用后台启动）
tail -f logs/backend.log

# 查看实时日志
# 在启动GEO系统的终端窗口中查看
```

### 查看HTML快照

```bash
# 列出所有快照
ls -la debug/

# 查看最新快照
ls -lt debug/ | head -n 2

# 打开快照文件
open debug/wangyi_1234567890.html

# 搜索快照中的用户名
grep -i "用户名\|username\|user-name" debug/wangyi_*.html
```

### 清理调试文件

```bash
# 清理HTML快照
rm -rf debug/*.html

# 重新创建debug目录
mkdir -p debug
```

## 📊 数据库查询

### 查看账号数据

```bash
# 连接数据库
psql -U postgres -d geo_system

# 查看所有账号
SELECT id, platform_id, account_name, real_username, status, created_at 
FROM platform_accounts 
ORDER BY created_at DESC;

# 查看特定平台账号
SELECT * FROM platform_accounts WHERE platform_id = 'wangyi';

# 统计各平台账号数
SELECT platform_id, COUNT(*) as count 
FROM platform_accounts 
GROUP BY platform_id 
ORDER BY count DESC;

# 退出数据库
\q
```

## 🔧 配置文件

### 编辑选择器配置

```bash
# 编辑AccountService
code server/src/services/AccountService.ts

# 搜索选择器配置
# 找到 "const selectors: { [key: string]: string[] }"
# 更新对应平台的选择器
```

### 重启服务使配置生效

```bash
# 方法1：使用重启脚本
./重启GEO系统.command

# 方法2：手动重启
# 1. 停止当前服务（Ctrl+C）
# 2. 重新启动
./启动GEO系统.command
```

## 📝 常用组合命令

### 完整测试流程

```bash
# 1. 启动系统
./启动GEO系统.command

# 2. 在新终端启动Windows管理器
./启动Windows管理器.command

# 3. 在新终端测试平台
./test-platform-login.sh wangyi

# 4. 查看结果
curl http://localhost:3000/api/platform-accounts \
  -H "Authorization: Bearer $TOKEN" | \
  jq '.accounts[] | select(.platform_id=="wangyi")'
```

### 调试失败的平台

```bash
# 1. 查看HTML快照
ls -lt debug/ | head -n 2
open debug/wangyi_*.html

# 2. 在HTML中搜索用户名
# 找到对应的class名

# 3. 更新选择器配置
code server/src/services/AccountService.ts

# 4. 重启服务
./重启GEO系统.command

# 5. 重新测试
./test-platform-login.sh wangyi
```

### 批量测试所有平台

```bash
# 1. 启动系统
./启动GEO系统.command
./启动Windows管理器.command

# 2. 运行批量测试
./test-all-platforms.sh

# 3. 选择交互式测试（选项1）
# 4. 逐个测试每个平台
# 5. 记录测试结果
```

## 🎯 快速参考

### 平台ID对照表

| 平台名称 | 平台ID | 测试命令 |
|---------|--------|----------|
| 头条号 | toutiao | `./test-platform-login.sh toutiao` |
| 网易号 | wangyi | `./test-platform-login.sh wangyi` |
| 搜狐号 | souhu | `./test-platform-login.sh souhu` |
| 百家号 | baijiahao | `./test-platform-login.sh baijiahao` |
| 企鹅号 | qie | `./test-platform-login.sh qie` |
| 小红书 | xiaohongshu | `./test-platform-login.sh xiaohongshu` |
| 微信公众号 | wechat | `./test-platform-login.sh wechat` |
| B站 | bilibili | `./test-platform-login.sh bilibili` |
| 知乎 | zhihu | `./test-platform-login.sh zhihu` |
| 简书 | jianshu | `./test-platform-login.sh jianshu` |
| CSDN | csdn | `./test-platform-login.sh csdn` |
| 掘金 | juejin | `./test-platform-login.sh juejin` |
| SegmentFault | segmentfault | `./test-platform-login.sh segmentfault` |
| 开源中国 | oschina | `./test-platform-login.sh oschina` |
| 博客园 | cnblogs | `./test-platform-login.sh cnblogs` |
| V2EX | v2ex | `./test-platform-login.sh v2ex` |

### 常见问题快速解决

| 问题 | 命令 |
|------|------|
| 浏览器未打开 | 检查Chrome安装：`which google-chrome-stable` |
| 用户名未提取 | 查看HTML快照：`open debug/*.html` |
| 账号未保存 | 查看后端日志，检查数据库 |
| 服务未启动 | 检查状态：`./检查服务状态.command` |
| 端口被占用 | 查找进程：`lsof -i :3000` |

## 💡 提示

### 获取Auth Token

```bash
# 方法1：从浏览器开发者工具
# 1. 打开Windows登录管理器
# 2. F12打开开发者工具
# 3. Application -> Local Storage
# 4. 找到 auth_token

# 方法2：从登录响应
# 登录时查看Network标签，找到登录响应中的token

# 保存token到文件（可选）
echo "your_token_here" > ~/.kiro/auth_token
```

### 使用保存的Token

```bash
# 从文件读取token
TOKEN=$(cat ~/.kiro/auth_token)

# 使用token
curl http://localhost:3000/api/platform-accounts \
  -H "Authorization: Bearer $TOKEN" | jq '.'
```

## 📚 相关文档

- `✅平台登录器开发完成.md` - 详细开发文档
- `平台登录器使用指南.md` - 完整使用说明
- `平台选择器配置参考.md` - 选择器配置参考
- `🎉平台登录器全部完成.md` - 完成总结

## 🎉 快速开始

```bash
# 三步开始测试
./启动GEO系统.command              # 1. 启动后端
./启动Windows管理器.command        # 2. 启动前端
./test-platform-login.sh wangyi   # 3. 测试平台
```

---

**提示:** 将此文件保存为书签，方便随时查阅！
