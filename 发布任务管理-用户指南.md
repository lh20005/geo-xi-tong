# 📚 发布任务管理 - 用户指南

## 🎯 功能概览

发布任务管理页面现在支持完整的任务生命周期管理，包括创建、执行、监控、终止和删除任务。

---

## 📋 任务状态说明

### 🕐 等待中 (Pending)
- 任务已创建，等待执行
- **可用操作**: 执行、取消、查看日志

### 🔄 执行中 (Running)
- 任务正在执行发布流程
- **可用操作**: 终止、查看日志
- **新功能**: 现在可以强制终止卡住的任务！

### ✅ 成功 (Success)
- 任务执行成功，文章已发布
- **可用操作**: 删除、查看日志

### ❌ 失败 (Failed)
- 任务执行失败
- **可用操作**: 删除、查看日志

### 🚫 已取消 (Cancelled)
- 任务被用户取消
- **可用操作**: 删除、查看日志

---

## 🔧 功能详解

### 1️⃣ 单个任务操作

#### 📊 查看日志
**适用状态**: 所有状态
**操作步骤**:
1. 找到目标任务
2. 点击"日志"按钮
3. 在弹窗中查看详细执行日志

**日志包含**:
- 执行步骤记录
- 错误信息
- 时间戳
- 详细参数

---

#### ▶️ 立即执行
**适用状态**: 等待中
**操作步骤**:
1. 找到待执行的任务
2. 点击"执行"按钮
3. 确认执行
4. 任务状态变为"执行中"

---

#### ⏹️ 终止任务 (新功能)
**适用状态**: 执行中
**使用场景**:
- 任务执行时间过长
- 任务卡住不动
- 需要紧急停止任务

**操作步骤**:
1. 找到执行中的任务
2. 点击红色"终止"按钮
3. 确认终止操作
4. 任务状态变为"失败"
5. 日志中记录终止原因

**⚠️ 注意**:
- 终止操作不可撤销
- 任务会被标记为失败
- 已发布的内容不会自动撤回

---

#### 🗑️ 删除任务 (新功能)
**适用状态**: 成功、失败、已取消
**操作步骤**:
1. 找到已完成的任务
2. 点击红色"删除"按钮
3. 确认删除操作
4. 任务和相关日志被永久删除

**⚠️ 注意**:
- 删除操作不可恢复
- 会同时删除任务日志
- 不影响已发布的文章

---

#### ❌ 取消任务
**适用状态**: 等待中
**操作步骤**:
1. 找到待执行的任务
2. 点击"取消"按钮
3. 确认取消
4. 任务状态变为"已取消"

---

### 2️⃣ 批量操作 (新功能)

#### ☑️ 选择任务
**方式一: 单选**
- 勾选任务前的复选框
- 可以选择多个任务

**方式二: 全选**
- 点击表头的复选框
- 一次选中当前页所有任务

**选择提示**:
- 表头显示"已选 N 个"标签
- 批量操作按钮显示选中数量

---

#### 🗑️ 批量删除
**操作步骤**:
1. 勾选要删除的任务（可多选）
2. 点击右上角"批量删除 (N)"按钮
3. 确认批量删除
4. 查看删除结果统计

**结果显示**:
- 成功删除 X 个任务
- 失败 Y 个任务（如果有）
- 失败原因列表

**⚠️ 注意**:
- 可以选择不同状态的任务
- 执行中的任务会先被终止再删除
- 操作不可恢复

---

#### 🗑️ 删除全部 (新功能)
**使用场景**:
- 清空所有任务记录
- 重新开始任务管理
- 定期清理历史任务

**操作步骤**:
1. 点击右上角"删除全部"按钮
2. 阅读警告信息
3. 确认删除所有任务
4. 查看删除数量

**⚠️ 警告**:
- 会删除所有状态的任务
- 包括执行中的任务
- 操作不可恢复
- 建议定期备份重要数据

---

## 💡 使用技巧

### 🎯 场景一: 任务卡住不动
**问题**: 任务显示"执行中"但长时间没有进展

**解决方案**:
1. 点击"日志"查看最后的执行记录
2. 确认任务确实卡住
3. 点击"终止"按钮强制停止
4. 查看日志了解卡住原因
5. 修复问题后重新创建任务

---

### 🎯 场景二: 清理历史任务
**问题**: 任务列表太多，影响查看

**解决方案**:

**方式一: 批量删除已完成任务**
1. 勾选所有成功的任务
2. 点击"批量删除"
3. 保留失败任务用于分析

**方式二: 一键清空**
1. 点击"删除全部"
2. 清空所有历史记录
3. 重新开始

---

### 🎯 场景三: 任务执行失败
**问题**: 任务状态显示"失败"

**处理流程**:
1. 点击"日志"查看失败原因
2. 分析错误信息
3. 修复问题（如账号登录、网络等）
4. 删除失败任务
5. 重新创建任务

---

## 📊 界面布局

```
┌─────────────────────────────────────────────────────────────┐
│  发布任务                    [批量删除(N)] [删除全部] [刷新]  │
├─────────────────────────────────────────────────────────────┤
│ [✓] ID  文章ID  平台  账号  状态  计划时间  创建时间  操作    │
├─────────────────────────────────────────────────────────────┤
│ [ ] 1   100    头条  账号1  等待中  立即执行  2024-12-17     │
│                                      [日志] [执行] [取消]     │
├─────────────────────────────────────────────────────────────┤
│ [✓] 2   101    微信  账号2  执行中  立即执行  2024-12-17     │
│                                      [日志] [终止]            │
├─────────────────────────────────────────────────────────────┤
│ [✓] 3   102    头条  账号1  成功    立即执行  2024-12-17     │
│                                      [日志] [删除]            │
├─────────────────────────────────────────────────────────────┤
│ [ ] 4   103    微信  账号2  失败    立即执行  2024-12-17     │
│                                      [日志] [删除]            │
└─────────────────────────────────────────────────────────────┘
```

---

## ⚠️ 重要提示

### 🔒 安全确认
所有危险操作都需要二次确认：
- ⏹️ 终止任务
- 🗑️ 删除任务
- 🗑️ 批量删除
- 🗑️ 删除全部

### 💾 数据保护
- 删除操作不可恢复
- 建议定期导出重要任务日志
- 删除前确认不再需要该数据

### 🔄 任务状态
- 终止的任务会变为"失败"状态
- 失败的任务可以查看日志分析原因
- 成功的任务可以安全删除

---

## 🆘 常见问题

### Q1: 为什么有些任务没有"删除"按钮？
**A**: 只有已完成（成功/失败/已取消）的任务才能删除。执行中的任务需要先"终止"。

### Q2: 终止任务后能恢复吗？
**A**: 不能。终止后任务状态变为"失败"，需要重新创建任务。

### Q3: 批量删除失败怎么办？
**A**: 查看失败原因，可能是某些任务不存在或正在执行。可以单独处理失败的任务。

### Q4: 删除任务会影响已发布的文章吗？
**A**: 不会。删除任务只是删除任务记录，不影响已发布的内容。

### Q5: 如何查看任务执行进度？
**A**: 点击"日志"按钮，查看详细的执行步骤和进度。

---

## 📞 技术支持

如遇到问题，请：
1. 查看任务日志了解详情
2. 检查服务器日志
3. 联系技术支持团队

---

**文档版本**: v1.0
**更新日期**: 2024-12-17
**适用版本**: v2.0+
