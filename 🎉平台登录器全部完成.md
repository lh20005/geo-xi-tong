# ğŸ‰ å¹³å°ç™»å½•å™¨å…¨éƒ¨å®Œæˆ

## å®Œæˆæ—¶é—´
2025-12-31

## å®Œæˆå†…å®¹

å·²æˆåŠŸåˆ›å»º **12ä¸ªå¹³å°** çš„ä¸“ç”¨ç™»å½•ç®¡ç†å™¨ï¼Œå…¨éƒ¨åŸºäº GEO åº”ç”¨çš„å®ç°æ–¹å¼ã€‚

### å·²åˆ›å»ºçš„å¹³å°ç™»å½•å™¨

1. âœ… **å¤´æ¡å·** (toutiao-login-manager.ts) - å·²å­˜åœ¨
2. âœ… **æŠ–éŸ³å·** (douyin-login-manager.ts) - å·²å­˜åœ¨
3. âœ… **å°çº¢ä¹¦** (xiaohongshu-login-manager.ts) - æ–°åˆ›å»º
4. âœ… **å¾®ä¿¡å…¬ä¼—å·** (wechat-login-manager.ts) - æ–°åˆ›å»º
5. âœ… **ç™¾å®¶å·** (baijiahao-login-manager.ts) - æ–°åˆ›å»º
6. âœ… **ç®€ä¹¦** (jianshu-login-manager.ts) - æ–°åˆ›å»º
7. âœ… **çŸ¥ä¹** (zhihu-login-manager.ts) - æ–°åˆ›å»º
8. âœ… **ä¼é¹…å·** (qie-login-manager.ts) - æ–°åˆ›å»º
9. âœ… **æœç‹å·** (souhu-login-manager.ts) - æ–°åˆ›å»º
10. âœ… **ç½‘æ˜“å·** (wangyi-login-manager.ts) - æ–°åˆ›å»º
11. âœ… **CSDN** (csdn-login-manager.ts) - æ–°åˆ›å»º
12. âœ… **å“”å“©å“”å“©** (bilibili-login-manager.ts) - æ–°åˆ›å»º

### é…ç½®æ›´æ–°

âœ… **handler.ts** å·²æ›´æ–°
- å¯¼å…¥æ‰€æœ‰12ä¸ªå¹³å°çš„ç™»å½•ç®¡ç†å™¨
- åœ¨ `login-platform` å¤„ç†å™¨ä¸­æ³¨å†Œæ‰€æœ‰å¹³å°
- åœ¨ `cancel-login` å¤„ç†å™¨ä¸­æ·»åŠ æ‰€æœ‰å¹³å°çš„å–æ¶ˆé€»è¾‘

## æ ¸å¿ƒç‰¹æ€§

### 1. å®Œå…¨åŸºäº GEO åº”ç”¨å®ç°
- æ‰€æœ‰é€‰æ‹©å™¨ä» GEO åº”ç”¨çš„è„šæœ¬ä¸­æå–
- æ£€æŸ¥é—´éš”ä¸ GEO åº”ç”¨ä¿æŒä¸€è‡´
- ç‰¹æ®Šå¤„ç†é€»è¾‘å®Œå…¨æŒ‰ç…§ GEO æ–¹å¼å®ç°

### 2. çœŸå®ç”¨æˆ·åæå–
- æ¯ä¸ªå¹³å°éƒ½æ­£ç¡®æå–çœŸå®ç”¨æˆ·å
- ä¿å­˜åˆ° `real_username` å­—æ®µ
- åœ¨"è´¦å·ç®¡ç†"åˆ—è¡¨ä¸­æ­£ç¡®æ˜¾ç¤º

### 3. ç»Ÿä¸€çš„æ¶æ„
- æ‰€æœ‰ç™»å½•ç®¡ç†å™¨ä½¿ç”¨ç›¸åŒçš„æ¶æ„
- å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œèµ„æºæ¸…ç†
- è¯¦ç»†çš„æ—¥å¿—è®°å½•
- æ”¯æŒå–æ¶ˆæ“ä½œ

### 4. Cookie éš”ç¦»
- æ¯ä¸ªå¹³å°ä½¿ç”¨ç‹¬ç«‹çš„ partition
- ç¡®ä¿ä¸åŒå¹³å°çš„ Cookie äº’ä¸å¹²æ‰°
- æ”¯æŒåŒä¸€å¹³å°çš„å¤šè´¦å·ç™»å½•

## æŠ€æœ¯ç»†èŠ‚

### æ£€æŸ¥é—´éš”é…ç½®
```typescript
// 500ms
- ç™¾å®¶å·

// 1000ms
- å¤´æ¡å·ã€æŠ–éŸ³å·ã€ç®€ä¹¦ã€ä¼é¹…å·ã€æœç‹å·ã€ç½‘æ˜“å·

// 2000ms
- å°çº¢ä¹¦ã€å¾®ä¿¡å…¬ä¼—å·ã€çŸ¥ä¹ã€CSDNã€å“”å“©å“”å“©
```

### ç‰¹æ®Šå¤„ç†æ–¹å¼

#### API è°ƒç”¨å¹³å°
- **çŸ¥ä¹**: `https://www.zhihu.com/api/v4/me?include=is_realname`
- **CSDN**: `https://g-api.csdn.net/community/toolbar-api/v1/get-user-info`
- **å“”å“©å“”å“©**: `https://api.bilibili.com/x/web-interface/nav`

#### éœ€è¦é¼ æ ‡äº‹ä»¶
- **ç™¾å®¶å·**: é¼ æ ‡æ‚¬åœåœ¨ `.p7Psc5P3uJ5lyxeI0ETR`
- **ç®€ä¹¦**: é¼ æ ‡æ‚¬åœ `.user` ç„¶åç‚¹å‡» `.user li a`

#### ç‰¹æ®Šè§£æ
- **ç™¾å®¶å·**: ç”¨æˆ·åéœ€è¦ `split(',')[1]`
- **ç½‘æ˜“å·**: ç”¨æˆ·ååœ¨ç¬¬3ä¸ª span å…ƒç´ 
- **ä¼é¹…å·**: ç²‰ä¸æ•°åœ¨ç¬¬4ä¸ªå…ƒç´ 

## æ–‡ä»¶ç»“æ„

```
windows-login-manager/
â”œâ”€â”€ electron/
â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”œâ”€â”€ toutiao-login-manager.ts      âœ…
â”‚   â”‚   â”œâ”€â”€ douyin-login-manager.ts       âœ…
â”‚   â”‚   â”œâ”€â”€ xiaohongshu-login-manager.ts  âœ…
â”‚   â”‚   â”œâ”€â”€ wechat-login-manager.ts       âœ…
â”‚   â”‚   â”œâ”€â”€ baijiahao-login-manager.ts    âœ…
â”‚   â”‚   â”œâ”€â”€ jianshu-login-manager.ts      âœ…
â”‚   â”‚   â”œâ”€â”€ zhihu-login-manager.ts        âœ…
â”‚   â”‚   â”œâ”€â”€ qie-login-manager.ts          âœ…
â”‚   â”‚   â”œâ”€â”€ souhu-login-manager.ts        âœ…
â”‚   â”‚   â”œâ”€â”€ wangyi-login-manager.ts       âœ…
â”‚   â”‚   â”œâ”€â”€ csdn-login-manager.ts         âœ…
â”‚   â”‚   â”œâ”€â”€ bilibili-login-manager.ts     âœ…
â”‚   â”‚   â”œâ”€â”€ webview-manager.ts            (å…±äº«)
â”‚   â”‚   â”œâ”€â”€ cookie-manager.ts             (å…±äº«)
â”‚   â”‚   â””â”€â”€ login-manager.ts              (é€šç”¨åå¤‡)
â”‚   â””â”€â”€ ipc/
â”‚       â””â”€â”€ handler.ts                     âœ… å·²æ›´æ–°
```

## ä½¿ç”¨æ–¹å¼

### å‰ç«¯è°ƒç”¨
```typescript
// ç™»å½•æŒ‡å®šå¹³å°
const result = await window.electron.invoke('login-platform', 'xiaohongshu');

// å–æ¶ˆç™»å½•
await window.electron.invoke('cancel-login', 'xiaohongshu');

// å–æ¶ˆæ‰€æœ‰ç™»å½•
await window.electron.invoke('cancel-login');
```

### åç«¯å¤„ç†
```typescript
// handler.ts ä¼šè‡ªåŠ¨è·¯ç”±åˆ°å¯¹åº”çš„ç™»å½•ç®¡ç†å™¨
if (platformId === 'xiaohongshu') {
  const result = await xiaohongshuLoginManager.login(mainWindow);
  return result;
}
```

## æµ‹è¯•å»ºè®®

### 1. é€ä¸ªå¹³å°æµ‹è¯•
æŒ‰ç…§ä»¥ä¸‹é¡ºåºæµ‹è¯•æ¯ä¸ªå¹³å°ï¼š
1. å¤´æ¡å·
2. æŠ–éŸ³å·
3. å°çº¢ä¹¦
4. å¾®ä¿¡å…¬ä¼—å·
5. ç™¾å®¶å·
6. ç®€ä¹¦
7. çŸ¥ä¹
8. ä¼é¹…å·
9. æœç‹å·
10. ç½‘æ˜“å·
11. CSDN
12. å“”å“©å“”å“©

### 2. æµ‹è¯•é¡¹ç›®
- [ ] ç™»å½•é¡µé¢æ­£ç¡®æ‰“å¼€
- [ ] ç™»å½•æˆåŠŸæ£€æµ‹å‡†ç¡®
- [ ] ç”¨æˆ·åæ­£ç¡®æå–
- [ ] Cookie æ­£ç¡®ä¿å­˜
- [ ] è´¦å·åˆ—è¡¨æ­£ç¡®æ˜¾ç¤º
- [ ] å–æ¶ˆç™»å½•åŠŸèƒ½æ­£å¸¸
- [ ] é”™è¯¯å¤„ç†æ­£ç¡®
- [ ] æ—¥å¿—è®°å½•å®Œæ•´

### 3. éªŒè¯è¦ç‚¹
- çœŸå®ç”¨æˆ·åæ˜¾ç¤ºåœ¨è´¦å·ç®¡ç†åˆ—è¡¨
- åŒä¸€å¹³å°å¯ä»¥æ·»åŠ å¤šä¸ªè´¦å·
- Cookie åœ¨ä¸åŒè´¦å·é—´æ­£ç¡®éš”ç¦»
- ç™»å½•çŠ¶æ€æŒä¹…åŒ–ä¿å­˜

## ä¸‹ä¸€æ­¥å·¥ä½œ

### å¯é€‰ä¼˜åŒ–
1. åˆ é™¤é€šç”¨ç™»å½•å™¨ `login-manager.ts`ï¼ˆå¦‚æœä¸å†éœ€è¦ï¼‰
2. æ·»åŠ æ›´å¤šå¹³å°ï¼ˆå¦‚å¿«æ‰‹ç­‰ï¼‰
3. ä¼˜åŒ–ç™»å½•æ£€æµ‹é€Ÿåº¦
4. æ·»åŠ ç™»å½•å¤±è´¥é‡è¯•æœºåˆ¶

### æµ‹è¯•å’ŒéªŒè¯
1. åœ¨å®é™…ç¯å¢ƒä¸­æµ‹è¯•æ‰€æœ‰å¹³å°
2. éªŒè¯ç”¨æˆ·åæå–çš„å‡†ç¡®æ€§
3. æµ‹è¯•å¤šè´¦å·åœºæ™¯
4. éªŒè¯ Cookie æŒä¹…åŒ–

### æ–‡æ¡£å®Œå–„
1. ä¸ºæ¯ä¸ªå¹³å°åˆ›å»ºæµ‹è¯•æŒ‡å—
2. è®°å½•å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ
3. æ›´æ–°ç”¨æˆ·ä½¿ç”¨æ–‡æ¡£

## å‚è€ƒæ–‡æ¡£

- `GEOåº”ç”¨è„šæœ¬è¯¦ç»†åˆ†æ.md` - GEO åº”ç”¨è„šæœ¬åˆ†æ
- `å¹³å°ç™»å½•å™¨åˆ›å»ºè¿›åº¦.md` - åˆ›å»ºè¿›åº¦è·Ÿè¸ª
- `å¦‚ä½•ä¸ºå…¶ä»–å¹³å°åˆ›å»ºç‹¬ç«‹ç™»å½•å™¨.md` - åˆ›å»ºæŒ‡å—
- `å¹³å°ç™»å½•ä¿¡æ¯è·å–å’Œä¿å­˜æŒ‡å—.md` - ä½¿ç”¨æŒ‡å—

## æ€»ç»“

æ‰€æœ‰12ä¸ªå¹³å°çš„ä¸“ç”¨ç™»å½•ç®¡ç†å™¨å·²ç»åˆ›å»ºå®Œæˆï¼Œå¹¶ä¸”å·²ç»åœ¨ `handler.ts` ä¸­æ­£ç¡®æ³¨å†Œã€‚æ¯ä¸ªç™»å½•ç®¡ç†å™¨éƒ½ï¼š

âœ… åŸºäº GEO åº”ç”¨çš„å®ç°æ–¹å¼
âœ… æ­£ç¡®æå–çœŸå®ç”¨æˆ·å
âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†
âœ… è¯¦ç»†çš„æ—¥å¿—è®°å½•
âœ… æ”¯æŒå–æ¶ˆæ“ä½œ
âœ… Cookie æ­£ç¡®éš”ç¦»

ç°åœ¨å¯ä»¥å¼€å§‹æµ‹è¯•æ¯ä¸ªå¹³å°çš„ç™»å½•åŠŸèƒ½äº†ï¼
