# 自动登录发布功能 - 快速使用指南

## 🚀 快速开始

### 第一步：绑定平台账号

1. 打开应用，进入 **"平台登录"** 页面
2. 选择要绑定的平台（如：头条号、知乎、百家号等）
3. 点击 **"浏览器登录"** 按钮
4. 在弹出的浏览器窗口中正常登录平台
5. 登录成功后，系统会自动保存Cookie
6. 关闭浏览器窗口，账号绑定完成

**提示**：Cookie会被加密存储，安全可靠！

### 第二步：创建文章

1. 进入 **"文章管理"** 页面
2. 点击 **"新建文章"** 或使用 **"文章生成"** 功能
3. 编辑文章标题和内容
4. 保存文章

### 第三步：发布文章

1. 在文章列表中找到要发布的文章
2. 点击文章右侧的 **"发布到平台"** 按钮
3. 在弹出的对话框中：
   - 选择目标平台（只显示已绑定的平台）
   - 选择账号（如果有多个）
   - 可选：修改标题、设置分类、添加标签
   - 可选：设置定时发布
4. 点击 **"创建发布任务"**

### 第四步：查看发布结果

1. 进入 **"发布记录"** 页面
2. 查看任务状态：
   - 🟡 **等待执行**：任务已创建，等待系统处理
   - 🔵 **正在执行**：系统正在自动登录和发布
   - 🟢 **发布成功**：文章已成功发布到平台
   - 🔴 **发布失败**：发布过程中出现错误
3. 点击任务可查看详细日志

## 🎯 核心优势

### ✅ 一次登录，永久使用
- 只需登录一次，系统自动保存Cookie
- 后续发布无需再次登录
- Cookie过期会自动提醒重新登录

### ✅ 完全自动化
- 系统自动打开浏览器
- 自动使用Cookie登录
- 自动填充文章内容
- 自动点击发布按钮
- 全程无需人工干预

### ✅ 多平台支持
支持12个主流平台：
- 自媒体：网易号、搜狐号、百家号、头条号、企鹅号
- 社交：微信公众号、小红书、抖音号、哔哩哔哩
- 技术：知乎、简书、CSDN

### ✅ 智能容错
- Cookie失败自动降级到表单登录
- 发布失败自动重试（最多3次）
- 详细的错误日志帮助排查问题

## 📝 使用场景

### 场景1：单篇文章多平台分发
```
1. 创建一篇文章
2. 点击"发布到平台"
3. 选择"头条号"，创建任务
4. 再次点击"发布到平台"
5. 选择"知乎"，创建任务
6. 系统自动发布到两个平台
```

### 场景2：批量文章定时发布
```
1. 创建多篇文章
2. 为每篇文章创建发布任务
3. 设置不同的发布时间
4. 系统按时自动发布
```

### 场景3：多账号管理
```
1. 绑定同一平台的多个账号
2. 发布时选择不同账号
3. 实现账号轮换发布
```

## 🔧 常见问题

### Q1: Cookie会过期吗？
**A**: 会的。不同平台的Cookie有效期不同，通常为7-30天。过期后系统会提示重新登录。

### Q2: 如何知道Cookie是否有效？
**A**: 在"平台登录"页面可以看到账号状态。如果显示"正常"，说明Cookie有效。

### Q3: 发布失败怎么办？
**A**: 
1. 查看"发布记录"中的错误信息
2. 常见原因：Cookie过期、平台维护、网络问题
3. 可以点击"重新发布"按钮重试

### Q4: 可以同时发布多个任务吗？
**A**: 可以。系统支持并发执行，默认最多同时执行3个任务。

### Q5: 发布的文章可以撤回吗？
**A**: 不可以。文章一旦发布到平台，需要在平台上手动删除。

### Q6: 支持定时发布吗？
**A**: 支持。在创建任务时可以设置"定时发布"，系统会在指定时间自动执行。

## 🛠️ 测试功能

### 使用测试脚本
```bash
# 运行自动化测试
./test-auto-publish.sh
```

测试脚本会：
1. 检查已绑定的账号
2. 获取一篇测试文章
3. 创建发布任务
4. 监控任务执行
5. 显示发布结果

### 手动测试步骤
1. 绑定一个测试平台账号
2. 创建一篇测试文章（标题：测试自动发布）
3. 发布到测试平台
4. 在平台上验证文章是否发布成功
5. 删除测试文章

## 📊 监控和日志

### 查看任务日志
1. 进入"发布记录"页面
2. 点击任务行
3. 查看详细日志，包括：
   - 浏览器启动
   - 登录过程
   - 页面导航
   - 内容填充
   - 发布结果

### 日志示例
```
[INFO] 开始执行发布任务
[INFO] 启动浏览器
[INFO] 导航到: https://mp.toutiao.com/auth/page/login
[INFO] [头条号] 使用Cookie登录
[INFO] [Cookie登录] 开始设置 15 个Cookie
[INFO] [Cookie登录] Cookie设置成功
[INFO] ✅ 头条号Cookie登录成功
[INFO] 导航到发布页面
[INFO] 开始发布文章
[INFO] 填充输入框: input[placeholder="填写标题"]
[INFO] 填充输入框: .ql-editor
[INFO] 点击元素: button.publish
[INFO] ✅ 文章发布成功
```

## 🔐 安全说明

### Cookie加密存储
- 所有Cookie使用AES-256加密
- 加密密钥存储在环境变量中
- 数据库中只存储密文

### 权限控制
- 每个用户只能访问自己的账号
- 账号删除时自动清理所有数据
- 支持账号禁用功能

### 最佳实践
1. 定期更新Cookie（重新登录）
2. 不要共享账号凭证
3. 及时删除不用的账号
4. 使用强密码保护平台账号

## 📞 技术支持

### 遇到问题？
1. 查看"发布记录"中的错误日志
2. 检查平台账号是否正常
3. 尝试重新登录平台
4. 查看服务器日志：`npm run dev`

### 反馈建议
如果您有任何建议或发现问题，欢迎反馈！

## 🎉 开始使用

现在就去试试吧！

1. 绑定您的第一个平台账号
2. 创建一篇文章
3. 点击"发布到平台"
4. 见证自动化的魔力！

---

**提示**：首次使用建议先用测试账号和测试文章进行尝试，熟悉流程后再正式使用。
