# 快速修复指南

## 问题：文章生成模块下拉列表无数据

## 快速诊断（3步）

### 步骤1：检查服务器是否运行
```bash
curl http://localhost:3000/api/health
```
✅ 应该返回：`{"status":"ok","message":"GEO优化系统运行正常"}`

### 步骤2：运行API测试脚本
```bash
./test-dropdown-apis.sh
```
✅ 所有5个API应该显示"✓ 成功"

### 步骤3：检查浏览器控制台
1. 打开浏览器（按F12）
2. 切换到Console标签
3. 点击"新建任务"按钮
4. 查看日志输出

## 如果看到数据加载成功但下拉列表仍为空

### 解决方案1：清除缓存并刷新
```bash
# 1. 清除浏览器缓存（Ctrl+Shift+Delete）
# 2. 硬刷新页面（Ctrl+Shift+R 或 Cmd+Shift+R）
```

### 解决方案2：重启前端服务
```bash
cd client
npm run dev
```

### 解决方案3：检查React DevTools
1. 安装React DevTools浏览器扩展
2. 打开DevTools
3. 查看TaskConfigModal组件的state
4. 确认数据是否在state中

## 如果看到API错误

### 错误：Connection refused
```bash
# 启动后端服务器
cd server
npm run dev
```

### 错误：404 Not Found
```bash
# 检查API路由是否正确注册
# 查看 server/src/routes/index.ts
```

### 错误：CORS
```bash
# 检查前端是否通过代理访问后端
# 查看 client/vite.config.ts 中的 proxy 配置
```

## 常见问题

### Q: 控制台显示"加载数据失败"
**A:** 查看详细错误信息，通常会显示具体哪个API失败了

### Q: 某个下拉列表有数据，其他没有
**A:** 检查控制台日志，看哪个API加载失败

### Q: 所有API都成功但下拉列表仍为空
**A:** 可能是React状态更新问题，尝试：
1. 清除浏览器缓存
2. 重启前端服务
3. 检查React DevTools中的组件状态

## 联系支持

如果以上方法都无法解决问题，请提供：
1. 浏览器控制台的完整日志（截图或文本）
2. Network标签中的API请求详情
3. 浏览器类型和版本
4. 操作系统

## 已修复的问题

✅ 添加了详细的控制台日志
✅ 修复了pageSize参数超限问题
✅ 添加了空数组保护
✅ 创建了测试脚本和文档

## 验证修复成功

当你看到以下内容时，说明修复成功：

**浏览器控制台：**
```
✅ 所有数据加载完成
  - 蒸馏记录数: 7
  - 相册数: 2
  - 知识库数: 1
  - 文章设置数: 1
  - 转化目标数: 1
```

**下拉列表：**
- 蒸馏历史：显示7个选项
- 转化目标：显示1个选项
- 企业图库：显示2个选项
- 企业知识库：显示1个选项
- 文章设置：显示1个选项
