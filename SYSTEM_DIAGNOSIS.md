# ğŸ” ç³»ç»Ÿè¯Šæ–­æŠ¥å‘Š

**è¯Šæ–­æ—¶é—´**: 2024-12-25  
**é—®é¢˜**: ç”¨æˆ·æ— æ³•ç™»å½•ï¼Œç™»å½•åæ— æ³•è¿›å…¥ç³»ç»Ÿ

---

## âœ… æœåŠ¡çŠ¶æ€æ£€æŸ¥

### 1. åç«¯æœåŠ¡ (Port 3000)
- **çŠ¶æ€**: âœ… è¿è¡Œä¸­
- **åœ°å€**: http://localhost:3000
- **WebSocket**: ws://localhost:3000/ws
- **æ•°æ®åº“**: âœ… å·²è¿æ¥
- **Redis**: âœ… å·²è¿æ¥

### 2. å‰ç«¯æœåŠ¡ (Port 5173)
- **çŠ¶æ€**: âœ… è¿è¡Œä¸­
- **åœ°å€**: http://localhost:5173

### 3. Landing é¡µé¢ (Port 8080)
- **çŠ¶æ€**: âœ… è¿è¡Œä¸­
- **åœ°å€**: http://localhost:8080

---

## âœ… å·²ä¿®å¤çš„é—®é¢˜

### é—®é¢˜1: åç«¯å¯åŠ¨å¤±è´¥
**é”™è¯¯**: `Cannot find module '../../middleware/auth'`

**åŸå› **: 
- `server/src/routes/admin/orders.ts` å¼•ç”¨äº†ä¸å­˜åœ¨çš„ `auth` ä¸­é—´ä»¶
- `server/src/routes/admin/audit-logs.ts` å¼•ç”¨äº†ä¸å­˜åœ¨çš„ `auth` ä¸­é—´ä»¶

**ä¿®å¤**:
- å°† `import { authenticate, requireAdmin } from '../../middleware/auth'` 
- æ”¹ä¸º `import { authenticate, requireAdmin } from '../../middleware/adminAuth'`

**ç»“æœ**: âœ… åç«¯æœåŠ¡ç°åœ¨æ­£å¸¸è¿è¡Œ

---

## âœ… ç™»å½•åŠŸèƒ½æµ‹è¯•

### API æµ‹è¯•
```bash
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'
```

**ç»“æœ**: âœ… æˆåŠŸè¿”å› token

```json
{
  "success": true,
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expiresIn": 3600,
    "user": {
      "id": 1,
      "username": "admin",
      "email": "admin@local.system",
      "role": "admin",
      "invitationCode": "xr2w8q",
      "isTempPassword": false
    }
  }
}
```

---

## ğŸ” å¯èƒ½çš„é—®é¢˜æ’æŸ¥

### é—®é¢˜1: ç½‘é¡µç™»å½•å¤±è´¥

**å¯èƒ½åŸå› **:
1. æµè§ˆå™¨ç¼“å­˜é—®é¢˜
2. CORS é…ç½®é—®é¢˜
3. å‰ç«¯é…ç½®é”™è¯¯

**æ’æŸ¥æ­¥éª¤**:

#### 1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
```
1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)
2. å³é”®ç‚¹å‡»åˆ·æ–°æŒ‰é’®
3. é€‰æ‹©"æ¸…ç©ºç¼“å­˜å¹¶ç¡¬æ€§é‡æ–°åŠ è½½"
```

#### 2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°
```
1. æ‰“å¼€ http://localhost:8080 (Landingé¡µé¢)
2. æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
3. æŸ¥çœ‹ Console æ ‡ç­¾é¡µ
4. æŸ¥çœ‹æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯
```

#### 3. æ£€æŸ¥ç½‘ç»œè¯·æ±‚
```
1. åœ¨å¼€å‘è€…å·¥å…·ä¸­åˆ‡æ¢åˆ° Network æ ‡ç­¾é¡µ
2. å°è¯•ç™»å½•
3. æŸ¥çœ‹ç™»å½•è¯·æ±‚æ˜¯å¦å‘é€æˆåŠŸ
4. æŸ¥çœ‹å“åº”çŠ¶æ€ç å’Œå†…å®¹
```

### é—®é¢˜2: ç™»å½•åæ— æ³•è¿›å…¥ç³»ç»Ÿ

**å¯èƒ½åŸå› **:
1. Token æœªæ­£ç¡®ä¿å­˜åˆ° localStorage
2. å‰ç«¯è·¯ç”±é…ç½®é—®é¢˜
3. æƒé™éªŒè¯é—®é¢˜

**æ’æŸ¥æ­¥éª¤**:

#### 1. æ£€æŸ¥ localStorage
```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œ
console.log('auth_token:', localStorage.getItem('auth_token'));
console.log('user_info:', localStorage.getItem('user_info'));
```

#### 2. æ£€æŸ¥ç™»å½•åçš„è·³è½¬
Landing é¡µé¢ç™»å½•æˆåŠŸååº”è¯¥ï¼š
- ä¿å­˜ token åˆ° localStorage
- è·³è½¬åˆ°é¦–é¡µ (/)
- é¦–é¡µåº”è¯¥æ˜¾ç¤º"è¿›å…¥ç³»ç»Ÿ"æŒ‰é’®

#### 3. æ£€æŸ¥"è¿›å…¥ç³»ç»Ÿ"æŒ‰é’®
ç‚¹å‡»"è¿›å…¥ç³»ç»Ÿ"æŒ‰é’®åº”è¯¥ï¼š
- è·³è½¬åˆ° http://localhost:5173 (å‰ç«¯åº”ç”¨)
- å‰ç«¯åº”ç”¨ä¼šè¯»å– localStorage ä¸­çš„ token
- è‡ªåŠ¨ç™»å½•å¹¶æ˜¾ç¤ºä¸»ç•Œé¢

---

## ğŸ”§ æ‰‹åŠ¨æµ‹è¯•æ­¥éª¤

### æ­¥éª¤1: è®¿é—® Landing é¡µé¢
```
1. æ‰“å¼€æµè§ˆå™¨
2. è®¿é—® http://localhost:8080
3. ç‚¹å‡»å³ä¸Šè§’"ç™»å½•"æŒ‰é’®
```

### æ­¥éª¤2: ç™»å½•
```
1. è¾“å…¥ç”¨æˆ·å: admin
2. è¾“å…¥å¯†ç : admin123
3. ç‚¹å‡»"ç™»å½•"æŒ‰é’®
4. åº”è¯¥çœ‹åˆ°"ç™»å½•æˆåŠŸ"æç¤º
5. è‡ªåŠ¨è·³è½¬åˆ°é¦–é¡µ
```

### æ­¥éª¤3: è¿›å…¥ç³»ç»Ÿ
```
1. åœ¨é¦–é¡µå³ä¸Šè§’åº”è¯¥çœ‹åˆ°ç”¨æˆ·å "admin"
2. ç‚¹å‡»"è¿›å…¥ç³»ç»Ÿ"æŒ‰é’®
3. åº”è¯¥è·³è½¬åˆ° http://localhost:5173
4. åº”è¯¥çœ‹åˆ°ç³»ç»Ÿä¸»ç•Œé¢
```

---

## ğŸ“ é…ç½®ä¿¡æ¯

### åç«¯é…ç½®
- **API URL**: http://localhost:3000/api
- **WebSocket URL**: ws://localhost:3000/ws

### å‰ç«¯é…ç½® (Client)
- **URL**: http://localhost:5173
- **API URL**: http://localhost:3000/api
- **WebSocket URL**: ws://localhost:3000/ws

### Landing é…ç½®
- **URL**: http://localhost:8080
- **API URL**: http://localhost:3000/api
- **Client URL**: http://localhost:5173

---

## ğŸ¯ æµ‹è¯•è´¦å·

### ç®¡ç†å‘˜è´¦å·
- **ç”¨æˆ·å**: admin
- **å¯†ç **: admin123
- **è§’è‰²**: admin
- **é‚€è¯·ç **: xr2w8q

### æ™®é€šç”¨æˆ·è´¦å·
- **ç”¨æˆ·å**: user1
- **å¯†ç **: user123
- **è§’è‰²**: user

---

## ğŸš€ å¿«é€ŸéªŒè¯å‘½ä»¤

### 1. æ£€æŸ¥æ‰€æœ‰æœåŠ¡æ˜¯å¦è¿è¡Œ
```bash
# æ£€æŸ¥åç«¯
curl http://localhost:3000/api/health

# æ£€æŸ¥å‰ç«¯
curl http://localhost:5173

# æ£€æŸ¥ Landing
curl http://localhost:8080
```

### 2. æµ‹è¯•ç™»å½• API
```bash
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}' \
  | jq .
```

### 3. æµ‹è¯•å¸¦ Token çš„ API
```bash
# å…ˆè·å– token
TOKEN=$(curl -s -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}' \
  | jq -r '.data.token')

# ä½¿ç”¨ token è®¿é—®å—ä¿æŠ¤çš„ API
curl -H "Authorization: Bearer $TOKEN" \
  http://localhost:3000/api/user/profile \
  | jq .
```

---

## ğŸ“ å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨

### æ”¶é›†è¯Šæ–­ä¿¡æ¯

1. **æµè§ˆå™¨æ§åˆ¶å°æ—¥å¿—**
   - æ‰“å¼€ F12
   - å¤åˆ¶ Console ä¸­çš„æ‰€æœ‰é”™è¯¯ä¿¡æ¯

2. **ç½‘ç»œè¯·æ±‚æ—¥å¿—**
   - æ‰“å¼€ F12 â†’ Network
   - å°è¯•ç™»å½•
   - å³é”®ç‚¹å‡»å¤±è´¥çš„è¯·æ±‚ â†’ Copy â†’ Copy as cURL

3. **åç«¯æ—¥å¿—**
   - æŸ¥çœ‹ç»ˆç«¯ä¸­åç«¯æœåŠ¡çš„è¾“å‡º
   - å¤åˆ¶ç›¸å…³çš„é”™è¯¯ä¿¡æ¯

4. **å‰ç«¯æ—¥å¿—**
   - æŸ¥çœ‹ç»ˆç«¯ä¸­å‰ç«¯æœåŠ¡çš„è¾“å‡º
   - å¤åˆ¶ç›¸å…³çš„é”™è¯¯ä¿¡æ¯

---

**è¯Šæ–­å®Œæˆæ—¶é—´**: 2024-12-25  
**ç³»ç»ŸçŠ¶æ€**: âœ… æ‰€æœ‰æœåŠ¡æ­£å¸¸è¿è¡Œ  
**å·²ä¿®å¤é—®é¢˜**: 1ä¸ªï¼ˆåç«¯å¯åŠ¨å¤±è´¥ï¼‰

